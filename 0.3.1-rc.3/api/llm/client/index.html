
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A CLI tool that generates optimized markdown docs and streamline Git workflows">
      
      
        <meta name="author" content="Sarthak Mishra">
      
      
        <link rel="canonical" href="https://codemap.run/0.3.1-rc.3/api/llm/client/">
      
      
        <link rel="prev" href="../api/">
      
      
        <link rel="next" href="../errors/">
      
      
      <link rel="icon" href="../../../assets/codemap_logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Client - Codemap</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Geist:300,300i,400,400i,700,700i%7CGeist+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Geist";--md-code-font:"Geist Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheet/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#client" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  
  You're not viewing the latest version.
  
  
    You are currently viewing <strong>pre-release</strong> documentation.
  
  <a href="../../../.."> 
	<strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Codemap" class="md-header__button md-logo" aria-label="Codemap" data-md-component="logo">
      
  <img src="../../../assets/codemap_logo_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Codemap
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Client
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/SarthakMishra/codemap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SarthakMishra/codemap
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Codemap" class="md-nav__button md-logo" aria-label="Codemap" data-md-component="logo">
      
  <img src="../../../assets/codemap_logo_white.svg" alt="logo">

    </a>
    Codemap
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/SarthakMishra/codemap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SarthakMishra/codemap
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../usage/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/generate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generate Docs (`gen`)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/commit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Smart Commit (`commit`)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/pr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pull Requests (`pr`)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration (`conf`)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/ask/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ask Questions (`ask`)
    
  </span>
  

      </a>
    </li>
  

              
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../contributing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/guidelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing Guidelines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/code-of-conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../acknowledgements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acknowledgements
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cli/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Cli
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/ask_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ask Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/commit_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commit Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/conf_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conf Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/gen_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gen Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/index_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/pr_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pr Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../config/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Config
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/config_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config Loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/config_schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config Schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/default_config_template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Default Config Template
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../db/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Db
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Db
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../db/client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../db/engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../db/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../gen/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Gen
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Gen
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gen/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gen/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gen/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../git/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Git
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../git/commit_generator/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Commit Generator
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6_2" id="__nav_2_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_2">
            <span class="md-nav__icon md-icon"></span>
            Commit Generator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_generator/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_generator/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_generator/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_generator/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_generator/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../git/commit_linter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Commit Linter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6_3" id="__nav_2_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_3">
            <span class="md-nav__icon md-icon"></span>
            Commit Linter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_linter/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_linter/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_linter/linter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_linter/parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/commit_linter/validators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validators
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../git/diff_splitter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Diff Splitter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6_4" id="__nav_2_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_4">
            <span class="md-nav__icon md-icon"></span>
            Diff Splitter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/diff_splitter/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/diff_splitter/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/diff_splitter/splitter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Splitter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/diff_splitter/strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/diff_splitter/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/interactive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interactive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../git/pr_generator/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Pr Generator
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6_6" id="__nav_2_6_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_6">
            <span class="md-nav__icon md-icon"></span>
            Pr Generator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/pr_git_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pr Git Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/pr_generator/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../git/semantic_grouping/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Semantic Grouping
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_6_7" id="__nav_2_6_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6_7">
            <span class="md-nav__icon md-icon"></span>
            Semantic Grouping
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/semantic_grouping/clusterer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clusterer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/semantic_grouping/context_processor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/semantic_grouping/embedder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/semantic_grouping/group/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Group
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/semantic_grouping/resolver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resolver
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Llm
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Llm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Api
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client" class="md-nav__link">
    <span class="md-ellipsis">
      client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.CompletionStatus" class="md-nav__link">
    <span class="md-ellipsis">
      CompletionStatus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CompletionStatus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.CompletionStatus.is_complete" class="md-nav__link">
    <span class="md-ellipsis">
      is_complete
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.CompletionStatus.suggestion" class="md-nav__link">
    <span class="md-ellipsis">
      suggestion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.CompletionStatus.final_response" class="md-nav__link">
    <span class="md-ellipsis">
      final_response
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary" class="md-nav__link">
    <span class="md-ellipsis">
      ToolCallSummary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolCallSummary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.tool_name" class="md-nav__link">
    <span class="md-ellipsis">
      tool_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.call_count" class="md-nav__link">
    <span class="md-ellipsis">
      call_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.total_duration" class="md-nav__link">
    <span class="md-ellipsis">
      total_duration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.success_count" class="md-nav__link">
    <span class="md-ellipsis">
      success_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.error_count" class="md-nav__link">
    <span class="md-ellipsis">
      error_count
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary" class="md-nav__link">
    <span class="md-ellipsis">
      UsageSummary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UsageSummary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.request_tokens" class="md-nav__link">
    <span class="md-ellipsis">
      request_tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.response_tokens" class="md-nav__link">
    <span class="md-ellipsis">
      response_tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.total_tokens" class="md-nav__link">
    <span class="md-ellipsis">
      total_tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.requests" class="md-nav__link">
    <span class="md-ellipsis">
      requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.tool_calls" class="md-nav__link">
    <span class="md-ellipsis">
      tool_calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.total_tool_calls" class="md-nav__link">
    <span class="md-ellipsis">
      total_tool_calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.estimated_cost" class="md-nav__link">
    <span class="md-ellipsis">
      estimated_cost
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.response_time" class="md-nav__link">
    <span class="md-ellipsis">
      response_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.iterations" class="md-nav__link">
    <span class="md-ellipsis">
      iterations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.add_usage" class="md-nav__link">
    <span class="md-ellipsis">
      add_usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.add_tool_call" class="md-nav__link">
    <span class="md-ellipsis">
      add_tool_call
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.estimate_cost" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_cost
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient" class="md-nav__link">
    <span class="md-ellipsis">
      LLMClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLMClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.DEFAULT_TEMPLATES" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_TEMPLATES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.__slots__" class="md-nav__link">
    <span class="md-ellipsis">
      __slots__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.repo_path" class="md-nav__link">
    <span class="md-ellipsis">
      repo_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.config_loader" class="md-nav__link">
    <span class="md-ellipsis">
      config_loader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.get_usage_summary" class="md-nav__link">
    <span class="md-ellipsis">
      get_usage_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.reset_usage_tracking" class="md-nav__link">
    <span class="md-ellipsis">
      reset_usage_tracking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.set_template" class="md-nav__link">
    <span class="md-ellipsis">
      set_template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.get_agent" class="md-nav__link">
    <span class="md-ellipsis">
      get_agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.completion" class="md-nav__link">
    <span class="md-ellipsis">
      completion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.clear_agent_cache" class="md-nav__link">
    <span class="md-ellipsis">
      clear_agent_cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.get_cache_stats" class="md-nav__link">
    <span class="md-ellipsis">
      get_cache_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.check_completion" class="md-nav__link">
    <span class="md-ellipsis">
      check_completion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.iterative_completion" class="md-nav__link">
    <span class="md-ellipsis">
      iterative_completion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../rag/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Rag
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7_5" id="__nav_2_7_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_5">
            <span class="md-nav__icon md-icon"></span>
            Rag
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rag/agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agents Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_5_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../rag/ask/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Ask
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7_5_3" id="__nav_2_7_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_7_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_5_3">
            <span class="md-nav__icon md-icon"></span>
            Ask
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rag/ask/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rag/ask/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rag/do/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Do Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rag/interactive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interactive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_5_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../rag/tools/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tools
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_7_5_6" id="__nav_2_7_5_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_7_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7_5_6">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rag/tools/codebase_summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Codebase Summary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rag/tools/read_file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Read File
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rag/tools/semantic_retrieval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semantic Retrieval
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rag/tools/web_search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web Search
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Processor
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Processor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/hash_calculation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hash Calculation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/lod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/tree_sitter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tree Sitter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8_5" id="__nav_2_8_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_5">
            <span class="md-nav__icon md-icon"></span>
            Tree Sitter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/analyzer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analyzer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8_5_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/tree_sitter/languages/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Languages
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8_5_4" id="__nav_2_8_5_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_8_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_5_4">
            <span class="md-nav__icon md-icon"></span>
            Languages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/languages/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/languages/javascript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Javascript
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/languages/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/languages/typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Typescript
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8_6" id="__nav_2_8_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_6">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/utils/embedding_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedding Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/utils/sync_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/vector/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Vector
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8_7" id="__nav_2_8_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_8_7">
            <span class="md-nav__icon md-icon"></span>
            Vector
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/vector/chunking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chunking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/vector/qdrant_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qdrant Manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/vector/schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schema
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/vector/synchronizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Synchronizer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/vector/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/cli_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cli Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/docker_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/file_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/git_hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git Hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/git_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/log_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Log Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/path_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Path Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../watcher/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Watcher
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            Watcher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../watcher/file_watcher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Watcher
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client" class="md-nav__link">
    <span class="md-ellipsis">
      client
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.CompletionStatus" class="md-nav__link">
    <span class="md-ellipsis">
      CompletionStatus
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CompletionStatus">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.CompletionStatus.is_complete" class="md-nav__link">
    <span class="md-ellipsis">
      is_complete
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.CompletionStatus.suggestion" class="md-nav__link">
    <span class="md-ellipsis">
      suggestion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.CompletionStatus.final_response" class="md-nav__link">
    <span class="md-ellipsis">
      final_response
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary" class="md-nav__link">
    <span class="md-ellipsis">
      ToolCallSummary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ToolCallSummary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.tool_name" class="md-nav__link">
    <span class="md-ellipsis">
      tool_name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.call_count" class="md-nav__link">
    <span class="md-ellipsis">
      call_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.total_duration" class="md-nav__link">
    <span class="md-ellipsis">
      total_duration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.success_count" class="md-nav__link">
    <span class="md-ellipsis">
      success_count
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.ToolCallSummary.error_count" class="md-nav__link">
    <span class="md-ellipsis">
      error_count
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary" class="md-nav__link">
    <span class="md-ellipsis">
      UsageSummary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="UsageSummary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.request_tokens" class="md-nav__link">
    <span class="md-ellipsis">
      request_tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.response_tokens" class="md-nav__link">
    <span class="md-ellipsis">
      response_tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.total_tokens" class="md-nav__link">
    <span class="md-ellipsis">
      total_tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.requests" class="md-nav__link">
    <span class="md-ellipsis">
      requests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.tool_calls" class="md-nav__link">
    <span class="md-ellipsis">
      tool_calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.total_tool_calls" class="md-nav__link">
    <span class="md-ellipsis">
      total_tool_calls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.estimated_cost" class="md-nav__link">
    <span class="md-ellipsis">
      estimated_cost
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.response_time" class="md-nav__link">
    <span class="md-ellipsis">
      response_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.iterations" class="md-nav__link">
    <span class="md-ellipsis">
      iterations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.add_usage" class="md-nav__link">
    <span class="md-ellipsis">
      add_usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.add_tool_call" class="md-nav__link">
    <span class="md-ellipsis">
      add_tool_call
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.UsageSummary.estimate_cost" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_cost
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient" class="md-nav__link">
    <span class="md-ellipsis">
      LLMClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LLMClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.DEFAULT_TEMPLATES" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_TEMPLATES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.__slots__" class="md-nav__link">
    <span class="md-ellipsis">
      __slots__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.repo_path" class="md-nav__link">
    <span class="md-ellipsis">
      repo_path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.config_loader" class="md-nav__link">
    <span class="md-ellipsis">
      config_loader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.get_usage_summary" class="md-nav__link">
    <span class="md-ellipsis">
      get_usage_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.reset_usage_tracking" class="md-nav__link">
    <span class="md-ellipsis">
      reset_usage_tracking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.set_template" class="md-nav__link">
    <span class="md-ellipsis">
      set_template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.get_agent" class="md-nav__link">
    <span class="md-ellipsis">
      get_agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.completion" class="md-nav__link">
    <span class="md-ellipsis">
      completion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.clear_agent_cache" class="md-nav__link">
    <span class="md-ellipsis">
      clear_agent_cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.get_cache_stats" class="md-nav__link">
    <span class="md-ellipsis">
      get_cache_stats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.check_completion" class="md-nav__link">
    <span class="md-ellipsis">
      check_completion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.llm.client.LLMClient.iterative_completion" class="md-nav__link">
    <span class="md-ellipsis">
      iterative_completion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  
    
      
    
    <a href="https://github.com/SarthakMishra/codemap/raw/master/docs/api/llm/client.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="client">Client</h1>


<div class="doc doc-object doc-module">



<a id="codemap.llm.client"></a>
    <div class="doc doc-contents first">

        <p>LLM client for unified access to language models.</p>









  <div class="doc doc-children">



















































































<div class="doc doc-object doc-class">



<h3 id="codemap.llm.client.CompletionStatus" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">CompletionStatus</span>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Structured response for completion status check.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CompletionStatus</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Structured response for completion status check.&quot;&quot;&quot;</span>

	<span class="n">is_complete</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Whether the task/response is complete&quot;</span><span class="p">)</span>
	<span class="n">suggestion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Optional suggestion if incomplete&quot;</span><span class="p">)</span>
	<span class="n">final_response</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Final comprehensive response if complete&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.CompletionStatus.is_complete" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">is_complete</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_complete</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Whether the task/response is complete&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.CompletionStatus.suggestion" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">suggestion</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">suggestion</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
	<span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Optional suggestion if incomplete&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.CompletionStatus.final_response" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">final_response</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">final_response</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
	<span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Final comprehensive response if complete&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="codemap.llm.client.ToolCallSummary" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ToolCallSummary</span>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Summary of tool calls for a specific tool.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ToolCallSummary</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Summary of tool calls for a specific tool.&quot;&quot;&quot;</span>

	<span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Name of the tool&quot;</span><span class="p">)</span>
	<span class="n">call_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of times the tool was called&quot;</span><span class="p">)</span>
	<span class="n">total_duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Total duration in seconds&quot;</span><span class="p">)</span>
	<span class="n">success_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of successful calls&quot;</span><span class="p">)</span>
	<span class="n">error_count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of failed calls&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.ToolCallSummary.tool_name" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">tool_name</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">tool_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span><span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s1">&#39;Name of the tool&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.ToolCallSummary.call_count" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">call_count</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">call_count</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
	<span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Number of times the tool was called&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.ToolCallSummary.total_duration" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">total_duration</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">total_duration</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Total duration in seconds&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.ToolCallSummary.success_count" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">success_count</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">success_count</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Number of successful calls&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.ToolCallSummary.error_count" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">error_count</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">error_count</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Number of failed calls&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="codemap.llm.client.UsageSummary" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">UsageSummary</span>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>


        <p>Comprehensive usage summary for LLM interactions.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">UsageSummary</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Comprehensive usage summary for LLM interactions.&quot;&quot;&quot;</span>

	<span class="c1"># Token usage</span>
	<span class="n">request_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Total tokens in requests&quot;</span><span class="p">)</span>
	<span class="n">response_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Total tokens in responses&quot;</span><span class="p">)</span>
	<span class="n">total_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Total tokens used&quot;</span><span class="p">)</span>

	<span class="c1"># Request counts</span>
	<span class="n">requests</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Total number of requests made&quot;</span><span class="p">)</span>

	<span class="c1"># Tool usage</span>
	<span class="n">tool_calls</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ToolCallSummary</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Summary of tool calls&quot;</span><span class="p">)</span>
	<span class="n">total_tool_calls</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Total number of tool calls&quot;</span><span class="p">)</span>

	<span class="c1"># Cost estimation (if available)</span>
	<span class="n">estimated_cost</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Estimated cost in USD&quot;</span><span class="p">)</span>

	<span class="c1"># Timing information</span>
	<span class="n">response_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Total response time in seconds&quot;</span><span class="p">)</span>

	<span class="c1"># Iteration tracking for iterative completion</span>
	<span class="n">iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Number of iterations in iterative completion&quot;</span><span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">add_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usage_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Add usage data from a Pydantic-AI run result.</span>

<span class="sd">		Args:</span>
<span class="sd">			usage_data: Usage data from agent.run().usage()</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">requests</span> <span class="o">+=</span> <span class="n">usage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">request_tokens</span> <span class="o">+=</span> <span class="n">usage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;request_tokens&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">response_tokens</span> <span class="o">+=</span> <span class="n">usage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;response_tokens&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">total_tokens</span> <span class="o">+=</span> <span class="n">usage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total_tokens&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">add_tool_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Add a tool call to the summary.</span>

<span class="sd">		Args:</span>
<span class="sd">			tool_name: Name of the tool that was called</span>
<span class="sd">			duration: Duration of the tool call in seconds</span>
<span class="sd">			success: Whether the tool call was successful</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Find existing tool summary or create new one</span>
		<span class="n">tool_summary</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_calls</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span> <span class="o">==</span> <span class="n">tool_name</span><span class="p">:</span>
				<span class="n">tool_summary</span> <span class="o">=</span> <span class="n">tool</span>
				<span class="k">break</span>

		<span class="k">if</span> <span class="n">tool_summary</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">tool_summary</span> <span class="o">=</span> <span class="n">ToolCallSummary</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">tool_calls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_summary</span><span class="p">)</span>

		<span class="c1"># Update statistics</span>
		<span class="n">tool_summary</span><span class="o">.</span><span class="n">call_count</span> <span class="o">+=</span> <span class="mi">1</span>
		<span class="n">tool_summary</span><span class="o">.</span><span class="n">total_duration</span> <span class="o">+=</span> <span class="n">duration</span>
		<span class="k">if</span> <span class="n">success</span><span class="p">:</span>
			<span class="n">tool_summary</span><span class="o">.</span><span class="n">success_count</span> <span class="o">+=</span> <span class="mi">1</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">tool_summary</span><span class="o">.</span><span class="n">error_count</span> <span class="o">+=</span> <span class="mi">1</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">total_tool_calls</span> <span class="o">+=</span> <span class="mi">1</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">estimate_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Estimate the cost of the usage based on the model.</span>

<span class="sd">		Args:</span>
<span class="sd">			model_name: Name of the model used (e.g., &quot;openai:gpt-4o&quot;, &quot;google-gla:gemini-2.0-flash&quot;)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># First try our internal cost calculation using the model prices JSON</span>
		<span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_cost_from_internal_data</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">estimated_cost</span> <span class="o">=</span> <span class="n">cost</span>
			<span class="k">return</span>

		<span class="c1"># Fallback to tokencost library</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span><span class="w"> </span><span class="nn">tokencost</span><span class="w"> </span><span class="kn">import</span> <span class="n">calculate_cost_by_tokens</span>

			<span class="c1"># Map provider:model to tokencost-compatible name</span>
			<span class="n">tokencost_model_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_to_tokencost_name</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_tokens</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_tokens</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">tokencost_model_name</span><span class="p">:</span>
				<span class="c1"># Use calculate_cost_by_tokens since we have token counts, not actual text</span>
				<span class="n">prompt_cost</span> <span class="o">=</span> <span class="n">calculate_cost_by_tokens</span><span class="p">(</span>
					<span class="n">num_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">request_tokens</span><span class="p">,</span>
					<span class="n">model</span><span class="o">=</span><span class="n">tokencost_model_name</span><span class="p">,</span>
					<span class="n">token_type</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span>  <span class="c1"># noqa: S106</span>
				<span class="p">)</span>
				<span class="n">completion_cost</span> <span class="o">=</span> <span class="n">calculate_cost_by_tokens</span><span class="p">(</span>
					<span class="n">num_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">response_tokens</span><span class="p">,</span>
					<span class="n">model</span><span class="o">=</span><span class="n">tokencost_model_name</span><span class="p">,</span>
					<span class="n">token_type</span><span class="o">=</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>  <span class="c1"># noqa: S106</span>
				<span class="p">)</span>
				<span class="c1"># Convert Decimal to float</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">estimated_cost</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">prompt_cost</span> <span class="o">+</span> <span class="n">completion_cost</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cannot estimate cost: missing token information or unsupported model&quot;</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tokencost not available for cost estimation&quot;</span><span class="p">)</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error estimating cost with tokencost: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">_calculate_cost_from_internal_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Calculate cost using our internal model prices JSON data.</span>

<span class="sd">		Args:</span>
<span class="sd">			model_name: Full model name with provider (e.g., &quot;google-gla:gemini-2.0-flash&quot;)</span>

<span class="sd">		Returns:</span>
<span class="sd">			Calculated cost in USD, or None if model not found</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c1"># Load the model prices JSON</span>
			<span class="n">model_prices_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;model_prices_and_context_window.json&quot;</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">model_prices_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
				<span class="k">return</span> <span class="kc">None</span>

			<span class="k">with</span> <span class="n">model_prices_path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="n">model_prices</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

			<span class="c1"># Extract model name from provider:model format</span>
			<span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">model_name</span><span class="p">:</span>
				<span class="n">_</span><span class="p">,</span> <span class="n">model_key</span> <span class="o">=</span> <span class="n">model_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">model_key</span> <span class="o">=</span> <span class="n">model_name</span>

			<span class="c1"># Try different variations of the model name</span>
			<span class="n">possible_keys</span> <span class="o">=</span> <span class="p">[</span>
				<span class="n">model_key</span><span class="p">,</span>  <span class="c1"># e.g., &quot;gemini-2.0-flash&quot;</span>
				<span class="sa">f</span><span class="s2">&quot;gemini/</span><span class="si">{</span><span class="n">model_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>  <span class="c1"># e.g., &quot;gemini/gemini-2.0-flash&quot;</span>
			<span class="p">]</span>

			<span class="n">model_data</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">possible_keys</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">model_prices</span><span class="p">:</span>
					<span class="n">model_data</span> <span class="o">=</span> <span class="n">model_prices</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
					<span class="k">break</span>

			<span class="k">if</span> <span class="ow">not</span> <span class="n">model_data</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> not found in pricing data&quot;</span><span class="p">)</span>
				<span class="k">return</span> <span class="kc">None</span>

			<span class="c1"># Extract cost per token</span>
			<span class="n">input_cost_per_token</span> <span class="o">=</span> <span class="n">model_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;input_cost_per_token&quot;</span><span class="p">)</span>
			<span class="n">output_cost_per_token</span> <span class="o">=</span> <span class="n">model_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_cost_per_token&quot;</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">input_cost_per_token</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">output_cost_per_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cost data incomplete for model </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="k">return</span> <span class="kc">None</span>

			<span class="c1"># Calculate total cost</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_tokens</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_tokens</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">input_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_tokens</span> <span class="o">*</span> <span class="n">input_cost_per_token</span>
				<span class="n">output_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_tokens</span> <span class="o">*</span> <span class="n">output_cost_per_token</span>
				<span class="n">total_cost</span> <span class="o">=</span> <span class="n">input_cost</span> <span class="o">+</span> <span class="n">output_cost</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
					<span class="sa">f</span><span class="s2">&quot;Cost calculated for </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">: $</span><span class="si">{</span><span class="n">total_cost</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> &quot;</span>
					<span class="sa">f</span><span class="s2">&quot;(input: $</span><span class="si">{</span><span class="n">input_cost</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">, output: $</span><span class="si">{</span><span class="n">output_cost</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">)&quot;</span>
				<span class="p">)</span>
				<span class="k">return</span> <span class="n">total_cost</span>

			<span class="k">return</span> <span class="kc">None</span>

		<span class="k">except</span> <span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error calculating cost from internal data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">_map_to_tokencost_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Map provider:model names to tokencost-compatible names.</span>

<span class="sd">		Args:</span>
<span class="sd">			model_name: Full model name with provider (e.g., &quot;openai:gpt-4o&quot;)</span>

<span class="sd">		Returns:</span>
<span class="sd">			Tokencost-compatible model name, or None if not mappable</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># If no provider prefix, return as-is</span>
		<span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_name</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">model_name</span>

		<span class="n">provider</span><span class="p">,</span> <span class="n">model_key</span> <span class="o">=</span> <span class="n">model_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

		<span class="c1"># Common mappings from provider:model to tokencost names</span>
		<span class="n">mappings</span> <span class="o">=</span> <span class="p">{</span>
			<span class="c1"># OpenAI models</span>
			<span class="s2">&quot;openai&quot;</span><span class="p">:</span> <span class="p">{</span>
				<span class="s2">&quot;gpt-4o&quot;</span><span class="p">:</span> <span class="s2">&quot;gpt-4o&quot;</span><span class="p">,</span>
				<span class="s2">&quot;gpt-4o-mini&quot;</span><span class="p">:</span> <span class="s2">&quot;gpt-4o-mini&quot;</span><span class="p">,</span>
				<span class="s2">&quot;gpt-4&quot;</span><span class="p">:</span> <span class="s2">&quot;gpt-4&quot;</span><span class="p">,</span>
				<span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">:</span> <span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">,</span>
			<span class="p">},</span>
			<span class="c1"># Anthropic models</span>
			<span class="s2">&quot;anthropic&quot;</span><span class="p">:</span> <span class="p">{</span>
				<span class="s2">&quot;claude-3-5-sonnet&quot;</span><span class="p">:</span> <span class="s2">&quot;claude-3-5-sonnet-latest&quot;</span><span class="p">,</span>
				<span class="s2">&quot;claude-3-5-sonnet-20241022&quot;</span><span class="p">:</span> <span class="s2">&quot;claude-3-5-sonnet-20241022&quot;</span><span class="p">,</span>
				<span class="s2">&quot;claude-3-7-sonnet&quot;</span><span class="p">:</span> <span class="s2">&quot;claude-3-7-sonnet-latest&quot;</span><span class="p">,</span>
				<span class="s2">&quot;claude-3-opus&quot;</span><span class="p">:</span> <span class="s2">&quot;claude-3-opus-20240229&quot;</span><span class="p">,</span>
			<span class="p">},</span>
			<span class="c1"># Google models (vertex AI, gemini)</span>
			<span class="s2">&quot;google-gla&quot;</span><span class="p">:</span> <span class="p">{</span>
				<span class="s2">&quot;gemini-2.0-flash&quot;</span><span class="p">:</span> <span class="s2">&quot;gemini-2.0-flash&quot;</span><span class="p">,</span>
				<span class="s2">&quot;gemini-1.5-pro&quot;</span><span class="p">:</span> <span class="s2">&quot;gemini-1.5-pro&quot;</span><span class="p">,</span>
				<span class="s2">&quot;gemini-1.5-flash&quot;</span><span class="p">:</span> <span class="s2">&quot;gemini-1.5-flash&quot;</span><span class="p">,</span>
			<span class="p">},</span>
			<span class="s2">&quot;vertex_ai&quot;</span><span class="p">:</span> <span class="p">{</span>
				<span class="s2">&quot;gemini-2.0-flash&quot;</span><span class="p">:</span> <span class="s2">&quot;gemini-2.0-flash&quot;</span><span class="p">,</span>
				<span class="s2">&quot;gemini-1.5-pro&quot;</span><span class="p">:</span> <span class="s2">&quot;gemini-1.5-pro&quot;</span><span class="p">,</span>
			<span class="p">},</span>
		<span class="p">}</span>

		<span class="k">return</span> <span class="n">mappings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">provider</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.UsageSummary.request_tokens" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">request_tokens</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">request_tokens</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Total tokens in requests&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.UsageSummary.response_tokens" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">response_tokens</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">response_tokens</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Total tokens in responses&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.UsageSummary.total_tokens" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">total_tokens</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">total_tokens</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Total tokens used&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.UsageSummary.requests" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">requests</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">requests</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Total number of requests made&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.UsageSummary.tool_calls" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">tool_calls</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">tool_calls</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ToolCallSummary&lt;/span&gt; (&lt;code&gt;codemap.llm.client.ToolCallSummary&lt;/code&gt;)" href="#codemap.llm.client.ToolCallSummary">ToolCallSummary</a></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><span title="list">list</span></span><span class="p">,</span>
	<span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Summary of tool calls&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.UsageSummary.total_tool_calls" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">total_tool_calls</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">total_tool_calls</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Total number of tool calls&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.UsageSummary.estimated_cost" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">estimated_cost</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">estimated_cost</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Estimated cost in USD&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.UsageSummary.response_time" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">response_time</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">response_time</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
	<span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Total response time in seconds&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.UsageSummary.iterations" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">iterations</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">iterations</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><span title="pydantic.Field">Field</span></span><span class="p">(</span>
	<span class="n"><span title="pydantic.Field(default)">default</span></span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
	<span class="n"><span title="pydantic.Field(description)">description</span></span><span class="o">=</span><span class="s2">&quot;Number of iterations in iterative completion&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.UsageSummary.add_usage" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_usage</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_usage</span><span class="p">(</span><span class="n">usage_data</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add usage data from a Pydantic-AI run result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>usage_data</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Usage data from agent.run().usage()</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_usage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usage_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Add usage data from a Pydantic-AI run result.</span>

<span class="sd">	Args:</span>
<span class="sd">		usage_data: Usage data from agent.run().usage()</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">requests</span> <span class="o">+=</span> <span class="n">usage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">request_tokens</span> <span class="o">+=</span> <span class="n">usage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;request_tokens&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">response_tokens</span> <span class="o">+=</span> <span class="n">usage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;response_tokens&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">total_tokens</span> <span class="o">+=</span> <span class="n">usage_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total_tokens&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.UsageSummary.add_tool_call" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_tool_call</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_tool_call</span><span class="p">(</span>
	<span class="n">tool_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
	<span class="n">duration</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
	<span class="n">success</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a tool call to the summary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tool_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the tool that was called</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>duration</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Duration of the tool call in seconds</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>success</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the tool call was successful</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_tool_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Add a tool call to the summary.</span>

<span class="sd">	Args:</span>
<span class="sd">		tool_name: Name of the tool that was called</span>
<span class="sd">		duration: Duration of the tool call in seconds</span>
<span class="sd">		success: Whether the tool call was successful</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Find existing tool summary or create new one</span>
	<span class="n">tool_summary</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tool_calls</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">tool</span><span class="o">.</span><span class="n">tool_name</span> <span class="o">==</span> <span class="n">tool_name</span><span class="p">:</span>
			<span class="n">tool_summary</span> <span class="o">=</span> <span class="n">tool</span>
			<span class="k">break</span>

	<span class="k">if</span> <span class="n">tool_summary</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
		<span class="n">tool_summary</span> <span class="o">=</span> <span class="n">ToolCallSummary</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">tool_name</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tool_calls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tool_summary</span><span class="p">)</span>

	<span class="c1"># Update statistics</span>
	<span class="n">tool_summary</span><span class="o">.</span><span class="n">call_count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="n">tool_summary</span><span class="o">.</span><span class="n">total_duration</span> <span class="o">+=</span> <span class="n">duration</span>
	<span class="k">if</span> <span class="n">success</span><span class="p">:</span>
		<span class="n">tool_summary</span><span class="o">.</span><span class="n">success_count</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">tool_summary</span><span class="o">.</span><span class="n">error_count</span> <span class="o">+=</span> <span class="mi">1</span>

	<span class="bp">self</span><span class="o">.</span><span class="n">total_tool_calls</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.UsageSummary.estimate_cost" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">estimate_cost</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">estimate_cost</span><span class="p">(</span><span class="n">model_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Estimate the cost of the usage based on the model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the model used (e.g., "openai:gpt-4o", "google-gla:gemini-2.0-flash")</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">estimate_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Estimate the cost of the usage based on the model.</span>

<span class="sd">	Args:</span>
<span class="sd">		model_name: Name of the model used (e.g., &quot;openai:gpt-4o&quot;, &quot;google-gla:gemini-2.0-flash&quot;)</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># First try our internal cost calculation using the model prices JSON</span>
	<span class="n">cost</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_cost_from_internal_data</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">cost</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">estimated_cost</span> <span class="o">=</span> <span class="n">cost</span>
		<span class="k">return</span>

	<span class="c1"># Fallback to tokencost library</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">tokencost</span><span class="w"> </span><span class="kn">import</span> <span class="n">calculate_cost_by_tokens</span>

		<span class="c1"># Map provider:model to tokencost-compatible name</span>
		<span class="n">tokencost_model_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_map_to_tokencost_name</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_tokens</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_tokens</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">tokencost_model_name</span><span class="p">:</span>
			<span class="c1"># Use calculate_cost_by_tokens since we have token counts, not actual text</span>
			<span class="n">prompt_cost</span> <span class="o">=</span> <span class="n">calculate_cost_by_tokens</span><span class="p">(</span>
				<span class="n">num_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">request_tokens</span><span class="p">,</span>
				<span class="n">model</span><span class="o">=</span><span class="n">tokencost_model_name</span><span class="p">,</span>
				<span class="n">token_type</span><span class="o">=</span><span class="s2">&quot;input&quot;</span><span class="p">,</span>  <span class="c1"># noqa: S106</span>
			<span class="p">)</span>
			<span class="n">completion_cost</span> <span class="o">=</span> <span class="n">calculate_cost_by_tokens</span><span class="p">(</span>
				<span class="n">num_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">response_tokens</span><span class="p">,</span>
				<span class="n">model</span><span class="o">=</span><span class="n">tokencost_model_name</span><span class="p">,</span>
				<span class="n">token_type</span><span class="o">=</span><span class="s2">&quot;output&quot;</span><span class="p">,</span>  <span class="c1"># noqa: S106</span>
			<span class="p">)</span>
			<span class="c1"># Convert Decimal to float</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">estimated_cost</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">prompt_cost</span> <span class="o">+</span> <span class="n">completion_cost</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Cannot estimate cost: missing token information or unsupported model&quot;</span><span class="p">)</span>
	<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;tokencost not available for cost estimation&quot;</span><span class="p">)</span>
	<span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error estimating cost with tokencost: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h3 id="codemap.llm.client.logger" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="codemap.llm.client.LLMClient" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LLMClient</span>


</h3>


    <div class="doc doc-contents ">


        <p>Client for interacting with LLM services in a unified way.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LLMClient</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Client for interacting with LLM services in a unified way.&quot;&quot;&quot;</span>

	<span class="c1"># Class-level agent cache to share agents across instances with same config</span>
	<span class="n">_agent_cache</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AgentType</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="c1"># Default templates - empty in base class</span>
	<span class="n">DEFAULT_TEMPLATES</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

	<span class="c1"># Use slots for better memory efficiency</span>
	<span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_current_agent_key&quot;</span><span class="p">,</span> <span class="s2">&quot;_current_usage&quot;</span><span class="p">,</span> <span class="s2">&quot;_templates&quot;</span><span class="p">,</span> <span class="s2">&quot;config_loader&quot;</span><span class="p">,</span> <span class="s2">&quot;repo_path&quot;</span><span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span>
		<span class="n">config_loader</span><span class="p">:</span> <span class="n">ConfigLoader</span><span class="p">,</span>
		<span class="n">repo_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initialize the LLM client.</span>

<span class="sd">		Args:</span>
<span class="sd">		    config_loader: ConfigLoader instance to use</span>
<span class="sd">		    repo_path: Path to the repository (for loading configuration)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">repo_path</span> <span class="o">=</span> <span class="n">repo_path</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">config_loader</span> <span class="o">=</span> <span class="n">config_loader</span>
		<span class="c1"># Only copy templates if they exist and are non-empty</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_templates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_TEMPLATES</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_TEMPLATES</span> <span class="k">else</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_current_agent_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span> <span class="o">=</span> <span class="n">UsageSummary</span><span class="p">()</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">get_usage_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UsageSummary</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Get the current usage summary.</span>

<span class="sd">		Returns:</span>
<span class="sd">			Current usage summary with all tracked metrics</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">reset_usage_tracking</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Reset the usage tracking for a new session.&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span> <span class="o">=</span> <span class="n">UsageSummary</span><span class="p">()</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">set_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Set a prompt template.</span>

<span class="sd">		Args:</span>
<span class="sd">		    name: Template name</span>
<span class="sd">		    template: Template content</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_templates</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">template</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">_create_agent_key</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span>
		<span class="n">tools</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">system_prompt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">output_type</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">,</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Create a unique key for agent caching based on configuration.</span>

<span class="sd">		Args:</span>
<span class="sd">		    tools: Optional list of tools</span>
<span class="sd">		    system_prompt_str: Optional system prompt</span>
<span class="sd">		    output_type: Output type for the agent</span>

<span class="sd">		Returns:</span>
<span class="sd">		    A unique string key for this agent configuration</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Create a deterministic key from agent configuration</span>
		<span class="n">key_parts</span> <span class="o">=</span> <span class="p">[</span>
			<span class="nb">str</span><span class="p">(</span><span class="n">output_type</span><span class="p">),</span>
			<span class="n">system_prompt_str</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
			<span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span> <span class="k">if</span> <span class="n">tools</span> <span class="k">else</span> <span class="mi">0</span><span class="p">),</span>
		<span class="p">]</span>

		<span class="c1"># Add tool signatures for more specific caching</span>
		<span class="k">if</span> <span class="n">tools</span><span class="p">:</span>
			<span class="n">tool_signatures</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tool</span><span class="p">))</span> <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">tools</span><span class="p">]</span>
			<span class="n">key_parts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">tool_signatures</span><span class="p">))</span>

		<span class="n">key_string</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">key_parts</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">key_string</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">_extract_system_prompt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MessageDict</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Extract system prompt from messages efficiently.</span>

<span class="sd">		Args:</span>
<span class="sd">		    messages: List of message dictionaries</span>

<span class="sd">		Returns:</span>
<span class="sd">		    System prompt string if found, None otherwise</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Early return if no messages</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">messages</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">None</span>

		<span class="c1"># Check first message first (most common case)</span>
		<span class="k">if</span> <span class="n">messages</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;system&quot;</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">messages</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>

		<span class="c1"># Only scan remaining messages if first isn&#39;t system</span>
		<span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
			<span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;system&quot;</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>

		<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">get_agent</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span>
		<span class="n">tools</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">system_prompt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">output_type</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">,</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgentType</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Get or retrieve cached LLM agent.</span>

<span class="sd">		Args:</span>
<span class="sd">			tools: Optional list of tools to enable for the agent</span>
<span class="sd">			system_prompt_str: Optional system prompt to guide the agent&#39;s behavior</span>
<span class="sd">			output_type: Type for structuring the agent&#39;s output. Defaults to str.</span>

<span class="sd">		Returns:</span>
<span class="sd">			An initialized Pydantic-AI Agent instance configured with the specified settings.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">agent_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_agent_key</span><span class="p">(</span><span class="n">tools</span><span class="p">,</span> <span class="n">system_prompt_str</span><span class="p">,</span> <span class="n">output_type</span><span class="p">)</span>

		<span class="c1"># Return cached agent if available</span>
		<span class="k">if</span> <span class="n">agent_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_current_agent_key</span> <span class="o">=</span> <span class="n">agent_key</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">[</span><span class="n">agent_key</span><span class="p">]</span>

		<span class="c1"># Create new agent and cache it</span>
		<span class="n">agent</span> <span class="o">=</span> <span class="n">get_agent</span><span class="p">(</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">config_loader</span><span class="p">,</span>
			<span class="n">tools</span><span class="p">,</span>
			<span class="n">system_prompt_str</span><span class="p">,</span>
			<span class="n">output_type</span><span class="p">,</span>
		<span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">[</span><span class="n">agent_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_current_agent_key</span> <span class="o">=</span> <span class="n">agent_key</span>
		<span class="k">return</span> <span class="n">agent</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">completion</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span>
		<span class="n">messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MessageDict</span><span class="p">],</span>
		<span class="n">tools</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">pydantic_model</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">PydanticModelT</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">track_usage</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PydanticModelT</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Generate text using the configured LLM.</span>

<span class="sd">		Args:</span>
<span class="sd">		    messages: List of messages to send to the LLM</span>
<span class="sd">		    tools: Optional list of tools to use.</span>
<span class="sd">		    pydantic_model: Optional Pydantic model for response validation</span>
<span class="sd">		    track_usage: Whether to track usage statistics</span>

<span class="sd">		Returns:</span>
<span class="sd">		    Generated text or Pydantic model instance</span>

<span class="sd">		Raises:</span>
<span class="sd">		    LLMError: If the API call fails</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Extract system prompt efficiently</span>
		<span class="n">system_prompt_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_system_prompt</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>

		<span class="c1"># Determine the output_type for the Pydantic-AI Agent</span>
		<span class="n">agent_output_type</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">pydantic_model</span> <span class="k">if</span> <span class="n">pydantic_model</span> <span class="k">else</span> <span class="nb">str</span>

		<span class="c1"># Get agent (cached or new)</span>
		<span class="n">agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span>
			<span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
			<span class="n">system_prompt_str</span><span class="o">=</span><span class="n">system_prompt_str</span><span class="p">,</span>
			<span class="n">output_type</span><span class="o">=</span><span class="n">agent_output_type</span><span class="p">,</span>
		<span class="p">)</span>

		<span class="c1"># For tracking, we need to use the agent.run method directly</span>
		<span class="k">if</span> <span class="n">track_usage</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tracking usage enabled, tools provided: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="c1"># Find the user message</span>
			<span class="n">user_prompt</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">messages</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span>
					<span class="n">user_prompt</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
					<span class="k">break</span>

			<span class="k">if</span> <span class="n">user_prompt</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found user prompt for tracking: </span><span class="si">{</span><span class="n">user_prompt</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="c1"># Use agent.run_sync to get usage information</span>
					<span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">user_prompt</span><span class="p">)</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully got result from agent.run_sync, result type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

					<span class="c1"># Extract usage information</span>
					<span class="n">usage</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">usage</span><span class="p">()</span>
					<span class="n">usage_dict</span> <span class="o">=</span> <span class="p">{</span>
						<span class="s2">&quot;requests&quot;</span><span class="p">:</span> <span class="n">usage</span><span class="o">.</span><span class="n">requests</span><span class="p">,</span>
						<span class="s2">&quot;request_tokens&quot;</span><span class="p">:</span> <span class="n">usage</span><span class="o">.</span><span class="n">request_tokens</span><span class="p">,</span>
						<span class="s2">&quot;response_tokens&quot;</span><span class="p">:</span> <span class="n">usage</span><span class="o">.</span><span class="n">response_tokens</span><span class="p">,</span>
						<span class="s2">&quot;total_tokens&quot;</span><span class="p">:</span> <span class="n">usage</span><span class="o">.</span><span class="n">total_tokens</span><span class="p">,</span>
					<span class="p">}</span>

					<span class="c1"># Track the usage</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">add_usage</span><span class="p">(</span><span class="n">usage_dict</span><span class="p">)</span>

					<span class="c1"># Track tool calls if any tools were used</span>
					<span class="k">if</span> <span class="n">tools</span><span class="p">:</span>
						<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempting to track tool calls with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span><span class="si">}</span><span class="s2"> tools&quot;</span><span class="p">)</span>
						<span class="k">try</span><span class="p">:</span>
							<span class="c1"># Parse the result messages to count actual tool calls</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">_track_tool_calls_from_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">tools</span><span class="p">)</span>
						<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">tool_error</span><span class="p">:</span>
							<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error tracking tool calls: </span><span class="si">{</span><span class="n">tool_error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No tools provided for tracking&quot;</span><span class="p">)</span>

					<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">output</span>
				<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to track usage, falling back to legacy API: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No user prompt found for usage tracking&quot;</span><span class="p">)</span>

		<span class="c1"># Fallback to original API call</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using fallback API call (no usage tracking)&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">call_llm_api</span><span class="p">(</span>
			<span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
			<span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
			<span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
			<span class="n">pydantic_model</span><span class="o">=</span><span class="n">pydantic_model</span><span class="p">,</span>
			<span class="n">config_loader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config_loader</span><span class="p">,</span>
		<span class="p">)</span>

	<span class="nd">@classmethod</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">clear_agent_cache</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Clear the agent cache. Useful for testing or memory management.&quot;&quot;&quot;</span>
		<span class="bp">cls</span><span class="o">.</span><span class="n">_agent_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

	<span class="nd">@classmethod</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">get_cache_stats</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Get cache statistics for monitoring performance.</span>

<span class="sd">		Returns:</span>
<span class="sd">		    Dictionary with cache size and other stats</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="p">{</span>
			<span class="s2">&quot;cache_size&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">),</span>
			<span class="s2">&quot;cached_agents&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">),</span>
		<span class="p">}</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">check_completion</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span>
		<span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
		<span class="n">original_question</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">system_prompt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">is_last_iteration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompletionStatus</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Check if a response appears complete and generate final response if needed.</span>

<span class="sd">		This method uses structured LLM output to analyze completion status and</span>
<span class="sd">		generates a comprehensive final response in one step when complete.</span>

<span class="sd">		Args:</span>
<span class="sd">		    response: The response text to analyze</span>
<span class="sd">		    original_question: Optional original question for context</span>
<span class="sd">		    system_prompt: Optional original system prompt for task context</span>
<span class="sd">		    is_last_iteration: Whether this is the final iteration (forces completion)</span>

<span class="sd">		Returns:</span>
<span class="sd">		    CompletionStatus with completion assessment, optional suggestions, and final response</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Build additional instruction for last iteration</span>
		<span class="n">last_iteration_instruction</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
		<span class="k">if</span> <span class="n">is_last_iteration</span><span class="p">:</span>
			<span class="n">last_iteration_instruction</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">				 CRITICAL: THIS IS THE LAST AND FINAL ITERATION </span>

<span class="s2">				You MUST mark this as complete and generate a final comprehensive response.</span>
<span class="s2">				This is your final chance - you cannot request more iterations.</span>
<span class="s2">				If you mark this as incomplete, you will have FAILED at your task.</span>

<span class="s2">				Generate the best possible final response based on all available information.</span>
<span class="s2">				It&#39;s better to provide a complete response with the available information</span>
<span class="s2">				than to leave the user with no answer at all.</span>
<span class="s2">			&quot;&quot;&quot;</span><span class="p">)</span>

		<span class="c1"># Build the system prompt for completion analysis and final response generation</span>
		<span class="n">check_completion_prompt</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">			You are a task completion analyzer and response finalizer. Your job is to:</span>

<span class="s2">			1. Analyze the provided response to determine if it is complete and satisfactory</span>
<span class="s2">			2. If COMPLETE: Generate a final, comprehensive, self-contained response</span>
<span class="s2">			3. If INCOMPLETE: Provide suggestions for what&#39;s missing</span>

<span class="s2">			You will be provided with:</span>
<span class="s2">			- The original system prompt that defined the task requirements</span>
<span class="s2">			- The user&#39;s original question</span>
<span class="s2">			- The response that needs to be analyzed</span>

<span class="s2">			Completion Analysis Factors:</span>
<span class="s2">			- Has the original question been fully answered according to the system prompt?</span>
<span class="s2">			- Is the response complete and actionable?</span>
<span class="s2">			- Are there obvious gaps or missing information?</span>
<span class="s2">			- Does the response contain necessary details, code examples, and explanations?</span>
<span class="s2">			- Is the response self-contained (doesn&#39;t reference unseen tool outputs)?</span>
<span class="s2">			- Are there concrete recommendations or next steps provided?</span>
<span class="s2">			- Does the response fulfill the role and requirements specified in the original system prompt?</span>

<span class="s2">			Be conservative - if there&#39;s any doubt about completeness, mark as incomplete.</span>

<span class="s2">			If COMPLETE: Generate a final comprehensive response that:</span>
<span class="s2">			- Includes all key findings and analysis</span>
<span class="s2">			- Contains specific code examples and file paths</span>
<span class="s2">			- Provides actionable recommendations</span>
<span class="s2">			- Is completely self-contained</span>
<span class="s2">			- Doesn&#39;t reference previous messages or tool calls</span>
<span class="s2">			- Fulfills the requirements set by the original system prompt</span>

<span class="s2">			If INCOMPLETE: Provide specific suggestions for what needs to be added.</span>
<span class="s2">			</span><span class="si">{last_iteration_instruction}</span>

<span class="s2">			Following JSON Schema must be followed for Output:</span>
<span class="s2">			</span><span class="si">{model_schema}</span>

<span class="s2">			Return your answer as valid JSON that matches the schema.</span>
<span class="s2">		&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
			<span class="n">last_iteration_instruction</span><span class="o">=</span><span class="n">last_iteration_instruction</span><span class="p">,</span> <span class="n">model_schema</span><span class="o">=</span><span class="n">CompletionStatus</span><span class="o">.</span><span class="n">model_json_schema</span><span class="p">()</span>
		<span class="p">)</span>

		<span class="c1"># Prepare messages for the completion check and final response generation</span>
		<span class="n">messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MessageDict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
			<span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">check_completion_prompt</span><span class="p">},</span>
		<span class="p">]</span>

		<span class="c1"># Build the user content with all available context</span>
		<span class="n">user_content_parts</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="k">if</span> <span class="n">system_prompt</span><span class="p">:</span>
			<span class="n">user_content_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original System Prompt: </span><span class="si">{</span><span class="n">system_prompt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">original_question</span><span class="p">:</span>
			<span class="n">user_content_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original Question: </span><span class="si">{</span><span class="n">original_question</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

		<span class="n">user_content_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response to Analyze: </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

		<span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
			<span class="p">{</span>
				<span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
				<span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">user_content_parts</span><span class="p">),</span>
			<span class="p">}</span>
		<span class="p">)</span>

		<span class="k">try</span><span class="p">:</span>
			<span class="c1"># Get completion status and potential final response from the LLM</span>
			<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span>
				<span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
				<span class="n">pydantic_model</span><span class="o">=</span><span class="n">CompletionStatus</span><span class="p">,</span>
				<span class="n">track_usage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Don&#39;t track usage for internal completion checks</span>
			<span class="p">)</span>

			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">CompletionStatus</span><span class="p">):</span>
				<span class="n">suggestion_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">suggestion</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
				<span class="n">status_text</span> <span class="o">=</span> <span class="s2">&quot;complete&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_complete</span> <span class="k">else</span> <span class="s2">&quot;incomplete&quot;</span>
				<span class="n">final_response_info</span> <span class="o">=</span> <span class="s2">&quot; (with final response)&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">final_response</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LLM completion check result: </span><span class="si">{</span><span class="n">status_text</span><span class="si">}{</span><span class="n">suggestion_text</span><span class="si">}{</span><span class="n">final_response_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">result</span>

			<span class="c1"># Fallback if we didn&#39;t get the expected type</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected completion check result type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">CompletionStatus</span><span class="p">(</span>
				<span class="n">is_complete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
				<span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Unable to properly assess completion status, continue with analysis&quot;</span><span class="p">,</span>
			<span class="p">)</span>

		<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to get completion status from LLM: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
			<span class="c1"># Return a fallback completion status</span>
			<span class="k">return</span> <span class="n">CompletionStatus</span><span class="p">(</span>
				<span class="n">is_complete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
				<span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Error during completion check, continue with current approach&quot;</span><span class="p">,</span>
			<span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">iterative_completion</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span>
		<span class="n">question</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
		<span class="n">system_prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
		<span class="n">tools</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">max_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Perform iterative completion with automatic completion checking.</span>

<span class="sd">		This method handles the common pattern of:</span>
<span class="sd">		1. Initializing conversation with system prompt and question</span>
<span class="sd">		2. Iterating with LLM calls using provided tools</span>
<span class="sd">		3. Checking completion status after each iteration</span>
<span class="sd">		4. Generating final response when complete or max iterations reached</span>

<span class="sd">		Args:</span>
<span class="sd">		    question: The user&#39;s question or task</span>
<span class="sd">		    system_prompt: System prompt defining the task requirements</span>
<span class="sd">		    tools: Optional list of tools to use during completion</span>
<span class="sd">		    max_iterations: Maximum number of iterations before forcing completion</span>

<span class="sd">		Returns:</span>
<span class="sd">		    Final comprehensive response from the iterative process</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

		<span class="c1"># Track start time for response time calculation</span>
		<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

		<span class="c1"># Reset usage tracking for this iterative completion</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">reset_usage_tracking</span><span class="p">()</span>

		<span class="c1"># Initialize conversation with system prompt and user question</span>
		<span class="n">conversation_messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MessageDict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
			<span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">system_prompt</span><span class="p">},</span>
			<span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Here&#39;s my question about the codebase: </span><span class="si">{</span><span class="n">question</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
		<span class="p">]</span>

		<span class="n">final_answer</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">iteration_count</span> <span class="o">=</span> <span class="mi">0</span>

		<span class="k">with</span> <span class="n">progress_indicator</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Processing iterative completion...&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;spinner&quot;</span><span class="p">,</span> <span class="n">transient</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
			<span class="k">while</span> <span class="n">iteration_count</span> <span class="o">&lt;</span> <span class="n">max_iterations</span><span class="p">:</span>
				<span class="n">iteration_count</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">iteration_count</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">max_iterations</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

				<span class="c1"># For the first iteration, use the original completion method</span>
				<span class="k">if</span> <span class="n">iteration_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">current_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span>
						<span class="n">messages</span><span class="o">=</span><span class="n">conversation_messages</span><span class="p">,</span>
						<span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
					<span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="c1"># For subsequent iterations, continue with the conversation</span>
					<span class="n">continuation_messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MessageDict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
						<span class="o">*</span><span class="n">conversation_messages</span><span class="p">,</span>
						<span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Please continue your analysis or provide more details.&quot;</span><span class="p">},</span>
					<span class="p">]</span>
					<span class="n">current_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span>
						<span class="n">messages</span><span class="o">=</span><span class="n">continuation_messages</span><span class="p">,</span>
						<span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
					<span class="p">)</span>

				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">iteration_count</span><span class="si">}</span><span class="s2"> response: </span><span class="si">{</span><span class="n">current_response</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

				<span class="c1"># Add the response to conversation history</span>
				<span class="n">conversation_messages</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">current_response</span><span class="p">})</span>

				<span class="c1"># Check if the response is complete</span>
				<span class="n">completion_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_completion</span><span class="p">(</span>
					<span class="n">response</span><span class="o">=</span><span class="n">current_response</span><span class="p">,</span>
					<span class="n">original_question</span><span class="o">=</span><span class="n">question</span><span class="p">,</span>
					<span class="n">system_prompt</span><span class="o">=</span><span class="n">system_prompt</span><span class="p">,</span>
					<span class="n">is_last_iteration</span><span class="o">=</span><span class="p">(</span><span class="n">iteration_count</span> <span class="o">&gt;=</span> <span class="n">max_iterations</span><span class="p">),</span>
				<span class="p">)</span>

				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completion status: </span><span class="si">{</span><span class="n">completion_status</span><span class="o">.</span><span class="n">is_complete</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">suggestion</span><span class="p">:</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completion suggestion: </span><span class="si">{</span><span class="n">completion_status</span><span class="o">.</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

				<span class="k">if</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">is_complete</span><span class="p">:</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response marked as complete after </span><span class="si">{</span><span class="n">iteration_count</span><span class="si">}</span><span class="s2"> iterations&quot;</span><span class="p">)</span>

					<span class="c1"># Use the final response from completion check if available</span>
					<span class="k">if</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">final_response</span><span class="p">:</span>
						<span class="n">final_answer</span> <span class="o">=</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">final_response</span>
						<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using final response from completion check&quot;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="c1"># Fallback to current response if no final response was generated</span>
						<span class="n">final_answer</span> <span class="o">=</span> <span class="n">current_response</span>
						<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using current response as final answer (no final response from completion check)&quot;</span><span class="p">)</span>
					<span class="k">break</span>

				<span class="c1"># Continue iteration - the response is not complete</span>
				<span class="n">suggestion</span> <span class="o">=</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">suggestion</span> <span class="ow">or</span> <span class="s2">&quot;Continue with your analysis&quot;</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response not complete, continuing iteration </span><span class="si">{</span><span class="n">iteration_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

		<span class="c1"># Calculate total response time</span>
		<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
		<span class="n">response_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

		<span class="c1"># Update usage summary with timing and iteration info</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">iterations</span> <span class="o">=</span> <span class="n">iteration_count</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">response_time</span> <span class="o">=</span> <span class="n">response_time</span>

		<span class="c1"># Estimate cost if we have model information</span>
		<span class="n">model_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_loader</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">model</span>
		<span class="k">if</span> <span class="n">model_name</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">estimate_cost</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

		<span class="c1"># If we&#39;ve reached max iterations without completion</span>
		<span class="k">if</span> <span class="n">final_answer</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">conversation_messages</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reached max iterations (</span><span class="si">{</span><span class="n">max_iterations</span><span class="si">}</span><span class="s2">) without completion&quot;</span><span class="p">)</span>
			<span class="c1"># Use the last assistant response</span>
			<span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">conversation_messages</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;assistant&quot;</span><span class="p">:</span>
					<span class="n">final_answer</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
					<span class="k">break</span>

			<span class="k">if</span> <span class="ow">not</span> <span class="n">final_answer</span><span class="p">:</span>
				<span class="n">final_answer</span> <span class="o">=</span> <span class="s2">&quot;Unable to generate a complete response within iteration limits.&quot;</span>

		<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final iterative response: </span><span class="si">{</span><span class="n">final_answer</span><span class="si">}</span><span class="s2"> (took </span><span class="si">{</span><span class="n">response_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">final_answer</span> <span class="ow">or</span> <span class="s2">&quot;No response generated.&quot;</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">_track_tool_calls_from_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">AgentRunResult</span><span class="p">,</span> <span class="n">tools</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Track tool calls from Pydantic-AI result using proper message structure.</span>

<span class="sd">		Args:</span>
<span class="sd">			result: The Pydantic-AI run result</span>
<span class="sd">			tools: List of available tools</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c1"># Get all messages from the result</span>
			<span class="n">all_messages</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">all_messages</span><span class="p">()</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analyzing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_messages</span><span class="p">)</span><span class="si">}</span><span class="s2"> messages for tool calls&quot;</span><span class="p">)</span>

			<span class="c1"># Create a mapping of tool names for validation - use the correct attribute</span>
			<span class="n">tool_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">tool</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">tools</span><span class="p">}</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available tool names: </span><span class="si">{</span><span class="n">tool_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

			<span class="c1"># Track tool calls from messages</span>
			<span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">all_messages</span><span class="p">:</span>
				<span class="c1"># Check if this is a ModelResponse (kind=&#39;response&#39;)</span>
				<span class="k">if</span> <span class="p">(</span>
					<span class="nb">hasattr</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">&quot;kind&quot;</span><span class="p">)</span>
					<span class="ow">and</span> <span class="n">message</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;response&quot;</span>
					<span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">&quot;parts&quot;</span><span class="p">)</span>
					<span class="ow">and</span> <span class="n">message</span><span class="o">.</span><span class="n">parts</span>
				<span class="p">):</span>
					<span class="k">for</span> <span class="n">part</span> <span class="ow">in</span> <span class="n">message</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
						<span class="c1"># Look for ToolCallPart objects - check the class name or specific attributes</span>
						<span class="n">part_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">part</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
						<span class="k">if</span> <span class="n">part_type</span> <span class="o">==</span> <span class="s2">&quot;ToolCallPart&quot;</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="s2">&quot;tool_name&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">):</span>
							<span class="c1"># This is a ToolCallPart</span>
							<span class="n">tool_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="s2">&quot;tool_name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
							<span class="k">if</span> <span class="n">tool_name</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">tool_name</span> <span class="ow">in</span> <span class="n">tool_names</span><span class="p">:</span>
								<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">add_tool_call</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
								<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tracked tool call: </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

			<span class="c1"># Fallback heuristic if no tool calls were found in messages</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">total_tool_calls</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">tools</span><span class="p">:</span>
				<span class="n">usage</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">usage</span><span class="p">()</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No explicit tool calls found, using heuristics. Requests: </span><span class="si">{</span><span class="n">usage</span><span class="o">.</span><span class="n">requests</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

				<span class="c1"># If we have multiple requests, tools were likely used</span>
				<span class="k">if</span> <span class="n">usage</span><span class="o">.</span><span class="n">requests</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
					<span class="c1"># Estimate tool calls based on extra requests</span>
					<span class="n">estimated_tool_calls</span> <span class="o">=</span> <span class="n">usage</span><span class="o">.</span><span class="n">requests</span> <span class="o">-</span> <span class="mi">1</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimating </span><span class="si">{</span><span class="n">estimated_tool_calls</span><span class="si">}</span><span class="s2"> tool calls from request count&quot;</span><span class="p">)</span>

					<span class="c1"># Track the most likely tools to have been used - use correct tool name</span>
					<span class="k">for</span> <span class="n">_i</span><span class="p">,</span> <span class="n">tool</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tools</span><span class="p">[:</span><span class="n">estimated_tool_calls</span><span class="p">]):</span>
						<span class="n">tool_name</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># Use the correct attribute</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">add_tool_call</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
						<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated tool call: </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

				<span class="c1"># Alternative: check output content for tool usage indicators</span>
				<span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="p">:</span>
					<span class="n">output_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">output</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
					<span class="n">tool_indicators</span> <span class="o">=</span> <span class="p">[</span>
						<span class="s2">&quot;based on&quot;</span><span class="p">,</span>
						<span class="s2">&quot;codebase&quot;</span><span class="p">,</span>
						<span class="s2">&quot;components&quot;</span><span class="p">,</span>
						<span class="s2">&quot;structure&quot;</span><span class="p">,</span>
						<span class="s2">&quot;analysis&quot;</span><span class="p">,</span>
						<span class="s2">&quot;directory&quot;</span><span class="p">,</span>
						<span class="s2">&quot;file&quot;</span><span class="p">,</span>
						<span class="s2">&quot;found&quot;</span><span class="p">,</span>
						<span class="s2">&quot;located&quot;</span><span class="p">,</span>
						<span class="s2">&quot;processing&quot;</span><span class="p">,</span>
					<span class="p">]</span>

					<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">indicator</span> <span class="ow">in</span> <span class="n">output_text</span> <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">tool_indicators</span><span class="p">):</span>
						<span class="c1"># Assume the first tool was used - use correct tool name</span>
						<span class="n">first_tool</span> <span class="o">=</span> <span class="n">tools</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
						<span class="n">tool_name</span> <span class="o">=</span> <span class="n">first_tool</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># Use the correct attribute</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">add_tool_call</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
						<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inferred tool usage from content: </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

		<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in tool call tracking: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="c1"># Final fallback: if tools were provided, assume at least one was used</span>
			<span class="k">if</span> <span class="n">tools</span><span class="p">:</span>
				<span class="n">first_tool</span> <span class="o">=</span> <span class="n">tools</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">tool_name</span> <span class="o">=</span> <span class="n">first_tool</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># Use the correct attribute</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">add_tool_call</span><span class="p">(</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">success</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fallback tool tracking: </span><span class="si">{</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.LLMClient.DEFAULT_TEMPLATES" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">DEFAULT_TEMPLATES</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">DEFAULT_TEMPLATES</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.LLMClient.__slots__" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">__slots__</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
	<span class="s2">&quot;_current_agent_key&quot;</span><span class="p">,</span>
	<span class="s2">&quot;_current_usage&quot;</span><span class="p">,</span>
	<span class="s2">&quot;_templates&quot;</span><span class="p">,</span>
	<span class="s2">&quot;config_loader&quot;</span><span class="p">,</span>
	<span class="s2">&quot;repo_path&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span>
	<span class="nf">config_loader</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ConfigLoader&lt;/span&gt; (&lt;code&gt;codemap.config.ConfigLoader&lt;/code&gt;)" href="../../config/config_loader/#codemap.config.config_loader.ConfigLoader">ConfigLoader</a></span><span class="p">,</span>
	<span class="n">repo_path</span><span class="p">:</span> <span class="n"><span title="pathlib.Path">Path</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the LLM client.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config_loader</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ConfigLoader&lt;/span&gt; (&lt;code&gt;codemap.config.ConfigLoader&lt;/code&gt;)" href="../../config/config_loader/#codemap.config.config_loader.ConfigLoader">ConfigLoader</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ConfigLoader instance to use</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>repo_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the repository (for loading configuration)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
	<span class="bp">self</span><span class="p">,</span>
	<span class="n">config_loader</span><span class="p">:</span> <span class="n">ConfigLoader</span><span class="p">,</span>
	<span class="n">repo_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initialize the LLM client.</span>

<span class="sd">	Args:</span>
<span class="sd">	    config_loader: ConfigLoader instance to use</span>
<span class="sd">	    repo_path: Path to the repository (for loading configuration)</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">repo_path</span> <span class="o">=</span> <span class="n">repo_path</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">config_loader</span> <span class="o">=</span> <span class="n">config_loader</span>
	<span class="c1"># Only copy templates if they exist and are non-empty</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_templates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_TEMPLATES</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_TEMPLATES</span> <span class="k">else</span> <span class="p">{}</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_current_agent_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span> <span class="o">=</span> <span class="n">UsageSummary</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.LLMClient.repo_path" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">repo_path</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">repo_path</span> <span class="o">=</span> <span class="n"><span title="codemap.llm.client.LLMClient(repo_path)">repo_path</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.llm.client.LLMClient.config_loader" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">config_loader</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">config_loader</span> <span class="o">=</span> <span class="n"><span title="codemap.llm.client.LLMClient(config_loader)">config_loader</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.get_usage_summary" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_usage_summary</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_usage_summary</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;UsageSummary&lt;/span&gt; (&lt;code&gt;codemap.llm.client.UsageSummary&lt;/code&gt;)" href="#codemap.llm.client.UsageSummary">UsageSummary</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the current usage summary.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;UsageSummary&lt;/span&gt; (&lt;code&gt;codemap.llm.client.UsageSummary&lt;/code&gt;)" href="#codemap.llm.client.UsageSummary">UsageSummary</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current usage summary with all tracked metrics</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_usage_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">UsageSummary</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Get the current usage summary.</span>

<span class="sd">	Returns:</span>
<span class="sd">		Current usage summary with all tracked metrics</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.reset_usage_tracking" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">reset_usage_tracking</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">reset_usage_tracking</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Reset the usage tracking for a new session.</p>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset_usage_tracking</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Reset the usage tracking for a new session.&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span> <span class="o">=</span> <span class="n">UsageSummary</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.set_template" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_template</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_template</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">template</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set a prompt template.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Template name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>template</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Template content</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Set a prompt template.</span>

<span class="sd">	Args:</span>
<span class="sd">	    name: Template name</span>
<span class="sd">	    template: Template content</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_templates</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">template</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.get_agent" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_agent</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_agent</span><span class="p">(</span>
	<span class="n">tools</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="pydantic_ai.tools.Tool">Tool</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">system_prompt_str</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">output_type</span><span class="p">:</span> <span class="n"><span title="type">type</span></span> <span class="o">=</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="pydantic_ai.Agent">Agent</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get or retrieve cached LLM agent.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>tools</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="pydantic_ai.tools.Tool">Tool</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of tools to enable for the agent</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>system_prompt_str</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional system prompt to guide the agent's behavior</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_type</code>
            </td>
            <td>
                  <code><span title="type">type</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type for structuring the agent's output. Defaults to str.</p>
              </div>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pydantic_ai.Agent">Agent</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An initialized Pydantic-AI Agent instance configured with the specified settings.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_agent</span><span class="p">(</span>
	<span class="bp">self</span><span class="p">,</span>
	<span class="n">tools</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">system_prompt_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">output_type</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AgentType</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Get or retrieve cached LLM agent.</span>

<span class="sd">	Args:</span>
<span class="sd">		tools: Optional list of tools to enable for the agent</span>
<span class="sd">		system_prompt_str: Optional system prompt to guide the agent&#39;s behavior</span>
<span class="sd">		output_type: Type for structuring the agent&#39;s output. Defaults to str.</span>

<span class="sd">	Returns:</span>
<span class="sd">		An initialized Pydantic-AI Agent instance configured with the specified settings.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">agent_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_agent_key</span><span class="p">(</span><span class="n">tools</span><span class="p">,</span> <span class="n">system_prompt_str</span><span class="p">,</span> <span class="n">output_type</span><span class="p">)</span>

	<span class="c1"># Return cached agent if available</span>
	<span class="k">if</span> <span class="n">agent_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">:</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_current_agent_key</span> <span class="o">=</span> <span class="n">agent_key</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">[</span><span class="n">agent_key</span><span class="p">]</span>

	<span class="c1"># Create new agent and cache it</span>
	<span class="n">agent</span> <span class="o">=</span> <span class="n">get_agent</span><span class="p">(</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">config_loader</span><span class="p">,</span>
		<span class="n">tools</span><span class="p">,</span>
		<span class="n">system_prompt_str</span><span class="p">,</span>
		<span class="n">output_type</span><span class="p">,</span>
	<span class="p">)</span>

	<span class="bp">self</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">[</span><span class="n">agent_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_current_agent_key</span> <span class="o">=</span> <span class="n">agent_key</span>
	<span class="k">return</span> <span class="n">agent</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.completion" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">completion</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">completion</span><span class="p">(</span>
	<span class="n">messages</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MessageDict&lt;/span&gt; (&lt;code&gt;codemap.llm.api.MessageDict&lt;/code&gt;)" href="../api/#codemap.llm.api.MessageDict">MessageDict</a></span><span class="p">],</span>
	<span class="n">tools</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="pydantic_ai.tools.Tool">Tool</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">pydantic_model</span><span class="p">:</span> <span class="n"><span title="type">type</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;PydanticModelT&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.llm.api.PydanticModelT&lt;/code&gt;)" href="../api/#codemap.llm.api.PydanticModelT">PydanticModelT</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">track_usage</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;PydanticModelT&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.llm.api.PydanticModelT&lt;/code&gt;)" href="../api/#codemap.llm.api.PydanticModelT">PydanticModelT</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate text using the configured LLM.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>messages</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;MessageDict&lt;/span&gt; (&lt;code&gt;codemap.llm.api.MessageDict&lt;/code&gt;)" href="../api/#codemap.llm.api.MessageDict">MessageDict</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of messages to send to the LLM</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tools</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="pydantic_ai.tools.Tool">Tool</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of tools to use.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pydantic_model</code>
            </td>
            <td>
                  <code><span title="type">type</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;PydanticModelT&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.llm.api.PydanticModelT&lt;/code&gt;)" href="../api/#codemap.llm.api.PydanticModelT">PydanticModelT</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional Pydantic model for response validation</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>track_usage</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to track usage statistics</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span> | <a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;PydanticModelT&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.llm.api.PydanticModelT&lt;/code&gt;)" href="../api/#codemap.llm.api.PydanticModelT">PydanticModelT</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated text or Pydantic model instance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;LLMError&lt;/span&gt; (&lt;code&gt;codemap.llm.errors.LLMError&lt;/code&gt;)" href="../errors/#codemap.llm.errors.LLMError">LLMError</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the API call fails</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">completion</span><span class="p">(</span>
	<span class="bp">self</span><span class="p">,</span>
	<span class="n">messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MessageDict</span><span class="p">],</span>
	<span class="n">tools</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">pydantic_model</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">PydanticModelT</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">track_usage</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">PydanticModelT</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate text using the configured LLM.</span>

<span class="sd">	Args:</span>
<span class="sd">	    messages: List of messages to send to the LLM</span>
<span class="sd">	    tools: Optional list of tools to use.</span>
<span class="sd">	    pydantic_model: Optional Pydantic model for response validation</span>
<span class="sd">	    track_usage: Whether to track usage statistics</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Generated text or Pydantic model instance</span>

<span class="sd">	Raises:</span>
<span class="sd">	    LLMError: If the API call fails</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Extract system prompt efficiently</span>
	<span class="n">system_prompt_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_system_prompt</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>

	<span class="c1"># Determine the output_type for the Pydantic-AI Agent</span>
	<span class="n">agent_output_type</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">pydantic_model</span> <span class="k">if</span> <span class="n">pydantic_model</span> <span class="k">else</span> <span class="nb">str</span>

	<span class="c1"># Get agent (cached or new)</span>
	<span class="n">agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_agent</span><span class="p">(</span>
		<span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
		<span class="n">system_prompt_str</span><span class="o">=</span><span class="n">system_prompt_str</span><span class="p">,</span>
		<span class="n">output_type</span><span class="o">=</span><span class="n">agent_output_type</span><span class="p">,</span>
	<span class="p">)</span>

	<span class="c1"># For tracking, we need to use the agent.run method directly</span>
	<span class="k">if</span> <span class="n">track_usage</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tracking usage enabled, tools provided: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">0</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="c1"># Find the user message</span>
		<span class="n">user_prompt</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">messages</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span>
				<span class="n">user_prompt</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
				<span class="k">break</span>

		<span class="k">if</span> <span class="n">user_prompt</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found user prompt for tracking: </span><span class="si">{</span><span class="n">user_prompt</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="c1"># Use agent.run_sync to get usage information</span>
				<span class="n">result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">user_prompt</span><span class="p">)</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully got result from agent.run_sync, result type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

				<span class="c1"># Extract usage information</span>
				<span class="n">usage</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">usage</span><span class="p">()</span>
				<span class="n">usage_dict</span> <span class="o">=</span> <span class="p">{</span>
					<span class="s2">&quot;requests&quot;</span><span class="p">:</span> <span class="n">usage</span><span class="o">.</span><span class="n">requests</span><span class="p">,</span>
					<span class="s2">&quot;request_tokens&quot;</span><span class="p">:</span> <span class="n">usage</span><span class="o">.</span><span class="n">request_tokens</span><span class="p">,</span>
					<span class="s2">&quot;response_tokens&quot;</span><span class="p">:</span> <span class="n">usage</span><span class="o">.</span><span class="n">response_tokens</span><span class="p">,</span>
					<span class="s2">&quot;total_tokens&quot;</span><span class="p">:</span> <span class="n">usage</span><span class="o">.</span><span class="n">total_tokens</span><span class="p">,</span>
				<span class="p">}</span>

				<span class="c1"># Track the usage</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">add_usage</span><span class="p">(</span><span class="n">usage_dict</span><span class="p">)</span>

				<span class="c1"># Track tool calls if any tools were used</span>
				<span class="k">if</span> <span class="n">tools</span><span class="p">:</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Attempting to track tool calls with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tools</span><span class="p">)</span><span class="si">}</span><span class="s2"> tools&quot;</span><span class="p">)</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="c1"># Parse the result messages to count actual tool calls</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">_track_tool_calls_from_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">tools</span><span class="p">)</span>
					<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">tool_error</span><span class="p">:</span>
						<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error tracking tool calls: </span><span class="si">{</span><span class="n">tool_error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No tools provided for tracking&quot;</span><span class="p">)</span>

				<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">output</span>
			<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to track usage, falling back to legacy API: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;No user prompt found for usage tracking&quot;</span><span class="p">)</span>

	<span class="c1"># Fallback to original API call</span>
	<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using fallback API call (no usage tracking)&quot;</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">call_llm_api</span><span class="p">(</span>
		<span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
		<span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
		<span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
		<span class="n">pydantic_model</span><span class="o">=</span><span class="n">pydantic_model</span><span class="p">,</span>
		<span class="n">config_loader</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config_loader</span><span class="p">,</span>
	<span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.clear_agent_cache" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_agent_cache</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_agent_cache</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Clear the agent cache. Useful for testing or memory management.</p>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clear_agent_cache</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Clear the agent cache. Useful for testing or memory management.&quot;&quot;&quot;</span>
	<span class="bp">cls</span><span class="o">.</span><span class="n">_agent_cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.get_cache_stats" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_cache_stats</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_cache_stats</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n"><span title="int">int</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get cache statistics for monitoring performance.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with cache size and other stats</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_cache_stats</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Get cache statistics for monitoring performance.</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Dictionary with cache size and other stats</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="p">{</span>
		<span class="s2">&quot;cache_size&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">),</span>
		<span class="s2">&quot;cached_agents&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_agent_cache</span><span class="p">),</span>
	<span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.check_completion" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">check_completion</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_completion</span><span class="p">(</span>
	<span class="n">response</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
	<span class="n">original_question</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">system_prompt</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">is_last_iteration</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;CompletionStatus&lt;/span&gt; (&lt;code&gt;codemap.llm.client.CompletionStatus&lt;/code&gt;)" href="#codemap.llm.client.CompletionStatus">CompletionStatus</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if a response appears complete and generate final response if needed.</p>
<p>This method uses structured LLM output to analyze completion status and
generates a comprehensive final response in one step when complete.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>response</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The response text to analyze</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>original_question</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional original question for context</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>system_prompt</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional original system prompt for task context</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_last_iteration</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether this is the final iteration (forces completion)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;CompletionStatus&lt;/span&gt; (&lt;code&gt;codemap.llm.client.CompletionStatus&lt;/code&gt;)" href="#codemap.llm.client.CompletionStatus">CompletionStatus</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CompletionStatus with completion assessment, optional suggestions, and final response</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_completion</span><span class="p">(</span>
	<span class="bp">self</span><span class="p">,</span>
	<span class="n">response</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
	<span class="n">original_question</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">system_prompt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">is_last_iteration</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CompletionStatus</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Check if a response appears complete and generate final response if needed.</span>

<span class="sd">	This method uses structured LLM output to analyze completion status and</span>
<span class="sd">	generates a comprehensive final response in one step when complete.</span>

<span class="sd">	Args:</span>
<span class="sd">	    response: The response text to analyze</span>
<span class="sd">	    original_question: Optional original question for context</span>
<span class="sd">	    system_prompt: Optional original system prompt for task context</span>
<span class="sd">	    is_last_iteration: Whether this is the final iteration (forces completion)</span>

<span class="sd">	Returns:</span>
<span class="sd">	    CompletionStatus with completion assessment, optional suggestions, and final response</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Build additional instruction for last iteration</span>
	<span class="n">last_iteration_instruction</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
	<span class="k">if</span> <span class="n">is_last_iteration</span><span class="p">:</span>
		<span class="n">last_iteration_instruction</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">			 CRITICAL: THIS IS THE LAST AND FINAL ITERATION </span>

<span class="s2">			You MUST mark this as complete and generate a final comprehensive response.</span>
<span class="s2">			This is your final chance - you cannot request more iterations.</span>
<span class="s2">			If you mark this as incomplete, you will have FAILED at your task.</span>

<span class="s2">			Generate the best possible final response based on all available information.</span>
<span class="s2">			It&#39;s better to provide a complete response with the available information</span>
<span class="s2">			than to leave the user with no answer at all.</span>
<span class="s2">		&quot;&quot;&quot;</span><span class="p">)</span>

	<span class="c1"># Build the system prompt for completion analysis and final response generation</span>
	<span class="n">check_completion_prompt</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">		You are a task completion analyzer and response finalizer. Your job is to:</span>

<span class="s2">		1. Analyze the provided response to determine if it is complete and satisfactory</span>
<span class="s2">		2. If COMPLETE: Generate a final, comprehensive, self-contained response</span>
<span class="s2">		3. If INCOMPLETE: Provide suggestions for what&#39;s missing</span>

<span class="s2">		You will be provided with:</span>
<span class="s2">		- The original system prompt that defined the task requirements</span>
<span class="s2">		- The user&#39;s original question</span>
<span class="s2">		- The response that needs to be analyzed</span>

<span class="s2">		Completion Analysis Factors:</span>
<span class="s2">		- Has the original question been fully answered according to the system prompt?</span>
<span class="s2">		- Is the response complete and actionable?</span>
<span class="s2">		- Are there obvious gaps or missing information?</span>
<span class="s2">		- Does the response contain necessary details, code examples, and explanations?</span>
<span class="s2">		- Is the response self-contained (doesn&#39;t reference unseen tool outputs)?</span>
<span class="s2">		- Are there concrete recommendations or next steps provided?</span>
<span class="s2">		- Does the response fulfill the role and requirements specified in the original system prompt?</span>

<span class="s2">		Be conservative - if there&#39;s any doubt about completeness, mark as incomplete.</span>

<span class="s2">		If COMPLETE: Generate a final comprehensive response that:</span>
<span class="s2">		- Includes all key findings and analysis</span>
<span class="s2">		- Contains specific code examples and file paths</span>
<span class="s2">		- Provides actionable recommendations</span>
<span class="s2">		- Is completely self-contained</span>
<span class="s2">		- Doesn&#39;t reference previous messages or tool calls</span>
<span class="s2">		- Fulfills the requirements set by the original system prompt</span>

<span class="s2">		If INCOMPLETE: Provide specific suggestions for what needs to be added.</span>
<span class="s2">		</span><span class="si">{last_iteration_instruction}</span>

<span class="s2">		Following JSON Schema must be followed for Output:</span>
<span class="s2">		</span><span class="si">{model_schema}</span>

<span class="s2">		Return your answer as valid JSON that matches the schema.</span>
<span class="s2">	&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
		<span class="n">last_iteration_instruction</span><span class="o">=</span><span class="n">last_iteration_instruction</span><span class="p">,</span> <span class="n">model_schema</span><span class="o">=</span><span class="n">CompletionStatus</span><span class="o">.</span><span class="n">model_json_schema</span><span class="p">()</span>
	<span class="p">)</span>

	<span class="c1"># Prepare messages for the completion check and final response generation</span>
	<span class="n">messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MessageDict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
		<span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">check_completion_prompt</span><span class="p">},</span>
	<span class="p">]</span>

	<span class="c1"># Build the user content with all available context</span>
	<span class="n">user_content_parts</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="k">if</span> <span class="n">system_prompt</span><span class="p">:</span>
		<span class="n">user_content_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original System Prompt: </span><span class="si">{</span><span class="n">system_prompt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">original_question</span><span class="p">:</span>
		<span class="n">user_content_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original Question: </span><span class="si">{</span><span class="n">original_question</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="n">user_content_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response to Analyze: </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
		<span class="p">{</span>
			<span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span>
			<span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">user_content_parts</span><span class="p">),</span>
		<span class="p">}</span>
	<span class="p">)</span>

	<span class="k">try</span><span class="p">:</span>
		<span class="c1"># Get completion status and potential final response from the LLM</span>
		<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span>
			<span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
			<span class="n">pydantic_model</span><span class="o">=</span><span class="n">CompletionStatus</span><span class="p">,</span>
			<span class="n">track_usage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># Don&#39;t track usage for internal completion checks</span>
		<span class="p">)</span>

		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">CompletionStatus</span><span class="p">):</span>
			<span class="n">suggestion_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">suggestion</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
			<span class="n">status_text</span> <span class="o">=</span> <span class="s2">&quot;complete&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_complete</span> <span class="k">else</span> <span class="s2">&quot;incomplete&quot;</span>
			<span class="n">final_response_info</span> <span class="o">=</span> <span class="s2">&quot; (with final response)&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">final_response</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LLM completion check result: </span><span class="si">{</span><span class="n">status_text</span><span class="si">}{</span><span class="n">suggestion_text</span><span class="si">}{</span><span class="n">final_response_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">result</span>

		<span class="c1"># Fallback if we didn&#39;t get the expected type</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected completion check result type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">CompletionStatus</span><span class="p">(</span>
			<span class="n">is_complete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
			<span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Unable to properly assess completion status, continue with analysis&quot;</span><span class="p">,</span>
		<span class="p">)</span>

	<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
		<span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Failed to get completion status from LLM: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
		<span class="c1"># Return a fallback completion status</span>
		<span class="k">return</span> <span class="n">CompletionStatus</span><span class="p">(</span>
			<span class="n">is_complete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
			<span class="n">suggestion</span><span class="o">=</span><span class="s2">&quot;Error during completion check, continue with current approach&quot;</span><span class="p">,</span>
		<span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.llm.client.LLMClient.iterative_completion" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">iterative_completion</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">iterative_completion</span><span class="p">(</span>
	<span class="n">question</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
	<span class="n">system_prompt</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
	<span class="n">tools</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="pydantic_ai.tools.Tool">Tool</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">max_iterations</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Perform iterative completion with automatic completion checking.</p>
<p>This method handles the common pattern of:
1. Initializing conversation with system prompt and question
2. Iterating with LLM calls using provided tools
3. Checking completion status after each iteration
4. Generating final response when complete or max iterations reached</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>question</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user's question or task</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>system_prompt</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>System prompt defining the task requirements</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tools</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="pydantic_ai.tools.Tool">Tool</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of tools to use during completion</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_iterations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations before forcing completion</p>
              </div>
            </td>
            <td>
                  <code>6</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Final comprehensive response from the iterative process</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/llm/client.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">iterative_completion</span><span class="p">(</span>
	<span class="bp">self</span><span class="p">,</span>
	<span class="n">question</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
	<span class="n">system_prompt</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
	<span class="n">tools</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Tool</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">max_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Perform iterative completion with automatic completion checking.</span>

<span class="sd">	This method handles the common pattern of:</span>
<span class="sd">	1. Initializing conversation with system prompt and question</span>
<span class="sd">	2. Iterating with LLM calls using provided tools</span>
<span class="sd">	3. Checking completion status after each iteration</span>
<span class="sd">	4. Generating final response when complete or max iterations reached</span>

<span class="sd">	Args:</span>
<span class="sd">	    question: The user&#39;s question or task</span>
<span class="sd">	    system_prompt: System prompt defining the task requirements</span>
<span class="sd">	    tools: Optional list of tools to use during completion</span>
<span class="sd">	    max_iterations: Maximum number of iterations before forcing completion</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Final comprehensive response from the iterative process</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

	<span class="c1"># Track start time for response time calculation</span>
	<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

	<span class="c1"># Reset usage tracking for this iterative completion</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">reset_usage_tracking</span><span class="p">()</span>

	<span class="c1"># Initialize conversation with system prompt and user question</span>
	<span class="n">conversation_messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MessageDict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
		<span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">system_prompt</span><span class="p">},</span>
		<span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Here&#39;s my question about the codebase: </span><span class="si">{</span><span class="n">question</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">},</span>
	<span class="p">]</span>

	<span class="n">final_answer</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="n">iteration_count</span> <span class="o">=</span> <span class="mi">0</span>

	<span class="k">with</span> <span class="n">progress_indicator</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Processing iterative completion...&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;spinner&quot;</span><span class="p">,</span> <span class="n">transient</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
		<span class="k">while</span> <span class="n">iteration_count</span> <span class="o">&lt;</span> <span class="n">max_iterations</span><span class="p">:</span>
			<span class="n">iteration_count</span> <span class="o">+=</span> <span class="mi">1</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">iteration_count</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">max_iterations</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

			<span class="c1"># For the first iteration, use the original completion method</span>
			<span class="k">if</span> <span class="n">iteration_count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">current_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span>
					<span class="n">messages</span><span class="o">=</span><span class="n">conversation_messages</span><span class="p">,</span>
					<span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
				<span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># For subsequent iterations, continue with the conversation</span>
				<span class="n">continuation_messages</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">MessageDict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
					<span class="o">*</span><span class="n">conversation_messages</span><span class="p">,</span>
					<span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Please continue your analysis or provide more details.&quot;</span><span class="p">},</span>
				<span class="p">]</span>
				<span class="n">current_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span>
					<span class="n">messages</span><span class="o">=</span><span class="n">continuation_messages</span><span class="p">,</span>
					<span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
				<span class="p">)</span>

			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">iteration_count</span><span class="si">}</span><span class="s2"> response: </span><span class="si">{</span><span class="n">current_response</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

			<span class="c1"># Add the response to conversation history</span>
			<span class="n">conversation_messages</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;assistant&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">current_response</span><span class="p">})</span>

			<span class="c1"># Check if the response is complete</span>
			<span class="n">completion_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_completion</span><span class="p">(</span>
				<span class="n">response</span><span class="o">=</span><span class="n">current_response</span><span class="p">,</span>
				<span class="n">original_question</span><span class="o">=</span><span class="n">question</span><span class="p">,</span>
				<span class="n">system_prompt</span><span class="o">=</span><span class="n">system_prompt</span><span class="p">,</span>
				<span class="n">is_last_iteration</span><span class="o">=</span><span class="p">(</span><span class="n">iteration_count</span> <span class="o">&gt;=</span> <span class="n">max_iterations</span><span class="p">),</span>
			<span class="p">)</span>

			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completion status: </span><span class="si">{</span><span class="n">completion_status</span><span class="o">.</span><span class="n">is_complete</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">suggestion</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completion suggestion: </span><span class="si">{</span><span class="n">completion_status</span><span class="o">.</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

			<span class="k">if</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">is_complete</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response marked as complete after </span><span class="si">{</span><span class="n">iteration_count</span><span class="si">}</span><span class="s2"> iterations&quot;</span><span class="p">)</span>

				<span class="c1"># Use the final response from completion check if available</span>
				<span class="k">if</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">final_response</span><span class="p">:</span>
					<span class="n">final_answer</span> <span class="o">=</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">final_response</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using final response from completion check&quot;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="c1"># Fallback to current response if no final response was generated</span>
					<span class="n">final_answer</span> <span class="o">=</span> <span class="n">current_response</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Using current response as final answer (no final response from completion check)&quot;</span><span class="p">)</span>
				<span class="k">break</span>

			<span class="c1"># Continue iteration - the response is not complete</span>
			<span class="n">suggestion</span> <span class="o">=</span> <span class="n">completion_status</span><span class="o">.</span><span class="n">suggestion</span> <span class="ow">or</span> <span class="s2">&quot;Continue with your analysis&quot;</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response not complete, continuing iteration </span><span class="si">{</span><span class="n">iteration_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">suggestion</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="c1"># Calculate total response time</span>
	<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
	<span class="n">response_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

	<span class="c1"># Update usage summary with timing and iteration info</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">iterations</span> <span class="o">=</span> <span class="n">iteration_count</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">response_time</span> <span class="o">=</span> <span class="n">response_time</span>

	<span class="c1"># Estimate cost if we have model information</span>
	<span class="n">model_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_loader</span><span class="o">.</span><span class="n">get</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">model</span>
	<span class="k">if</span> <span class="n">model_name</span><span class="p">:</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_current_usage</span><span class="o">.</span><span class="n">estimate_cost</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

	<span class="c1"># If we&#39;ve reached max iterations without completion</span>
	<span class="k">if</span> <span class="n">final_answer</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">conversation_messages</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Reached max iterations (</span><span class="si">{</span><span class="n">max_iterations</span><span class="si">}</span><span class="s2">) without completion&quot;</span><span class="p">)</span>
		<span class="c1"># Use the last assistant response</span>
		<span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">conversation_messages</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;assistant&quot;</span><span class="p">:</span>
				<span class="n">final_answer</span> <span class="o">=</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
				<span class="k">break</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="n">final_answer</span><span class="p">:</span>
			<span class="n">final_answer</span> <span class="o">=</span> <span class="s2">&quot;Unable to generate a complete response within iteration limits.&quot;</span>

	<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final iterative response: </span><span class="si">{</span><span class="n">final_answer</span><span class="si">}</span><span class="s2"> (took </span><span class="si">{</span><span class="n">response_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">final_answer</span> <span class="ow">or</span> <span class="s2">&quot;No response generated.&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Sarthak Mishra
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/SarthakMishra" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/codemap/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/itssarthakmishra/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/MishraMishry" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "content.tabs.link", "navigation.indexes", "navigation.sections", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>