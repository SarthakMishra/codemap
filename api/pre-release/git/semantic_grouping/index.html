
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A CLI tool that generates optimized markdown docs and streamline Git workflows">
      
      
        <meta name="author" content="Sarthak Mishra">
      
      
        <link rel="canonical" href="https://codemap.run/api/pre-release/git/semantic_grouping/">
      
      
        <link rel="prev" href="../pr_generator/utils/">
      
      
        <link rel="next" href="batch_processor/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Semantic Grouping Overview - Codemap</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Geist:300,300i,400,400i,700,700i%7CGeist+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Geist";--md-code-font:"Geist Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#semantic-grouping-overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Codemap" class="md-header__button md-logo" aria-label="Codemap" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Codemap
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Semantic Grouping Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/SarthakMishra/codemap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SarthakMishra/codemap
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Codemap" class="md-nav__button md-logo" aria-label="Codemap" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Codemap
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/SarthakMishra/codemap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SarthakMishra/codemap
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../usage/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../usage/generate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generate Docs (`gen`)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../usage/commit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Smart Commit (`commit`)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../usage/pr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pull Requests (`pr`)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../usage/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../usage/llm-support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLM Support
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../contributing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/guidelines/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing Guidelines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../contributing/code-of-conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../acknowledgements/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acknowledgements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6" id="__nav_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Stable
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2" id="__nav_1_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2">
            <span class="md-nav__icon md-icon"></span>
            Stable
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/cli/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Cli
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_2" id="__nav_1_6_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_2">
            <span class="md-nav__icon md-icon"></span>
            Cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/cli/ask_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ask Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/cli/commit_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commit Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/cli/gen_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gen Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/cli/index_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/cli/pr_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pr Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/db/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Db
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_4" id="__nav_1_6_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_4">
            <span class="md-nav__icon md-icon"></span>
            Db
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/db/client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/db/engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/db/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/gen/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Gen
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_5" id="__nav_1_6_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_5">
            <span class="md-nav__icon md-icon"></span>
            Gen
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/gen/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/gen/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/gen/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/gen/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/git/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_6" id="__nav_1_6_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_6">
            <span class="md-nav__icon md-icon"></span>
            Git
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/git/commit_generator/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Commit Generator
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_6_2" id="__nav_1_6_2_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_2_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_6_2">
            <span class="md-nav__icon md-icon"></span>
            Commit Generator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_generator/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_generator/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_generator/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_generator/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_generator/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_6_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/git/commit_linter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Commit Linter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_6_3" id="__nav_1_6_2_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_2_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_6_3">
            <span class="md-nav__icon md-icon"></span>
            Commit Linter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_linter/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_linter/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_linter/linter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_linter/parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/commit_linter/validators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validators
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_6_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/git/diff_splitter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Diff Splitter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_6_4" id="__nav_1_6_2_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_2_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_6_4">
            <span class="md-nav__icon md-icon"></span>
            Diff Splitter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/diff_splitter/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/diff_splitter/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/diff_splitter/splitter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Splitter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/diff_splitter/strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/diff_splitter/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/interactive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interactive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_6_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/git/pr_generator/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Pr Generator
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_6_6" id="__nav_1_6_2_6_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_2_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_6_6">
            <span class="md-nav__icon md-icon"></span>
            Pr Generator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/pr_generator/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/pr_generator/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/pr_generator/decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/pr_generator/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/pr_generator/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/pr_generator/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/pr_generator/strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/pr_generator/templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/pr_generator/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_6_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/git/semantic_grouping/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Semantic Grouping
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_6_7" id="__nav_1_6_2_6_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_2_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_6_7">
            <span class="md-nav__icon md-icon"></span>
            Semantic Grouping
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/semantic_grouping/batch_processor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Batch Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/semantic_grouping/clusterer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clusterer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/semantic_grouping/context_processor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/semantic_grouping/embedder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/semantic_grouping/group/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Group
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/semantic_grouping/resolver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resolver
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/git/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/llm/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Llm
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_7" id="__nav_1_6_2_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_7">
            <span class="md-nav__icon md-icon"></span>
            Llm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/llm/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Api
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/llm/client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/llm/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/llm/errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_7_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/llm/rag/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Rag
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_7_6" id="__nav_1_6_2_7_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_2_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_7_6">
            <span class="md-nav__icon md-icon"></span>
            Rag
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/llm/rag/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/llm/rag/formatter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Formatter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/llm/rag/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/llm/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/processor/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Processor
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_8" id="__nav_1_6_2_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_2_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_8">
            <span class="md-nav__icon md-icon"></span>
            Processor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/lod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_8_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/processor/tree_sitter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tree Sitter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_8_4" id="__nav_1_6_2_8_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_2_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_8_4">
            <span class="md-nav__icon md-icon"></span>
            Tree Sitter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/tree_sitter/analyzer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analyzer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/tree_sitter/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_8_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/processor/tree_sitter/languages/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Languages
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_8_4_4" id="__nav_1_6_2_8_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_6_2_8_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_8_4_4">
            <span class="md-nav__icon md-icon"></span>
            Languages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/tree_sitter/languages/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/tree_sitter/languages/javascript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Javascript
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/tree_sitter/languages/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/tree_sitter/languages/typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Typescript
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_8_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/processor/utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_8_5" id="__nav_1_6_2_8_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_2_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_8_5">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/utils/embedding_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedding Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/utils/git_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/utils/sync_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_8_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/processor/vector/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Vector
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_8_6" id="__nav_1_6_2_8_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_2_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_8_6">
            <span class="md-nav__icon md-icon"></span>
            Vector
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/vector/chunking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chunking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/vector/qdrant_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qdrant Manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/processor/vector/synchronizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Synchronizer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_9" id="__nav_1_6_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_9">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/utils/cli_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cli Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/utils/config_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config Loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/utils/docker_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/utils/file_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/utils/log_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Log Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/utils/path_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Path Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../stable/watcher/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Watcher
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_2_10" id="__nav_1_6_2_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2_10">
            <span class="md-nav__icon md-icon"></span>
            Watcher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../stable/watcher/file_watcher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Watcher
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Pre-release
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3" id="__nav_1_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_6_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_6_3">
            <span class="md-nav__icon md-icon"></span>
            Pre-release
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cli/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Cli
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_2" id="__nav_1_6_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_2">
            <span class="md-nav__icon md-icon"></span>
            Cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/ask_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ask Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/commit_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commit Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/gen_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gen Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/index_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/pr_cmd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pr Cmd
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../db/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Db
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_4" id="__nav_1_6_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_4">
            <span class="md-nav__icon md-icon"></span>
            Db
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../db/client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../db/engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Engine
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../db/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../gen/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Gen
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_5" id="__nav_1_6_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_5">
            <span class="md-nav__icon md-icon"></span>
            Gen
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gen/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gen/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gen/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gen/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Git
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_6" id="__nav_1_6_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_3_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_6_3_6">
            <span class="md-nav__icon md-icon"></span>
            Git
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../commit_generator/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Commit Generator
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_6_2" id="__nav_1_6_3_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_3_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_6_2">
            <span class="md-nav__icon md-icon"></span>
            Commit Generator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_generator/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_generator/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_generator/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_generator/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_generator/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_6_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../commit_linter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Commit Linter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_6_3" id="__nav_1_6_3_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_3_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_6_3">
            <span class="md-nav__icon md-icon"></span>
            Commit Linter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_linter/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_linter/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_linter/linter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_linter/parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commit_linter/validators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validators
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_6_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../diff_splitter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Diff Splitter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_6_4" id="__nav_1_6_3_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_3_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_6_4">
            <span class="md-nav__icon md-icon"></span>
            Diff Splitter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diff_splitter/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diff_splitter/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diff_splitter/splitter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Splitter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diff_splitter/strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../diff_splitter/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interactive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interactive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_6_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../pr_generator/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Pr Generator
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_6_6" id="__nav_1_6_3_6_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_3_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_6_6">
            <span class="md-nav__icon md-icon"></span>
            Pr Generator
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pr_generator/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pr_generator/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pr_generator/decorators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decorators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pr_generator/generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pr_generator/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pr_generator/schemas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Schemas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pr_generator/strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strategies
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pr_generator/templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pr_generator/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_6_7" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  
  <span class="md-ellipsis">
    Semantic Grouping
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_1_6_3_6_7" id="__nav_1_6_3_6_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_3_6_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_6_3_6_7">
            <span class="md-nav__icon md-icon"></span>
            Semantic Grouping
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="batch_processor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Batch Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="clusterer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clusterer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="context_processor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Context Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="embedder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="group/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Group
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="resolver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resolver
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../llm/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Llm
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_7" id="__nav_1_6_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_7">
            <span class="md-nav__icon md-icon"></span>
            Llm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Api
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Errors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_7_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../llm/rag/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Rag
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_7_6" id="__nav_1_6_3_7_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_3_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_7_6">
            <span class="md-nav__icon md-icon"></span>
            Rag
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/rag/command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/rag/formatter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Formatter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/rag/prompts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../llm/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Processor
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_8" id="__nav_1_6_3_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_8">
            <span class="md-nav__icon md-icon"></span>
            Processor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/lod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lod
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_8_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/tree_sitter/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tree Sitter
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_8_4" id="__nav_1_6_3_8_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_3_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_8_4">
            <span class="md-nav__icon md-icon"></span>
            Tree Sitter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/analyzer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analyzer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_8_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/tree_sitter/languages/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Languages
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_8_4_4" id="__nav_1_6_3_8_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_6_3_8_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_8_4_4">
            <span class="md-nav__icon md-icon"></span>
            Languages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/languages/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/languages/javascript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Javascript
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/languages/python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/tree_sitter/languages/typescript/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Typescript
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_8_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_8_5" id="__nav_1_6_3_8_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_3_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_8_5">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/utils/embedding_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Embedding Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/utils/git_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/utils/sync_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sync Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_8_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processor/vector/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Vector
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_8_6" id="__nav_1_6_3_8_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_6_3_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_8_6">
            <span class="md-nav__icon md-icon"></span>
            Vector
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/vector/chunking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chunking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/vector/qdrant_manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qdrant Manager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processor/vector/synchronizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Synchronizer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_9" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_9" id="__nav_1_6_3_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_9">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/cli_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cli Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/config_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config Loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/docker_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/file_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/log_setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Log Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/path_utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Path Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_3_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../watcher/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Watcher
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6_3_10" id="__nav_1_6_3_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_6_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_3_10">
            <span class="md-nav__icon md-icon"></span>
            Watcher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../watcher/file_watcher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    File Watcher
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping" class="md-nav__link">
    <span class="md-ellipsis">
      semantic_grouping
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.batch_generate_messages" class="md-nav__link">
    <span class="md-ellipsis">
      batch_generate_messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffClusterer" class="md-nav__link">
    <span class="md-ellipsis">
      DiffClusterer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DiffClusterer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffClusterer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffClusterer.method" class="md-nav__link">
    <span class="md-ellipsis">
      method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffClusterer.kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffClusterer.AgglomerativeClustering" class="md-nav__link">
    <span class="md-ellipsis">
      AgglomerativeClustering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffClusterer.DBSCAN" class="md-nav__link">
    <span class="md-ellipsis">
      DBSCAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffClusterer.cosine_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      cosine_similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffClusterer.cluster" class="md-nav__link">
    <span class="md-ellipsis">
      cluster
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.format_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      format_chunk
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.prioritize_chunks" class="md-nav__link">
    <span class="md-ellipsis">
      prioritize_chunks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.process_chunks_with_lod" class="md-nav__link">
    <span class="md-ellipsis">
      process_chunks_with_lod
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffEmbedder" class="md-nav__link">
    <span class="md-ellipsis">
      DiffEmbedder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DiffEmbedder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffEmbedder.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffEmbedder.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffEmbedder.preprocess_diff" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_diff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffEmbedder.embed_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      embed_chunk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.DiffEmbedder.embed_chunks" class="md-nav__link">
    <span class="md-ellipsis">
      embed_chunks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.FileIntegrityResolver" class="md-nav__link">
    <span class="md-ellipsis">
      FileIntegrityResolver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FileIntegrityResolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.FileIntegrityResolver.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.FileIntegrityResolver.similarity_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      similarity_threshold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.FileIntegrityResolver.cosine_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      cosine_similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.FileIntegrityResolver.calculate_group_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_group_similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.FileIntegrityResolver.resolve_violations" class="md-nav__link">
    <span class="md-ellipsis">
      resolve_violations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup" class="md-nav__link">
    <span class="md-ellipsis">
      SemanticGroup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SemanticGroup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup.chunks" class="md-nav__link">
    <span class="md-ellipsis">
      chunks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup.files" class="md-nav__link">
    <span class="md-ellipsis">
      files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup.content" class="md-nav__link">
    <span class="md-ellipsis">
      content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup.message" class="md-nav__link">
    <span class="md-ellipsis">
      message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup.approved" class="md-nav__link">
    <span class="md-ellipsis">
      approved
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup.embedding" class="md-nav__link">
    <span class="md-ellipsis">
      embedding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.SemanticGroup.merge_with" class="md-nav__link">
    <span class="md-ellipsis">
      merge_with
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.batch_processor" class="md-nav__link">
    <span class="md-ellipsis">
      batch_processor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="batch_processor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.batch_processor.logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.batch_processor.batch_generate_messages" class="md-nav__link">
    <span class="md-ellipsis">
      batch_generate_messages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.resolver" class="md-nav__link">
    <span class="md-ellipsis">
      resolver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="resolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.resolver.logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.resolver.T" class="md-nav__link">
    <span class="md-ellipsis">
      T
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.resolver.FileIntegrityResolver" class="md-nav__link">
    <span class="md-ellipsis">
      FileIntegrityResolver
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FileIntegrityResolver">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.resolver.FileIntegrityResolver.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.resolver.FileIntegrityResolver.similarity_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      similarity_threshold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.resolver.FileIntegrityResolver.cosine_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      cosine_similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.resolver.FileIntegrityResolver.calculate_group_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_group_similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.resolver.FileIntegrityResolver.resolve_violations" class="md-nav__link">
    <span class="md-ellipsis">
      resolve_violations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor" class="md-nav__link">
    <span class="md-ellipsis">
      context_processor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="context_processor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_MAX_TOKENS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.CHUNK_TOKEN_ESTIMATE" class="md-nav__link">
    <span class="md-ellipsis">
      CHUNK_TOKEN_ESTIMATE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.MAX_CHUNKS" class="md-nav__link">
    <span class="md-ellipsis">
      MAX_CHUNKS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.MAX_SIMPLE_CHUNKS" class="md-nav__link">
    <span class="md-ellipsis">
      MAX_SIMPLE_CHUNKS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.process_chunks_with_lod" class="md-nav__link">
    <span class="md-ellipsis">
      process_chunks_with_lod
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.prioritize_chunks" class="md-nav__link">
    <span class="md-ellipsis">
      prioritize_chunks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.get_file_paths_from_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      get_file_paths_from_chunk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.format_lod_entity" class="md-nav__link">
    <span class="md-ellipsis">
      format_lod_entity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.format_entity_structure" class="md-nav__link">
    <span class="md-ellipsis">
      format_entity_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.format_entity_signatures" class="md-nav__link">
    <span class="md-ellipsis">
      format_entity_signatures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.format_regular_chunks" class="md-nav__link">
    <span class="md-ellipsis">
      format_regular_chunks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.format_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      format_chunk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.estimate_tokens" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_tokens
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.context_processor.truncate_context" class="md-nav__link">
    <span class="md-ellipsis">
      truncate_context
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group" class="md-nav__link">
    <span class="md-ellipsis">
      group
    </span>
  </a>
  
    <nav class="md-nav" aria-label="group">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup" class="md-nav__link">
    <span class="md-ellipsis">
      SemanticGroup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SemanticGroup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup.chunks" class="md-nav__link">
    <span class="md-ellipsis">
      chunks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup.name" class="md-nav__link">
    <span class="md-ellipsis">
      name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup.message" class="md-nav__link">
    <span class="md-ellipsis">
      message
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup.approved" class="md-nav__link">
    <span class="md-ellipsis">
      approved
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup.files" class="md-nav__link">
    <span class="md-ellipsis">
      files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup.content" class="md-nav__link">
    <span class="md-ellipsis">
      content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup.merge_with" class="md-nav__link">
    <span class="md-ellipsis">
      merge_with
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.group.SemanticGroup.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.embedder" class="md-nav__link">
    <span class="md-ellipsis">
      embedder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="embedder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.embedder.logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.embedder.DiffEmbedder" class="md-nav__link">
    <span class="md-ellipsis">
      DiffEmbedder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DiffEmbedder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.embedder.DiffEmbedder.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.embedder.DiffEmbedder.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.embedder.DiffEmbedder.preprocess_diff" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_diff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.embedder.DiffEmbedder.embed_chunk" class="md-nav__link">
    <span class="md-ellipsis">
      embed_chunk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.embedder.DiffEmbedder.embed_chunks" class="md-nav__link">
    <span class="md-ellipsis">
      embed_chunks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer" class="md-nav__link">
    <span class="md-ellipsis">
      clusterer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clusterer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.logger" class="md-nav__link">
    <span class="md-ellipsis">
      logger
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.ClusteringParams" class="md-nav__link">
    <span class="md-ellipsis">
      ClusteringParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ClusteringParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.ClusteringParams.n_clusters" class="md-nav__link">
    <span class="md-ellipsis">
      n_clusters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.ClusteringParams.distance_threshold" class="md-nav__link">
    <span class="md-ellipsis">
      distance_threshold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.ClusteringParams.metric" class="md-nav__link">
    <span class="md-ellipsis">
      metric
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.ClusteringParams.linkage" class="md-nav__link">
    <span class="md-ellipsis">
      linkage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.ClusteringParams.eps" class="md-nav__link">
    <span class="md-ellipsis">
      eps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.ClusteringParams.min_samples" class="md-nav__link">
    <span class="md-ellipsis">
      min_samples
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.T" class="md-nav__link">
    <span class="md-ellipsis">
      T
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.DiffClusterer" class="md-nav__link">
    <span class="md-ellipsis">
      DiffClusterer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DiffClusterer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.DiffClusterer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.DiffClusterer.method" class="md-nav__link">
    <span class="md-ellipsis">
      method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.DiffClusterer.kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.DiffClusterer.AgglomerativeClustering" class="md-nav__link">
    <span class="md-ellipsis">
      AgglomerativeClustering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.DiffClusterer.DBSCAN" class="md-nav__link">
    <span class="md-ellipsis">
      DBSCAN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.DiffClusterer.cosine_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      cosine_similarity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#codemap.git.semantic_grouping.clusterer.DiffClusterer.cluster" class="md-nav__link">
    <span class="md-ellipsis">
      cluster
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  
    
      
    
    <a href="https://github.com/SarthakMishra/codemap/raw/master/docs/api/pre-release/git/semantic_grouping/index.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="semantic-grouping-overview">Semantic Grouping Overview</h1>


<div class="doc doc-object doc-module">



<a id="codemap.git.semantic_grouping"></a>
    <div class="doc doc-contents first">

        <p>Semantic grouping implementation for the CodeMap project.</p>
<p>This module provides functionality to group related diff chunks into
semantic groups for more meaningful commit messages.</p>









  <div class="doc doc-children">



















<div class="doc doc-object doc-function">


<h3 id="codemap.git.semantic_grouping.batch_generate_messages" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">batch_generate_messages</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">batch_generate_messages</span><span class="p">(</span>
	<span class="n">groups</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">],</span>
	<span class="n">prompt_template</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
	<span class="n">config_loader</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ConfigLoader&lt;/span&gt; (&lt;code&gt;codemap.utils.config_loader.ConfigLoader&lt;/code&gt;)" href="../../utils/#codemap.utils.config_loader.ConfigLoader">ConfigLoader</a></span><span class="p">,</span>
	<span class="n">model</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate commit messages for multiple semantic groups in batch.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>groups</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SemanticGroup objects</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prompt_template</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Template to use for prompt generation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_loader</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ConfigLoader&lt;/span&gt; (&lt;code&gt;codemap.utils.config_loader.ConfigLoader&lt;/code&gt;)" href="../../utils/#codemap.utils.config_loader.ConfigLoader">ConfigLoader</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ConfigLoader instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional model name override</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SemanticGroup objects with messages added</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="LLMError">LLMError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If batch processing fails</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/batch_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">batch_generate_messages</span><span class="p">(</span>
	<span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">],</span>
	<span class="n">prompt_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
	<span class="n">config_loader</span><span class="p">:</span> <span class="n">ConfigLoader</span><span class="p">,</span>
	<span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate commit messages for multiple semantic groups in batch.</span>

<span class="sd">	Args:</span>
<span class="sd">	    groups: List of SemanticGroup objects</span>
<span class="sd">	    prompt_template: Template to use for prompt generation</span>
<span class="sd">	    config_loader: ConfigLoader instance</span>
<span class="sd">	    model: Optional model name override</span>

<span class="sd">	Returns:</span>
<span class="sd">	    List of SemanticGroup objects with messages added</span>

<span class="sd">	Raises:</span>
<span class="sd">	    LLMError: If batch processing fails</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">groups</span><span class="p">:</span>
		<span class="k">return</span> <span class="p">[]</span>

	<span class="c1"># Get config values</span>
	<span class="n">llm_config</span> <span class="o">=</span> <span class="n">config_loader</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;llm&quot;</span><span class="p">,</span> <span class="p">{})</span>
	<span class="n">max_tokens</span> <span class="o">=</span> <span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_context_tokens&quot;</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
	<span class="n">use_lod_context</span> <span class="o">=</span> <span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_lod_context&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
	<span class="n">model_name</span> <span class="o">=</span> <span class="n">model</span> <span class="ow">or</span> <span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;openai/gpt-4o-mini&quot;</span><span class="p">)</span>

	<span class="c1"># Prepare temporary chunks and prompts for each group</span>
	<span class="n">temp_chunks</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">messages_list</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="c1"># Add this at the top of the function, right after getting the config values</span>
	<span class="n">ui</span> <span class="o">=</span> <span class="n">CommitUI</span><span class="p">()</span>

	<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c1"># Create a temporary DiffChunk with optimized content if needed</span>
			<span class="k">if</span> <span class="n">use_lod_context</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Processing semantic group with </span><span class="si">%d</span><span class="s2"> chunks using LOD context&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">))</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">optimized_content</span> <span class="o">=</span> <span class="n">process_chunks_with_lod</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">,</span> <span class="n">max_tokens</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">optimized_content</span><span class="p">:</span>
						<span class="n">temp_chunk</span> <span class="o">=</span> <span class="n">DiffChunk</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">optimized_content</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">temp_chunk</span> <span class="o">=</span> <span class="n">DiffChunk</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
				<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error in LOD context processing, falling back to original content&quot;</span><span class="p">)</span>
					<span class="n">temp_chunk</span> <span class="o">=</span> <span class="n">DiffChunk</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">temp_chunk</span> <span class="o">=</span> <span class="n">DiffChunk</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

			<span class="c1"># Store the temp chunk for reference</span>
			<span class="n">temp_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_chunk</span><span class="p">)</span>

			<span class="c1"># Create a simple dictionary with file paths as keys</span>
			<span class="n">file_info</span> <span class="o">=</span> <span class="p">{</span><span class="n">file</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">file</span><span class="p">}</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">}</span>

			<span class="c1"># Prepare the prompt for this group</span>
			<span class="n">prompt</span> <span class="o">=</span> <span class="n">prepare_prompt</span><span class="p">(</span>
				<span class="n">template</span><span class="o">=</span><span class="n">prompt_template</span><span class="p">,</span>
				<span class="n">diff_content</span><span class="o">=</span><span class="n">temp_chunk</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
				<span class="n">file_info</span><span class="o">=</span><span class="n">file_info</span><span class="p">,</span>
				<span class="n">convention</span><span class="o">=</span><span class="n">config_loader</span><span class="o">.</span><span class="n">get_commit_convention</span><span class="p">(),</span>
			<span class="p">)</span>

			<span class="c1"># Format as messages for batch_completion</span>
			<span class="n">messages</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">}]</span>
			<span class="n">messages_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>

		<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error preparing prompt for group </span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="c1"># Add empty messages for this group to maintain index alignment</span>
			<span class="n">messages_list</span><span class="o">.</span><span class="n">append</span><span class="p">([{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Skip this group due to error&quot;</span><span class="p">}])</span>

	<span class="c1"># Use the LLM module&#39;s batch generation</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">codemap.git.commit_generator.schemas</span><span class="w"> </span><span class="kn">import</span> <span class="n">COMMIT_MESSAGE_SCHEMA</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">codemap.llm.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">batch_generate_completions</span>

		<span class="c1"># Execute batch completion using the LLM module</span>
		<span class="n">responses</span> <span class="o">=</span> <span class="n">batch_generate_completions</span><span class="p">(</span>
			<span class="n">messages_list</span><span class="o">=</span><span class="n">messages_list</span><span class="p">,</span>
			<span class="n">model</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
			<span class="n">config_loader</span><span class="o">=</span><span class="n">config_loader</span><span class="p">,</span>
			<span class="n">response_format</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;json_object&quot;</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">COMMIT_MESSAGE_SCHEMA</span><span class="p">},</span>
			<span class="n">temperature</span><span class="o">=</span><span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span>
			<span class="n">max_tokens</span><span class="o">=</span><span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_tokens&quot;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span>
		<span class="p">)</span>

		<span class="c1"># Process responses and update groups</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">responses</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)):</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="c1"># Extract content from response</span>
				<span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s2">&quot;choices&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">:</span>
					<span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>

					<span class="c1"># If it&#39;s JSON, extract the message</span>
					<span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">content</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">):</span>
						<span class="k">try</span><span class="p">:</span>
							<span class="c1"># Check if it&#39;s in the {&quot;commit_message&quot;: &quot;...&quot;} format</span>
							<span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
							<span class="k">if</span> <span class="s2">&quot;commit_message&quot;</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">:</span>
								<span class="c1"># Extract just the commit message</span>
								<span class="n">content</span> <span class="o">=</span> <span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;commit_message&quot;</span><span class="p">]</span>
							<span class="k">elif</span> <span class="s2">&quot;message&quot;</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">:</span>
								<span class="c1"># Extract message from {&quot;message&quot;: &quot;...&quot;} format</span>
								<span class="n">content</span> <span class="o">=</span> <span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">]</span>
							<span class="k">else</span><span class="p">:</span>
								<span class="c1"># Use the formatter for conventional format</span>
								<span class="n">content</span> <span class="o">=</span> <span class="n">format_commit_json</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
						<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
							<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error formatting JSON to commit message&quot;</span><span class="p">)</span>

					<span class="c1"># Set the message on the group</span>
					<span class="n">group</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">content</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Empty or invalid response for group </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
					<span class="n">group</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;update: changes to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files&quot;</span>
			<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing response for group </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="n">group</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;update: changes to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files&quot;</span>

	<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Batch completion failed&quot;</span><span class="p">)</span>
		<span class="c1"># Just use the already initialized UI</span>
		<span class="n">ui</span><span class="o">.</span><span class="n">show_warning</span><span class="p">(</span><span class="s2">&quot;LLM call failed. Using fallback commit messages.&quot;</span><span class="p">)</span>

		<span class="c1"># Provide fallback messages for all groups</span>
		<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">group</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>  <span class="c1"># Don&#39;t override if already set</span>
				<span class="n">fallback_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;update: changes to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files&quot;</span>
				<span class="n">group</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">fallback_msg</span>
				<span class="c1"># Log which groups received fallback messages</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using fallback message for files: </span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">groups</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="codemap.git.semantic_grouping.DiffClusterer" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DiffClusterer</span>


</h3>


    <div class="doc doc-contents ">


        <p>Clusters diff chunks based on their semantic embeddings.</p>
<p>This class provides methods to group related code changes by their semantic similarity,
using vector embeddings and standard clustering algorithms from scikit-learn.</p>
<p>Clustering helps identify code changes that are related to each other and should be
grouped in the same commit, even if they appear in different files.</p>
<p>The class supports multiple clustering algorithms:
1. Agglomerative clustering: Hierarchical clustering that's good for finding natural
   groupings without needing to specify the exact number of clusters
2. DBSCAN: Density-based clustering that can identify outliers and works well with
   irregularly shaped clusters</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/git/semantic_grouping/clusterer.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DiffClusterer</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Clusters diff chunks based on their semantic embeddings.</span>

<span class="sd">	This class provides methods to group related code changes by their semantic similarity,</span>
<span class="sd">	using vector embeddings and standard clustering algorithms from scikit-learn.</span>

<span class="sd">	Clustering helps identify code changes that are related to each other and should be</span>
<span class="sd">	grouped in the same commit, even if they appear in different files.</span>

<span class="sd">	The class supports multiple clustering algorithms:</span>
<span class="sd">	1. Agglomerative clustering: Hierarchical clustering that&#39;s good for finding natural</span>
<span class="sd">	   groupings without needing to specify the exact number of clusters</span>
<span class="sd">	2. DBSCAN: Density-based clustering that can identify outliers and works well with</span>
<span class="sd">	   irregularly shaped clusters</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initialize the clusterer.</span>

<span class="sd">		Args:</span>
<span class="sd">		    method: Clustering method to use. Options:</span>
<span class="sd">		        - &quot;agglomerative&quot;: Hierarchical clustering (default)</span>
<span class="sd">		        - &quot;dbscan&quot;: Density-based spatial clustering</span>
<span class="sd">		    **kwargs: Additional parameters for the clustering algorithm:</span>
<span class="sd">		        - For agglomerative: distance_threshold, linkage, etc.</span>
<span class="sd">		        - For DBSCAN: eps, min_samples, etc.</span>

<span class="sd">		Raises:</span>
<span class="sd">		    ImportError: If scikit-learn is not installed</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

		<span class="c1"># Import here to avoid making sklearn a hard dependency</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">DBSCAN</span><span class="p">,</span> <span class="n">AgglomerativeClustering</span>
			<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_similarity</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">AgglomerativeClustering</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">DBSCAN</span> <span class="o">=</span> <span class="n">DBSCAN</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n">cosine_similarity</span>
		<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Failed to import scikit-learn. Please install it with: uv add scikit-learn&quot;</span><span class="p">)</span>
			<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;scikit-learn is required for clustering&quot;</span>
			<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Cluster chunks based on their embeddings.</span>

<span class="sd">		              Process:</span>
<span class="sd">		              1. Extracts chunks and embeddings from input tuples</span>
<span class="sd">		              2. Computes a similarity matrix using cosine similarity</span>
<span class="sd">		              3. Converts similarity to distance matrix (1 - similarity)</span>
<span class="sd">		              4. Applies clustering algorithm based on the chosen method</span>
<span class="sd">		              5. Organizes chunks into clusters based on labels</span>
<span class="sd">		              6. Handles special cases like noise points in DBSCAN</span>

<span class="sd">		Args:</span>
<span class="sd">		    chunk_embeddings: List of (chunk, embedding) tuples where each embedding</span>
<span class="sd">		        is a numpy array representing the semantic vector of a code chunk</span>

<span class="sd">		Returns:</span>
<span class="sd">		    List of lists, where each inner list contains chunks in the same cluster.</span>
<span class="sd">		    With DBSCAN, noise points (label -1) are returned as individual single-item clusters.</span>

<span class="sd">		Examples:</span>
<span class="sd">		    &gt;&gt;&gt; embedder = DiffEmbedder()</span>
<span class="sd">		    &gt;&gt;&gt; chunk_embeddings = embedder.embed_chunks(diff_chunks)</span>
<span class="sd">		    &gt;&gt;&gt; clusterer = DiffClusterer(method=&quot;agglomerative&quot;, distance_threshold=0.5)</span>
<span class="sd">		    &gt;&gt;&gt; clusters = clusterer.cluster(chunk_embeddings)</span>
<span class="sd">		    &gt;&gt;&gt; for i, cluster in enumerate(clusters):</span>
<span class="sd">		    ...     print(f&quot;Cluster {i} has {len(cluster)} chunks&quot;)</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">chunk_embeddings</span><span class="p">:</span>
			<span class="k">return</span> <span class="p">[]</span>

		<span class="c1"># Extract chunks and embeddings</span>
		<span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ce</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>
		<span class="n">embeddings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ce</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">ce</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">])</span>

		<span class="c1"># Compute similarity matrix (1 - cosine distance)</span>
		<span class="n">similarity_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>

		<span class="c1"># Convert to distance matrix (1 - similarity)</span>
		<span class="n">distance_matrix</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">similarity_matrix</span>

		<span class="c1"># Apply clustering</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">:</span>
			<span class="c1"># Default parameters if not provided</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
				<span class="s2">&quot;n_clusters&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
				<span class="s2">&quot;distance_threshold&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Threshold for cluster formation (0.5 = moderate similarity)</span>
				<span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>  <span class="c1"># Use metric instead of affinity</span>
				<span class="s2">&quot;linkage&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>  <span class="c1"># Use average linkage for balanced clusters</span>
			<span class="p">}</span>
			<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

			<span class="n">clustering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
			<span class="n">labels</span> <span class="o">=</span> <span class="n">clustering</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;dbscan&quot;</span><span class="p">:</span>
			<span class="c1"># Default parameters if not provided</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
				<span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># Maximum distance between points in neighborhood (0.3 = high similarity required)</span>
				<span class="s2">&quot;min_samples&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Minimum points to form a dense region</span>
				<span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>  <span class="c1"># Using precomputed distance matrix</span>
			<span class="p">}</span>
			<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

			<span class="n">clustering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DBSCAN</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
			<span class="n">labels</span> <span class="o">=</span> <span class="n">clustering</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

		<span class="k">else</span><span class="p">:</span>
			<span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unsupported clustering method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

		<span class="c1"># Group chunks by cluster label</span>
		<span class="n">clusters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
			<span class="c1"># Convert numpy integer to Python int</span>
			<span class="n">label_key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">label_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">:</span>
				<span class="n">clusters</span><span class="p">[</span><span class="n">label_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">clusters</span><span class="p">[</span><span class="n">label_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

		<span class="c1"># Convert to list of lists and handle noise points (-1 label in DBSCAN)</span>
		<span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">cluster_chunks</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">clusters</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># Regular cluster</span>
				<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cluster_chunks</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>  <span class="c1"># Noise points - each forms its own cluster</span>
				<span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">cluster_chunks</span><span class="p">])</span>

		<span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.DiffClusterer.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span>
	<span class="nf">method</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n"><span title="object">object</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the clusterer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clustering method to use. Options:
- "agglomerative": Hierarchical clustering (default)
- "dbscan": Density-based spatial clustering</p>
              </div>
            </td>
            <td>
                  <code>&#39;agglomerative&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional parameters for the clustering algorithm:
- For agglomerative: distance_threshold, linkage, etc.
- For DBSCAN: eps, min_samples, etc.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ImportError">ImportError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If scikit-learn is not installed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/clusterer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initialize the clusterer.</span>

<span class="sd">	Args:</span>
<span class="sd">	    method: Clustering method to use. Options:</span>
<span class="sd">	        - &quot;agglomerative&quot;: Hierarchical clustering (default)</span>
<span class="sd">	        - &quot;dbscan&quot;: Density-based spatial clustering</span>
<span class="sd">	    **kwargs: Additional parameters for the clustering algorithm:</span>
<span class="sd">	        - For agglomerative: distance_threshold, linkage, etc.</span>
<span class="sd">	        - For DBSCAN: eps, min_samples, etc.</span>

<span class="sd">	Raises:</span>
<span class="sd">	    ImportError: If scikit-learn is not installed</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

	<span class="c1"># Import here to avoid making sklearn a hard dependency</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">DBSCAN</span><span class="p">,</span> <span class="n">AgglomerativeClustering</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_similarity</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">AgglomerativeClustering</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">DBSCAN</span> <span class="o">=</span> <span class="n">DBSCAN</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n">cosine_similarity</span>
	<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Failed to import scikit-learn. Please install it with: uv add scikit-learn&quot;</span><span class="p">)</span>
		<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;scikit-learn is required for clustering&quot;</span>
		<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.DiffClusterer.method" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">method</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">method</span> <span class="o">=</span> <span class="n"><span title="codemap.git.semantic_grouping.clusterer.DiffClusterer(method)">method</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.DiffClusterer.kwargs" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">kwargs</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="n"><span title="codemap.git.semantic_grouping.clusterer.DiffClusterer(kwargs)">kwargs</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.DiffClusterer.AgglomerativeClustering" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">AgglomerativeClustering</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">AgglomerativeClustering</span> <span class="o">=</span> <span class="n"><span title="sklearn.cluster.AgglomerativeClustering">AgglomerativeClustering</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.DiffClusterer.DBSCAN" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">DBSCAN</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">DBSCAN</span> <span class="o">=</span> <span class="n"><span title="sklearn.cluster.DBSCAN">DBSCAN</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.DiffClusterer.cosine_similarity" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">cosine_similarity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n"><span title="sklearn.metrics.pairwise.cosine_similarity">cosine_similarity</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.DiffClusterer.cluster" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cluster</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cluster</span><span class="p">(</span>
	<span class="n">chunk_embeddings</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">,</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Cluster chunks based on their embeddings.</p>
<div class="highlight"><pre><span></span><code>          Process:
          1. Extracts chunks and embeddings from input tuples
          2. Computes a similarity matrix using cosine similarity
          3. Converts similarity to distance matrix (1 - similarity)
          4. Applies clustering algorithm based on the chosen method
          5. Organizes chunks into clusters based on labels
          6. Handles special cases like noise points in DBSCAN
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunk_embeddings</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (chunk, embedding) tuples where each embedding
is a numpy array representing the semantic vector of a code chunk</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of lists, where each inner list contains chunks in the same cluster.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>With DBSCAN, noise points (label -1) are returned as individual single-item clusters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">embedder</span> <span class="o">=</span> <span class="n">DiffEmbedder</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chunk_embeddings</span> <span class="o">=</span> <span class="n">embedder</span><span class="o">.</span><span class="n">embed_chunks</span><span class="p">(</span><span class="n">diff_chunks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clusterer</span> <span class="o">=</span> <span class="n">DiffClusterer</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;agglomerative&quot;</span><span class="p">,</span> <span class="n">distance_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clusters</span> <span class="o">=</span> <span class="n">clusterer</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">chunk_embeddings</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clusters</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cluster </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span><span class="si">}</span><span class="s2"> chunks&quot;</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/clusterer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Cluster chunks based on their embeddings.</span>

<span class="sd">	              Process:</span>
<span class="sd">	              1. Extracts chunks and embeddings from input tuples</span>
<span class="sd">	              2. Computes a similarity matrix using cosine similarity</span>
<span class="sd">	              3. Converts similarity to distance matrix (1 - similarity)</span>
<span class="sd">	              4. Applies clustering algorithm based on the chosen method</span>
<span class="sd">	              5. Organizes chunks into clusters based on labels</span>
<span class="sd">	              6. Handles special cases like noise points in DBSCAN</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunk_embeddings: List of (chunk, embedding) tuples where each embedding</span>
<span class="sd">	        is a numpy array representing the semantic vector of a code chunk</span>

<span class="sd">	Returns:</span>
<span class="sd">	    List of lists, where each inner list contains chunks in the same cluster.</span>
<span class="sd">	    With DBSCAN, noise points (label -1) are returned as individual single-item clusters.</span>

<span class="sd">	Examples:</span>
<span class="sd">	    &gt;&gt;&gt; embedder = DiffEmbedder()</span>
<span class="sd">	    &gt;&gt;&gt; chunk_embeddings = embedder.embed_chunks(diff_chunks)</span>
<span class="sd">	    &gt;&gt;&gt; clusterer = DiffClusterer(method=&quot;agglomerative&quot;, distance_threshold=0.5)</span>
<span class="sd">	    &gt;&gt;&gt; clusters = clusterer.cluster(chunk_embeddings)</span>
<span class="sd">	    &gt;&gt;&gt; for i, cluster in enumerate(clusters):</span>
<span class="sd">	    ...     print(f&quot;Cluster {i} has {len(cluster)} chunks&quot;)</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">chunk_embeddings</span><span class="p">:</span>
		<span class="k">return</span> <span class="p">[]</span>

	<span class="c1"># Extract chunks and embeddings</span>
	<span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ce</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>
	<span class="n">embeddings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ce</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">ce</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">])</span>

	<span class="c1"># Compute similarity matrix (1 - cosine distance)</span>
	<span class="n">similarity_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>

	<span class="c1"># Convert to distance matrix (1 - similarity)</span>
	<span class="n">distance_matrix</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">similarity_matrix</span>

	<span class="c1"># Apply clustering</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">:</span>
		<span class="c1"># Default parameters if not provided</span>
		<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s2">&quot;n_clusters&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
			<span class="s2">&quot;distance_threshold&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Threshold for cluster formation (0.5 = moderate similarity)</span>
			<span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>  <span class="c1"># Use metric instead of affinity</span>
			<span class="s2">&quot;linkage&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>  <span class="c1"># Use average linkage for balanced clusters</span>
		<span class="p">}</span>
		<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

		<span class="n">clustering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
		<span class="n">labels</span> <span class="o">=</span> <span class="n">clustering</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

	<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;dbscan&quot;</span><span class="p">:</span>
		<span class="c1"># Default parameters if not provided</span>
		<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># Maximum distance between points in neighborhood (0.3 = high similarity required)</span>
			<span class="s2">&quot;min_samples&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Minimum points to form a dense region</span>
			<span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>  <span class="c1"># Using precomputed distance matrix</span>
		<span class="p">}</span>
		<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

		<span class="n">clustering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DBSCAN</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
		<span class="n">labels</span> <span class="o">=</span> <span class="n">clustering</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unsupported clustering method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span>
		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

	<span class="c1"># Group chunks by cluster label</span>
	<span class="n">clusters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
		<span class="c1"># Convert numpy integer to Python int</span>
		<span class="n">label_key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">label_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">:</span>
			<span class="n">clusters</span><span class="p">[</span><span class="n">label_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">clusters</span><span class="p">[</span><span class="n">label_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

	<span class="c1"># Convert to list of lists and handle noise points (-1 label in DBSCAN)</span>
	<span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">cluster_chunks</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">clusters</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
		<span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># Regular cluster</span>
			<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cluster_chunks</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>  <span class="c1"># Noise points - each forms its own cluster</span>
			<span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">cluster_chunks</span><span class="p">])</span>

	<span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="codemap.git.semantic_grouping.format_chunk" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format_chunk</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">format_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Format a single diff chunk as markdown.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunk</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The diff chunk to format</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatted markdown string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">format_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n">DiffChunk</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Format a single diff chunk as markdown.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunk: The diff chunk to format</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Formatted markdown string</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Format file paths</span>
	<span class="n">file_section</span> <span class="o">=</span> <span class="s2">&quot;## Files</span><span class="se">\n</span><span class="s2">&quot;</span>
	<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">file</span><span class="p">:</span>
			<span class="n">file_section</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

	<span class="c1"># Format content</span>
	<span class="n">content_section</span> <span class="o">=</span> <span class="s2">&quot;### Changes</span><span class="se">\n</span><span class="s2">```diff</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">chunk</span><span class="o">.</span><span class="n">content</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">```&quot;</span>

	<span class="k">return</span> <span class="n">file_section</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">content_section</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="codemap.git.semantic_grouping.prioritize_chunks" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prioritize_chunks</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prioritize_chunks</span><span class="p">(</span>
	<span class="n">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">],</span> <span class="n">max_count</span><span class="p">:</span> <span class="n"><span title="int">int</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prioritize chunks based on heuristics (file types, changes, etc.).</p>
<p>This is a simple implementation that could be extended with more
sophisticated dissimilarity metrics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of chunks to prioritize</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_count</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of chunks to return</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prioritized list of chunks</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prioritize_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">],</span> <span class="n">max_count</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Prioritize chunks based on heuristics (file types, changes, etc.).</span>

<span class="sd">	This is a simple implementation that could be extended with more</span>
<span class="sd">	sophisticated dissimilarity metrics.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunks: List of chunks to prioritize</span>
<span class="sd">	    max_count: Maximum number of chunks to return</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Prioritized list of chunks</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Simple heuristics for now:</span>
	<span class="c1"># 1. Prefer chunks with code files over non-code files</span>
	<span class="c1"># 2. Prefer chunks with more files (more central changes)</span>
	<span class="c1"># 3. Prefer chunks with more added/changed lines</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">chunk_score</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n">DiffChunk</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Calculates a priority score for a diff chunk based on heuristics.</span>

<span class="sd">		The score is calculated using three factors:</span>
<span class="sd">		1. Presence of code files (60% weight)</span>
<span class="sd">		2. Number of files affected (20% weight)</span>
<span class="sd">		3. Size of content changes (20% weight)</span>

<span class="sd">		Args:</span>
<span class="sd">			chunk: The diff chunk to score</span>

<span class="sd">		Returns:</span>
<span class="sd">			float: A score between 0 and 1 representing the chunk&#39;s priority</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Check if any files are code files</span>
		<span class="n">code_file_score</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.py&quot;</span><span class="p">,</span> <span class="s2">&quot;.js&quot;</span><span class="p">,</span> <span class="s2">&quot;.ts&quot;</span><span class="p">,</span> <span class="s2">&quot;.java&quot;</span><span class="p">,</span> <span class="s2">&quot;.c&quot;</span><span class="p">,</span> <span class="s2">&quot;.cpp&quot;</span><span class="p">,</span> <span class="s2">&quot;.go&quot;</span><span class="p">]):</span>
				<span class="n">code_file_score</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">break</span>

		<span class="c1"># Score based on number of files</span>
		<span class="n">file_count_score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>

		<span class="c1"># Score based on content size (as proxy for changes)</span>
		<span class="n">content_score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">content</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>

		<span class="k">return</span> <span class="n">code_file_score</span> <span class="o">*</span> <span class="mf">0.6</span> <span class="o">+</span> <span class="n">file_count_score</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">+</span> <span class="n">content_score</span> <span class="o">*</span> <span class="mf">0.2</span>

	<span class="c1"># Sort chunks by score and return top max_count</span>
	<span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chunks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chunk_score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="n">max_count</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h3 id="codemap.git.semantic_grouping.process_chunks_with_lod" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">process_chunks_with_lod</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">process_chunks_with_lod</span><span class="p">(</span>
	<span class="n">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">],</span>
	<span class="n">max_tokens</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;DEFAULT_MAX_TOKENS&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS">DEFAULT_MAX_TOKENS</a></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Process diff chunks using LOD to create optimized context for LLM prompts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of diff chunks to process</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_tokens</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum tokens allowed in the formatted context</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;DEFAULT_MAX_TOKENS&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS">DEFAULT_MAX_TOKENS</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatted markdown context optimized for token usage</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_chunks_with_lod</span><span class="p">(</span><span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">],</span> <span class="n">max_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_MAX_TOKENS</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Process diff chunks using LOD to create optimized context for LLM prompts.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunks: List of diff chunks to process</span>
<span class="sd">	    max_tokens: Maximum tokens allowed in the formatted context</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Formatted markdown context optimized for token usage</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># If chunks list is small, we might not need LOD processing</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">MAX_SIMPLE_CHUNKS</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">format_regular_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">[:</span><span class="n">MAX_CHUNKS</span><span class="p">])</span>

	<span class="c1"># Set up LOD generator and estimate number of chunks we can include</span>
	<span class="n">lod_generator</span> <span class="o">=</span> <span class="n">LODGenerator</span><span class="p">()</span>
	<span class="n">estimated_chunk_count</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_tokens</span> <span class="o">//</span> <span class="n">CHUNK_TOKEN_ESTIMATE</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">))</span>
	<span class="n">prioritized_chunks</span> <span class="o">=</span> <span class="n">prioritize_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">estimated_chunk_count</span><span class="p">,</span> <span class="n">MAX_CHUNKS</span><span class="p">))</span>

	<span class="c1"># Start with highest LOD level and progressively reduce if needed</span>
	<span class="n">lod_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">LODLevel</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">,</span> <span class="n">LODLevel</span><span class="o">.</span><span class="n">SIGNATURES</span><span class="p">]</span>
	<span class="n">formatted_chunks</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">current_level_index</span> <span class="o">=</span> <span class="mi">0</span>

	<span class="k">while</span> <span class="n">current_level_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lod_levels</span><span class="p">):</span>
		<span class="n">current_level</span> <span class="o">=</span> <span class="n">lod_levels</span><span class="p">[</span><span class="n">current_level_index</span><span class="p">]</span>
		<span class="n">formatted_chunks</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">prioritized_chunks</span><span class="p">:</span>
			<span class="c1"># Get file paths from chunk</span>
			<span class="n">file_paths</span> <span class="o">=</span> <span class="n">get_file_paths_from_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

			<span class="k">if</span> <span class="ow">not</span> <span class="n">file_paths</span><span class="p">:</span>
				<span class="c1"># If we can&#39;t extract paths, use regular formatting for this chunk</span>
				<span class="n">formatted_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span>
				<span class="k">continue</span>

			<span class="c1"># Process each file in the chunk with LOD</span>
			<span class="n">lod_formatted</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">file_paths</span><span class="p">:</span>
				<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
					<span class="k">continue</span>

				<span class="c1"># Generate LOD representation</span>
				<span class="n">lod_entity</span> <span class="o">=</span> <span class="n">lod_generator</span><span class="o">.</span><span class="n">generate_lod</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">current_level</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">lod_entity</span><span class="p">:</span>
					<span class="n">lod_formatted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_lod_entity</span><span class="p">(</span><span class="n">lod_entity</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">current_level</span><span class="p">))</span>

			<span class="k">if</span> <span class="n">lod_formatted</span><span class="p">:</span>
				<span class="n">formatted_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lod_formatted</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># Fallback to regular formatting</span>
				<span class="n">formatted_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span>

		<span class="c1"># Estimate if we&#39;re within token limit</span>
		<span class="n">total_context</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatted_chunks</span><span class="p">)</span>
		<span class="n">estimated_tokens</span> <span class="o">=</span> <span class="n">estimate_tokens</span><span class="p">(</span><span class="n">total_context</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">estimated_tokens</span> <span class="o">&lt;=</span> <span class="n">max_tokens</span> <span class="ow">or</span> <span class="n">current_level_index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lod_levels</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
			<span class="k">break</span>

		<span class="c1"># Try with lower LOD level</span>
		<span class="n">current_level_index</span> <span class="o">+=</span> <span class="mi">1</span>

	<span class="c1"># If we still exceed the token limit, truncate</span>
	<span class="n">total_context</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatted_chunks</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">estimate_tokens</span><span class="p">(</span><span class="n">total_context</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_tokens</span><span class="p">:</span>
		<span class="n">total_context</span> <span class="o">=</span> <span class="n">truncate_context</span><span class="p">(</span><span class="n">total_context</span><span class="p">,</span> <span class="n">max_tokens</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">total_context</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="codemap.git.semantic_grouping.DiffEmbedder" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DiffEmbedder</span>


</h3>


    <div class="doc doc-contents ">


        <p>Generates embeddings for diff chunks.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DiffEmbedder</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Generates embeddings for diff chunks.&quot;&quot;&quot;</span>

	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;all-MiniLM-L6-v2&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initialize the embedder with a specific model.</span>

<span class="sd">		Args:</span>
<span class="sd">		    model_name: Name of the sentence-transformers model to use</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Import here to avoid making sentence-transformers a hard dependency</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span><span class="w"> </span><span class="nn">sentence_transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SentenceTransformer</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">SentenceTransformer</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
				<span class="s2">&quot;Failed to import sentence-transformers. Please install it with: uv add sentence-transformers&quot;</span>
			<span class="p">)</span>
			<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;sentence-transformers is required for semantic grouping&quot;</span>
			<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">preprocess_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diff_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Preprocess diff text to make it more suitable for embedding.</span>

<span class="sd">		Args:</span>
<span class="sd">		    diff_text: Raw diff text</span>

<span class="sd">		Returns:</span>
<span class="sd">		    Preprocessed text</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Remove diff headers, line numbers, etc.</span>
		<span class="c1"># Focus on actual content changes</span>
		<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">diff_text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
			<span class="c1"># Skip diff metadata lines</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;diff --git&quot;</span><span class="p">,</span> <span class="s2">&quot;index &quot;</span><span class="p">,</span> <span class="s2">&quot;+++&quot;</span><span class="p">,</span> <span class="s2">&quot;---&quot;</span><span class="p">)):</span>
				<span class="k">continue</span>

			<span class="c1"># Keep actual content changes, removing the +/- prefix</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)):</span>
				<span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

		<span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">embed_chunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk</span><span class="p">:</span> <span class="n">DiffChunk</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Generate an embedding for a diff chunk.</span>

<span class="sd">		Args:</span>
<span class="sd">		    chunk: DiffChunk object</span>

<span class="sd">		Returns:</span>
<span class="sd">		    numpy.ndarray: Embedding vector</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Get the diff content from the chunk</span>
		<span class="n">diff_text</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">content</span>

		<span class="c1"># Preprocess the diff text</span>
		<span class="n">processed_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_diff</span><span class="p">(</span><span class="n">diff_text</span><span class="p">)</span>

		<span class="c1"># If the processed text is empty, use the file paths as context</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">processed_text</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
			<span class="n">processed_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

		<span class="c1"># Generate the embedding and convert to numpy array</span>
		<span class="n">embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">processed_text</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">embedding</span><span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">embed_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Generate embeddings for multiple chunks.</span>

<span class="sd">		Args:</span>
<span class="sd">		    chunks: List of DiffChunk objects</span>

<span class="sd">		Returns:</span>
<span class="sd">		    List of (chunk, embedding) tuples</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="p">[(</span><span class="n">chunk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embed_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.DiffEmbedder.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span><span class="nf">model_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;all-MiniLM-L6-v2&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the embedder with a specific model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the sentence-transformers model to use</p>
              </div>
            </td>
            <td>
                  <code>&#39;all-MiniLM-L6-v2&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;all-MiniLM-L6-v2&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initialize the embedder with a specific model.</span>

<span class="sd">	Args:</span>
<span class="sd">	    model_name: Name of the sentence-transformers model to use</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Import here to avoid making sentence-transformers a hard dependency</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">sentence_transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SentenceTransformer</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">SentenceTransformer</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
	<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
			<span class="s2">&quot;Failed to import sentence-transformers. Please install it with: uv add sentence-transformers&quot;</span>
		<span class="p">)</span>
		<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;sentence-transformers is required for semantic grouping&quot;</span>
		<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.DiffEmbedder.model" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="sentence_transformers.SentenceTransformer">SentenceTransformer</span></span><span class="p">(</span><span class="n"><span title="codemap.git.semantic_grouping.embedder.DiffEmbedder(model_name)">model_name</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.DiffEmbedder.preprocess_diff" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">preprocess_diff</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">preprocess_diff</span><span class="p">(</span><span class="n">diff_text</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Preprocess diff text to make it more suitable for embedding.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>diff_text</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw diff text</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Preprocessed text</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">preprocess_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diff_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Preprocess diff text to make it more suitable for embedding.</span>

<span class="sd">	Args:</span>
<span class="sd">	    diff_text: Raw diff text</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Preprocessed text</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Remove diff headers, line numbers, etc.</span>
	<span class="c1"># Focus on actual content changes</span>
	<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">diff_text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
		<span class="c1"># Skip diff metadata lines</span>
		<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;diff --git&quot;</span><span class="p">,</span> <span class="s2">&quot;index &quot;</span><span class="p">,</span> <span class="s2">&quot;+++&quot;</span><span class="p">,</span> <span class="s2">&quot;---&quot;</span><span class="p">)):</span>
			<span class="k">continue</span>

		<span class="c1"># Keep actual content changes, removing the +/- prefix</span>
		<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)):</span>
			<span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

	<span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.DiffEmbedder.embed_chunk" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">embed_chunk</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">embed_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate an embedding for a diff chunk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunk</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DiffChunk object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy.ndarray: Embedding vector</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">embed_chunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk</span><span class="p">:</span> <span class="n">DiffChunk</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate an embedding for a diff chunk.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunk: DiffChunk object</span>

<span class="sd">	Returns:</span>
<span class="sd">	    numpy.ndarray: Embedding vector</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Get the diff content from the chunk</span>
	<span class="n">diff_text</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">content</span>

	<span class="c1"># Preprocess the diff text</span>
	<span class="n">processed_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_diff</span><span class="p">(</span><span class="n">diff_text</span><span class="p">)</span>

	<span class="c1"># If the processed text is empty, use the file paths as context</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">processed_text</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
		<span class="n">processed_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

	<span class="c1"># Generate the embedding and convert to numpy array</span>
	<span class="n">embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">processed_text</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">embedding</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.DiffEmbedder.embed_chunks" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">embed_chunks</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">embed_chunks</span><span class="p">(</span>
	<span class="n">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">,</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate embeddings for multiple chunks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of DiffChunk objects</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (chunk, embedding) tuples</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">embed_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate embeddings for multiple chunks.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunks: List of DiffChunk objects</span>

<span class="sd">	Returns:</span>
<span class="sd">	    List of (chunk, embedding) tuples</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="p">[(</span><span class="n">chunk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embed_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="codemap.git.semantic_grouping.FileIntegrityResolver" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">FileIntegrityResolver</span>


</h3>


    <div class="doc doc-contents ">


        <p>Resolves file integrity constraints for semantic groups.</p>
<p>File integrity refers to the requirement that all changes to a specific file should
be included in the same commit, even if they are semantically different. This prevents
fragmented changes to the same file across multiple commits, which can lead to broken builds
or inconsistent states.</p>
<p>The resolver works by:
1. Identifying files that appear in multiple semantic groups
2. Calculating the semantic similarity between these overlapping groups
3. Either merging similar groups or reassigning chunks from less relevant groups
   to the most appropriate group</p>
<p>This process ensures that each file is modified in exactly one commit, while still
maintaining semantic coherence within commits when possible.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/git/semantic_grouping/resolver.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FileIntegrityResolver</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Resolves file integrity constraints for semantic groups.</span>

<span class="sd">	File integrity refers to the requirement that all changes to a specific file should</span>
<span class="sd">	be included in the same commit, even if they are semantically different. This prevents</span>
<span class="sd">	fragmented changes to the same file across multiple commits, which can lead to broken builds</span>
<span class="sd">	or inconsistent states.</span>

<span class="sd">	The resolver works by:</span>
<span class="sd">	1. Identifying files that appear in multiple semantic groups</span>
<span class="sd">	2. Calculating the semantic similarity between these overlapping groups</span>
<span class="sd">	3. Either merging similar groups or reassigning chunks from less relevant groups</span>
<span class="sd">	   to the most appropriate group</span>

<span class="sd">	This process ensures that each file is modified in exactly one commit, while still</span>
<span class="sd">	maintaining semantic coherence within commits when possible.</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">similarity_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initialize the resolver.</span>

<span class="sd">		Args:</span>
<span class="sd">		    similarity_threshold: Threshold for group similarity to trigger merging (0.0-1.0).</span>
<span class="sd">		        Higher values require greater similarity to merge groups:</span>
<span class="sd">		        - Values near 0.5 are permissive and will merge moderately related groups</span>
<span class="sd">		        - Values above 0.7 are strict and will mostly reassign chunks instead of merging</span>
<span class="sd">		        - Default 0.6 provides a balanced approach</span>

<span class="sd">		Raises:</span>
<span class="sd">		    ImportError: If scikit-learn is not installed</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">similarity_threshold</span> <span class="o">=</span> <span class="n">similarity_threshold</span>

		<span class="c1"># Import here to avoid making sklearn a hard dependency</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_similarity</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n">cosine_similarity</span>
		<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Failed to import scikit-learn. Please install it with: uv add scikit-learn&quot;</span><span class="p">)</span>
			<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;scikit-learn is required for file integrity resolution&quot;</span>
			<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">calculate_group_similarity</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span> <span class="n">group1</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">,</span> <span class="n">group2</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">,</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculate similarity between two groups based on their chunks&#39; embeddings.</span>

<span class="sd">		This method computes the average pairwise cosine similarity between all combinations</span>
<span class="sd">		of chunks from the two groups. The similarity is based on the semantic embeddings</span>
<span class="sd">		of the chunks&#39; content.</span>

<span class="sd">		Process:</span>
<span class="sd">		1. Extract embeddings for all chunks in both groups</span>
<span class="sd">		2. Compute pairwise cosine similarities between each pair of chunks</span>
<span class="sd">		3. Return the average similarity score</span>

<span class="sd">		Args:</span>
<span class="sd">		    group1: First semantic group to compare</span>
<span class="sd">		    group2: Second semantic group to compare</span>
<span class="sd">		    chunk_embeddings: Dict mapping chunks to their embeddings</span>

<span class="sd">		Returns:</span>
<span class="sd">		    float: Similarity score between 0 and 1, where:</span>
<span class="sd">		        - 0 indicates completely unrelated changes</span>
<span class="sd">		        - 1 indicates identical or extremely similar changes</span>
<span class="sd">		        - Values around 0.6-0.8 typically indicate related functionality</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Get embeddings for chunks in each group</span>
		<span class="n">embeddings1</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk_embeddings</span><span class="p">[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">group1</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>
		<span class="n">embeddings2</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk_embeddings</span><span class="p">[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">group2</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="n">embeddings1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">embeddings2</span><span class="p">:</span>
			<span class="k">return</span> <span class="mf">0.0</span>

		<span class="c1"># Calculate pairwise similarities</span>
		<span class="n">similarities</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">emb1</span> <span class="ow">in</span> <span class="n">embeddings1</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">emb2</span> <span class="ow">in</span> <span class="n">embeddings2</span><span class="p">:</span>
				<span class="n">sim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span><span class="p">([</span><span class="n">emb1</span><span class="p">],</span> <span class="p">[</span><span class="n">emb2</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">similarities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

		<span class="c1"># Return average similarity</span>
		<span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">similarities</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">similarities</span><span class="p">)</span> <span class="k">if</span> <span class="n">similarities</span> <span class="k">else</span> <span class="mf">0.0</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">resolve_violations</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">],</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">]:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Resolve file integrity violations by merging or reassigning chunks.</span>

<span class="sd">		A violation occurs when the same file appears in multiple semantic groups.</span>
<span class="sd">		This needs to be resolved because a file should be modified in only one commit.</span>

<span class="sd">		Args:</span>
<span class="sd">		    groups: List of SemanticGroup objects to resolve</span>
<span class="sd">		    chunk_embeddings: Dict mapping chunks to their embeddings</span>

<span class="sd">		Returns:</span>
<span class="sd">		    List of SemanticGroup objects with all violations resolved</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Keep iterating until no violations remain</span>
		<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
			<span class="c1"># Build file to groups mapping</span>
			<span class="n">file_to_groups</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groups</span><span class="p">):</span>
				<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_to_groups</span><span class="p">:</span>
						<span class="n">file_to_groups</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
					<span class="n">file_to_groups</span><span class="p">[</span><span class="n">file</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

			<span class="c1"># Find violations (files in multiple groups)</span>
			<span class="n">violations</span> <span class="o">=</span> <span class="p">{</span><span class="n">file</span><span class="p">:</span> <span class="n">indices</span> <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">file_to_groups</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">}</span>

			<span class="k">if</span> <span class="ow">not</span> <span class="n">violations</span><span class="p">:</span>
				<span class="k">break</span>  <span class="c1"># No violations, we&#39;re done</span>

			<span class="c1"># Process the first violation</span>
			<span class="n">file</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">violations</span><span class="p">))</span>
			<span class="n">group_indices</span> <span class="o">=</span> <span class="n">violations</span><span class="p">[</span><span class="n">file</span><span class="p">]</span>

			<span class="c1"># Try to find groups to merge based on similarity</span>
			<span class="n">max_similarity</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">groups_to_merge</span> <span class="o">=</span> <span class="kc">None</span>

			<span class="c1"># Calculate similarities between all pairs of groups containing this file</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group_indices</span><span class="p">)):</span>
				<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_indices</span><span class="p">)):</span>
					<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">group_indices</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
					<span class="n">similarity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_group_similarity</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">],</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx2</span><span class="p">],</span> <span class="n">chunk_embeddings</span><span class="p">)</span>

					<span class="k">if</span> <span class="n">similarity</span> <span class="o">&gt;</span> <span class="n">max_similarity</span><span class="p">:</span>
						<span class="n">max_similarity</span> <span class="o">=</span> <span class="n">similarity</span>
						<span class="n">groups_to_merge</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span><span class="p">)</span>

			<span class="c1"># Decide whether to merge or reassign based on similarity threshold</span>
			<span class="k">if</span> <span class="n">max_similarity</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity_threshold</span> <span class="ow">and</span> <span class="n">groups_to_merge</span><span class="p">:</span>
				<span class="c1"># STRATEGY 1: Merge groups if they&#39;re similar enough</span>
				<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">groups_to_merge</span>
				<span class="n">merged_group</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span><span class="o">.</span><span class="n">merge_with</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">idx2</span><span class="p">])</span>

				<span class="c1"># Replace the first group with the merged one and remove the second</span>
				<span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_group</span>
				<span class="n">groups</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx2</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># STRATEGY 2: Reassign chunks to the primary group for this file</span>
				<span class="c1"># Find the primary group (group with most chunks containing this file)</span>
				<span class="n">file_chunks_count</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">group_indices</span><span class="p">:</span>
					<span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
					<span class="n">file_chunks_count</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>

				<span class="c1"># Sort by count descending</span>
				<span class="n">file_chunks_count</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
				<span class="n">primary_idx</span> <span class="o">=</span> <span class="n">file_chunks_count</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

				<span class="c1"># Move chunks containing this file to the primary group</span>
				<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">group_indices</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="n">primary_idx</span><span class="p">:</span>
						<span class="c1"># Find chunks containing this file</span>
						<span class="n">chunks_to_move</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">]</span>

						<span class="c1"># Move chunks to primary group</span>
						<span class="n">groups</span><span class="p">[</span><span class="n">primary_idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chunks_to_move</span><span class="p">)</span>

						<span class="c1"># Remove moved chunks from original group</span>
						<span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">]</span>

				<span class="c1"># Remove empty groups</span>
				<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">]</span>

		<span class="k">return</span> <span class="n">groups</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.FileIntegrityResolver.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span><span class="nf">similarity_threshold</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the resolver.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>similarity_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Threshold for group similarity to trigger merging (0.0-1.0).
Higher values require greater similarity to merge groups:
- Values near 0.5 are permissive and will merge moderately related groups
- Values above 0.7 are strict and will mostly reassign chunks instead of merging
- Default 0.6 provides a balanced approach</p>
              </div>
            </td>
            <td>
                  <code>0.6</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ImportError">ImportError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If scikit-learn is not installed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/resolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">similarity_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initialize the resolver.</span>

<span class="sd">	Args:</span>
<span class="sd">	    similarity_threshold: Threshold for group similarity to trigger merging (0.0-1.0).</span>
<span class="sd">	        Higher values require greater similarity to merge groups:</span>
<span class="sd">	        - Values near 0.5 are permissive and will merge moderately related groups</span>
<span class="sd">	        - Values above 0.7 are strict and will mostly reassign chunks instead of merging</span>
<span class="sd">	        - Default 0.6 provides a balanced approach</span>

<span class="sd">	Raises:</span>
<span class="sd">	    ImportError: If scikit-learn is not installed</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">similarity_threshold</span> <span class="o">=</span> <span class="n">similarity_threshold</span>

	<span class="c1"># Import here to avoid making sklearn a hard dependency</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_similarity</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n">cosine_similarity</span>
	<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Failed to import scikit-learn. Please install it with: uv add scikit-learn&quot;</span><span class="p">)</span>
		<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;scikit-learn is required for file integrity resolution&quot;</span>
		<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.FileIntegrityResolver.similarity_threshold" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">similarity_threshold</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">similarity_threshold</span> <span class="o">=</span> <span class="n"><span title="codemap.git.semantic_grouping.resolver.FileIntegrityResolver(similarity_threshold)">similarity_threshold</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.FileIntegrityResolver.cosine_similarity" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">cosine_similarity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n"><span title="sklearn.metrics.pairwise.cosine_similarity">cosine_similarity</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.FileIntegrityResolver.calculate_group_similarity" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_group_similarity</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_group_similarity</span><span class="p">(</span>
	<span class="n">group1</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">,</span>
	<span class="n">group2</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">,</span>
	<span class="n">chunk_embeddings</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">,</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate similarity between two groups based on their chunks' embeddings.</p>
<p>This method computes the average pairwise cosine similarity between all combinations
of chunks from the two groups. The similarity is based on the semantic embeddings
of the chunks' content.</p>
<p>Process:
1. Extract embeddings for all chunks in both groups
2. Compute pairwise cosine similarities between each pair of chunks
3. Return the average similarity score</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group1</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First semantic group to compare</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>group2</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second semantic group to compare</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunk_embeddings</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict mapping chunks to their embeddings</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Similarity score between 0 and 1, where:
- 0 indicates completely unrelated changes
- 1 indicates identical or extremely similar changes
- Values around 0.6-0.8 typically indicate related functionality</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/resolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_group_similarity</span><span class="p">(</span>
	<span class="bp">self</span><span class="p">,</span> <span class="n">group1</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">,</span> <span class="n">group2</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">,</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate similarity between two groups based on their chunks&#39; embeddings.</span>

<span class="sd">	This method computes the average pairwise cosine similarity between all combinations</span>
<span class="sd">	of chunks from the two groups. The similarity is based on the semantic embeddings</span>
<span class="sd">	of the chunks&#39; content.</span>

<span class="sd">	Process:</span>
<span class="sd">	1. Extract embeddings for all chunks in both groups</span>
<span class="sd">	2. Compute pairwise cosine similarities between each pair of chunks</span>
<span class="sd">	3. Return the average similarity score</span>

<span class="sd">	Args:</span>
<span class="sd">	    group1: First semantic group to compare</span>
<span class="sd">	    group2: Second semantic group to compare</span>
<span class="sd">	    chunk_embeddings: Dict mapping chunks to their embeddings</span>

<span class="sd">	Returns:</span>
<span class="sd">	    float: Similarity score between 0 and 1, where:</span>
<span class="sd">	        - 0 indicates completely unrelated changes</span>
<span class="sd">	        - 1 indicates identical or extremely similar changes</span>
<span class="sd">	        - Values around 0.6-0.8 typically indicate related functionality</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Get embeddings for chunks in each group</span>
	<span class="n">embeddings1</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk_embeddings</span><span class="p">[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">group1</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>
	<span class="n">embeddings2</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk_embeddings</span><span class="p">[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">group2</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">embeddings1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">embeddings2</span><span class="p">:</span>
		<span class="k">return</span> <span class="mf">0.0</span>

	<span class="c1"># Calculate pairwise similarities</span>
	<span class="n">similarities</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">emb1</span> <span class="ow">in</span> <span class="n">embeddings1</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">emb2</span> <span class="ow">in</span> <span class="n">embeddings2</span><span class="p">:</span>
			<span class="n">sim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span><span class="p">([</span><span class="n">emb1</span><span class="p">],</span> <span class="p">[</span><span class="n">emb2</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">similarities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

	<span class="c1"># Return average similarity</span>
	<span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">similarities</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">similarities</span><span class="p">)</span> <span class="k">if</span> <span class="n">similarities</span> <span class="k">else</span> <span class="mf">0.0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.FileIntegrityResolver.resolve_violations" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">resolve_violations</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">resolve_violations</span><span class="p">(</span>
	<span class="n">groups</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">],</span>
	<span class="n">chunk_embeddings</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">,</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Resolve file integrity violations by merging or reassigning chunks.</p>
<p>A violation occurs when the same file appears in multiple semantic groups.
This needs to be resolved because a file should be modified in only one commit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>groups</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SemanticGroup objects to resolve</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunk_embeddings</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict mapping chunks to their embeddings</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SemanticGroup objects with all violations resolved</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/resolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resolve_violations</span><span class="p">(</span>
	<span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">],</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Resolve file integrity violations by merging or reassigning chunks.</span>

<span class="sd">	A violation occurs when the same file appears in multiple semantic groups.</span>
<span class="sd">	This needs to be resolved because a file should be modified in only one commit.</span>

<span class="sd">	Args:</span>
<span class="sd">	    groups: List of SemanticGroup objects to resolve</span>
<span class="sd">	    chunk_embeddings: Dict mapping chunks to their embeddings</span>

<span class="sd">	Returns:</span>
<span class="sd">	    List of SemanticGroup objects with all violations resolved</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Keep iterating until no violations remain</span>
	<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
		<span class="c1"># Build file to groups mapping</span>
		<span class="n">file_to_groups</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groups</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_to_groups</span><span class="p">:</span>
					<span class="n">file_to_groups</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="n">file_to_groups</span><span class="p">[</span><span class="n">file</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

		<span class="c1"># Find violations (files in multiple groups)</span>
		<span class="n">violations</span> <span class="o">=</span> <span class="p">{</span><span class="n">file</span><span class="p">:</span> <span class="n">indices</span> <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">file_to_groups</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">}</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="n">violations</span><span class="p">:</span>
			<span class="k">break</span>  <span class="c1"># No violations, we&#39;re done</span>

		<span class="c1"># Process the first violation</span>
		<span class="n">file</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">violations</span><span class="p">))</span>
		<span class="n">group_indices</span> <span class="o">=</span> <span class="n">violations</span><span class="p">[</span><span class="n">file</span><span class="p">]</span>

		<span class="c1"># Try to find groups to merge based on similarity</span>
		<span class="n">max_similarity</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">groups_to_merge</span> <span class="o">=</span> <span class="kc">None</span>

		<span class="c1"># Calculate similarities between all pairs of groups containing this file</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group_indices</span><span class="p">)):</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_indices</span><span class="p">)):</span>
				<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">group_indices</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
				<span class="n">similarity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_group_similarity</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">],</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx2</span><span class="p">],</span> <span class="n">chunk_embeddings</span><span class="p">)</span>

				<span class="k">if</span> <span class="n">similarity</span> <span class="o">&gt;</span> <span class="n">max_similarity</span><span class="p">:</span>
					<span class="n">max_similarity</span> <span class="o">=</span> <span class="n">similarity</span>
					<span class="n">groups_to_merge</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span><span class="p">)</span>

		<span class="c1"># Decide whether to merge or reassign based on similarity threshold</span>
		<span class="k">if</span> <span class="n">max_similarity</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity_threshold</span> <span class="ow">and</span> <span class="n">groups_to_merge</span><span class="p">:</span>
			<span class="c1"># STRATEGY 1: Merge groups if they&#39;re similar enough</span>
			<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">groups_to_merge</span>
			<span class="n">merged_group</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span><span class="o">.</span><span class="n">merge_with</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">idx2</span><span class="p">])</span>

			<span class="c1"># Replace the first group with the merged one and remove the second</span>
			<span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_group</span>
			<span class="n">groups</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx2</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># STRATEGY 2: Reassign chunks to the primary group for this file</span>
			<span class="c1"># Find the primary group (group with most chunks containing this file)</span>
			<span class="n">file_chunks_count</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">group_indices</span><span class="p">:</span>
				<span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
				<span class="n">file_chunks_count</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>

			<span class="c1"># Sort by count descending</span>
			<span class="n">file_chunks_count</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			<span class="n">primary_idx</span> <span class="o">=</span> <span class="n">file_chunks_count</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

			<span class="c1"># Move chunks containing this file to the primary group</span>
			<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">group_indices</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="n">primary_idx</span><span class="p">:</span>
					<span class="c1"># Find chunks containing this file</span>
					<span class="n">chunks_to_move</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">]</span>

					<span class="c1"># Move chunks to primary group</span>
					<span class="n">groups</span><span class="p">[</span><span class="n">primary_idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chunks_to_move</span><span class="p">)</span>

					<span class="c1"># Remove moved chunks from original group</span>
					<span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">]</span>

			<span class="c1"># Remove empty groups</span>
			<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">]</span>

	<span class="k">return</span> <span class="n">groups</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-class">



<h3 id="codemap.git.semantic_grouping.SemanticGroup" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SemanticGroup</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>A semantic group of related diff chunks.</p>
<p>This class represents a group of related diff chunks that should be
committed together because they are semantically related.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/git/semantic_grouping/__init__.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SemanticGroup</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	A semantic group of related diff chunks.</span>

<span class="sd">	This class represents a group of related diff chunks that should be</span>
<span class="sd">	committed together because they are semantically related.</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
	<span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
	<span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
	<span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="n">approved</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
	<span class="n">embedding</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Initialize files and content from chunks if not provided.&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">:</span>
			<span class="c1"># Extract all unique files from chunks</span>
			<span class="n">all_files</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">:</span>
				<span class="n">all_files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_files</span><span class="p">))</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">:</span>
			<span class="c1"># Combine content from all chunks</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">content</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">merge_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Merge this group with another group.</span>

<span class="sd">		Args:</span>
<span class="sd">		        other: Another SemanticGroup to merge with</span>

<span class="sd">		Returns:</span>
<span class="sd">		        A new SemanticGroup containing chunks from both groups</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Combine chunks from both groups</span>
		<span class="n">combined_chunks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">)</span>
		<span class="n">combined_chunks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">chunks</span><span class="p">)</span>

		<span class="c1"># Create a new group with the combined chunks</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">SemanticGroup</span><span class="p">(</span><span class="n">chunks</span><span class="o">=</span><span class="n">combined_chunks</span><span class="p">)</span>

		<span class="c1"># If both groups have a message, prefer the one from self</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>
			<span class="n">result</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span>
		<span class="k">elif</span> <span class="n">other</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>
			<span class="n">result</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">message</span>

		<span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.SemanticGroup.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span>
	<span class="nf">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="list">list</span></span><span class="p">(),</span>
	<span class="n">files</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="list">list</span></span><span class="p">(),</span>
	<span class="n">content</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
	<span class="n">message</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">approved</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
	<span class="n">embedding</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">


    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.SemanticGroup.chunks" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">chunks</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="dataclasses.field">field</span></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><span title="list">list</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.SemanticGroup.files" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">files</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">files</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="dataclasses.field">field</span></span><span class="p">(</span><span class="n"><span title="dataclasses.field(default_factory)">default_factory</span></span><span class="o">=</span><span class="n"><span title="list">list</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.SemanticGroup.content" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">content</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">content</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.SemanticGroup.message" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">message</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">message</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.SemanticGroup.approved" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">approved</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">approved</span><span class="p">:</span> <span class="n"><span title="bool">bool</span></span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.SemanticGroup.embedding" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">embedding</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">embedding</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="float">float</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.SemanticGroup.__post_init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__post_init__</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__post_init__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize files and content from chunks if not provided.</p>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Initialize files and content from chunks if not provided.&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">:</span>
		<span class="c1"># Extract all unique files from chunks</span>
		<span class="n">all_files</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">:</span>
			<span class="n">all_files</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_files</span><span class="p">))</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">:</span>
		<span class="c1"># Combine content from all chunks</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">content</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.SemanticGroup.merge_with" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">merge_with</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">merge_with</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Merge this group with another group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Another SemanticGroup to merge with</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new SemanticGroup containing chunks from both groups</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merge_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Merge this group with another group.</span>

<span class="sd">	Args:</span>
<span class="sd">	        other: Another SemanticGroup to merge with</span>

<span class="sd">	Returns:</span>
<span class="sd">	        A new SemanticGroup containing chunks from both groups</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Combine chunks from both groups</span>
	<span class="n">combined_chunks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">)</span>
	<span class="n">combined_chunks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">chunks</span><span class="p">)</span>

	<span class="c1"># Create a new group with the combined chunks</span>
	<span class="n">result</span> <span class="o">=</span> <span class="n">SemanticGroup</span><span class="p">(</span><span class="n">chunks</span><span class="o">=</span><span class="n">combined_chunks</span><span class="p">)</span>

	<span class="c1"># If both groups have a message, prefer the one from self</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>
		<span class="n">result</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">message</span>
	<span class="k">elif</span> <span class="n">other</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>
		<span class="n">result</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">message</span>

	<span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>










<div class="doc doc-object doc-module">



<h3 id="codemap.git.semantic_grouping.batch_processor" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">batch_processor</span>


</h3>

    <div class="doc doc-contents ">

        <p>Batch processing for semantic groups commit message generation.</p>
<p>This module provides functionality to generate commit messages for
multiple semantic groups in batch using LiteLLM's batch_completion.</p>









  <div class="doc doc-children">















































<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.batch_processor.logger" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.batch_processor.batch_generate_messages" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">batch_generate_messages</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">batch_generate_messages</span><span class="p">(</span>
	<span class="n">groups</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">],</span>
	<span class="n">prompt_template</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span>
	<span class="n">config_loader</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ConfigLoader&lt;/span&gt; (&lt;code&gt;codemap.utils.config_loader.ConfigLoader&lt;/code&gt;)" href="../../utils/#codemap.utils.config_loader.ConfigLoader">ConfigLoader</a></span><span class="p">,</span>
	<span class="n">model</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate commit messages for multiple semantic groups in batch.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>groups</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SemanticGroup objects</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prompt_template</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Template to use for prompt generation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config_loader</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;ConfigLoader&lt;/span&gt; (&lt;code&gt;codemap.utils.config_loader.ConfigLoader&lt;/code&gt;)" href="../../utils/#codemap.utils.config_loader.ConfigLoader">ConfigLoader</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ConfigLoader instance</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional model name override</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SemanticGroup objects with messages added</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="LLMError">LLMError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If batch processing fails</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/batch_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">batch_generate_messages</span><span class="p">(</span>
	<span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">],</span>
	<span class="n">prompt_template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
	<span class="n">config_loader</span><span class="p">:</span> <span class="n">ConfigLoader</span><span class="p">,</span>
	<span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate commit messages for multiple semantic groups in batch.</span>

<span class="sd">	Args:</span>
<span class="sd">	    groups: List of SemanticGroup objects</span>
<span class="sd">	    prompt_template: Template to use for prompt generation</span>
<span class="sd">	    config_loader: ConfigLoader instance</span>
<span class="sd">	    model: Optional model name override</span>

<span class="sd">	Returns:</span>
<span class="sd">	    List of SemanticGroup objects with messages added</span>

<span class="sd">	Raises:</span>
<span class="sd">	    LLMError: If batch processing fails</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">groups</span><span class="p">:</span>
		<span class="k">return</span> <span class="p">[]</span>

	<span class="c1"># Get config values</span>
	<span class="n">llm_config</span> <span class="o">=</span> <span class="n">config_loader</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;llm&quot;</span><span class="p">,</span> <span class="p">{})</span>
	<span class="n">max_tokens</span> <span class="o">=</span> <span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_context_tokens&quot;</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
	<span class="n">use_lod_context</span> <span class="o">=</span> <span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;use_lod_context&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
	<span class="n">model_name</span> <span class="o">=</span> <span class="n">model</span> <span class="ow">or</span> <span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;openai/gpt-4o-mini&quot;</span><span class="p">)</span>

	<span class="c1"># Prepare temporary chunks and prompts for each group</span>
	<span class="n">temp_chunks</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">messages_list</span> <span class="o">=</span> <span class="p">[]</span>

	<span class="c1"># Add this at the top of the function, right after getting the config values</span>
	<span class="n">ui</span> <span class="o">=</span> <span class="n">CommitUI</span><span class="p">()</span>

	<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="c1"># Create a temporary DiffChunk with optimized content if needed</span>
			<span class="k">if</span> <span class="n">use_lod_context</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Processing semantic group with </span><span class="si">%d</span><span class="s2"> chunks using LOD context&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">))</span>
				<span class="k">try</span><span class="p">:</span>
					<span class="n">optimized_content</span> <span class="o">=</span> <span class="n">process_chunks_with_lod</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">,</span> <span class="n">max_tokens</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">optimized_content</span><span class="p">:</span>
						<span class="n">temp_chunk</span> <span class="o">=</span> <span class="n">DiffChunk</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">optimized_content</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">temp_chunk</span> <span class="o">=</span> <span class="n">DiffChunk</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
				<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error in LOD context processing, falling back to original content&quot;</span><span class="p">)</span>
					<span class="n">temp_chunk</span> <span class="o">=</span> <span class="n">DiffChunk</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">temp_chunk</span> <span class="o">=</span> <span class="n">DiffChunk</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">group</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

			<span class="c1"># Store the temp chunk for reference</span>
			<span class="n">temp_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_chunk</span><span class="p">)</span>

			<span class="c1"># Create a simple dictionary with file paths as keys</span>
			<span class="n">file_info</span> <span class="o">=</span> <span class="p">{</span><span class="n">file</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">file</span><span class="p">}</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">}</span>

			<span class="c1"># Prepare the prompt for this group</span>
			<span class="n">prompt</span> <span class="o">=</span> <span class="n">prepare_prompt</span><span class="p">(</span>
				<span class="n">template</span><span class="o">=</span><span class="n">prompt_template</span><span class="p">,</span>
				<span class="n">diff_content</span><span class="o">=</span><span class="n">temp_chunk</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
				<span class="n">file_info</span><span class="o">=</span><span class="n">file_info</span><span class="p">,</span>
				<span class="n">convention</span><span class="o">=</span><span class="n">config_loader</span><span class="o">.</span><span class="n">get_commit_convention</span><span class="p">(),</span>
			<span class="p">)</span>

			<span class="c1"># Format as messages for batch_completion</span>
			<span class="n">messages</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">}]</span>
			<span class="n">messages_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>

		<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error preparing prompt for group </span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="c1"># Add empty messages for this group to maintain index alignment</span>
			<span class="n">messages_list</span><span class="o">.</span><span class="n">append</span><span class="p">([{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Skip this group due to error&quot;</span><span class="p">}])</span>

	<span class="c1"># Use the LLM module&#39;s batch generation</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">codemap.git.commit_generator.schemas</span><span class="w"> </span><span class="kn">import</span> <span class="n">COMMIT_MESSAGE_SCHEMA</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">codemap.llm.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">batch_generate_completions</span>

		<span class="c1"># Execute batch completion using the LLM module</span>
		<span class="n">responses</span> <span class="o">=</span> <span class="n">batch_generate_completions</span><span class="p">(</span>
			<span class="n">messages_list</span><span class="o">=</span><span class="n">messages_list</span><span class="p">,</span>
			<span class="n">model</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span>
			<span class="n">config_loader</span><span class="o">=</span><span class="n">config_loader</span><span class="p">,</span>
			<span class="n">response_format</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;json_object&quot;</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">COMMIT_MESSAGE_SCHEMA</span><span class="p">},</span>
			<span class="n">temperature</span><span class="o">=</span><span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span>
			<span class="n">max_tokens</span><span class="o">=</span><span class="n">llm_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_tokens&quot;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span>
		<span class="p">)</span>

		<span class="c1"># Process responses and update groups</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">responses</span><span class="p">,</span> <span class="n">groups</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)):</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="c1"># Extract content from response</span>
				<span class="k">if</span> <span class="n">response</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s2">&quot;choices&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">:</span>
					<span class="n">content</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>

					<span class="c1"># If it&#39;s JSON, extract the message</span>
					<span class="k">if</span> <span class="n">content</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">content</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">):</span>
						<span class="k">try</span><span class="p">:</span>
							<span class="c1"># Check if it&#39;s in the {&quot;commit_message&quot;: &quot;...&quot;} format</span>
							<span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
							<span class="k">if</span> <span class="s2">&quot;commit_message&quot;</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">:</span>
								<span class="c1"># Extract just the commit message</span>
								<span class="n">content</span> <span class="o">=</span> <span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;commit_message&quot;</span><span class="p">]</span>
							<span class="k">elif</span> <span class="s2">&quot;message&quot;</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">:</span>
								<span class="c1"># Extract message from {&quot;message&quot;: &quot;...&quot;} format</span>
								<span class="n">content</span> <span class="o">=</span> <span class="n">json_data</span><span class="p">[</span><span class="s2">&quot;message&quot;</span><span class="p">]</span>
							<span class="k">else</span><span class="p">:</span>
								<span class="c1"># Use the formatter for conventional format</span>
								<span class="n">content</span> <span class="o">=</span> <span class="n">format_commit_json</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
						<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
							<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error formatting JSON to commit message&quot;</span><span class="p">)</span>

					<span class="c1"># Set the message on the group</span>
					<span class="n">group</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">content</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Empty or invalid response for group </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
					<span class="n">group</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;update: changes to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files&quot;</span>
			<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing response for group </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
				<span class="n">group</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;update: changes to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files&quot;</span>

	<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Batch completion failed&quot;</span><span class="p">)</span>
		<span class="c1"># Just use the already initialized UI</span>
		<span class="n">ui</span><span class="o">.</span><span class="n">show_warning</span><span class="p">(</span><span class="s2">&quot;LLM call failed. Using fallback commit messages.&quot;</span><span class="p">)</span>

		<span class="c1"># Provide fallback messages for all groups</span>
		<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">group</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>  <span class="c1"># Don&#39;t override if already set</span>
				<span class="n">fallback_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;update: changes to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files&quot;</span>
				<span class="n">group</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">fallback_msg</span>
				<span class="c1"># Log which groups received fallback messages</span>
				<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using fallback message for files: </span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">groups</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-module">



<h3 id="codemap.git.semantic_grouping.resolver" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">resolver</span>


</h3>

    <div class="doc doc-contents ">

        <p>Module for resolving file integrity constraints in semantic groups.</p>
<p>This module provides functionality for ensuring that changes to the same file are kept
in the same commit, even when semantic clustering might separate them. This ensures that
file integrity is maintained during the commit process.</p>
<p>Key components:
- FileIntegrityResolver: Main class that analyzes file overlaps between semantic groups
  and decides whether to merge groups or reassign chunks to maintain file integrity</p>
<p>The resolution process involves:
1. Detecting violations (files that appear in multiple semantic groups)
2. Calculating semantic similarity between groups with overlapping files
3. Deciding whether to merge groups (if sufficiently similar) or reassign chunks
4. Iteratively resolving violations until all files are in exactly one group</p>









  <div class="doc doc-children">































<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.resolver.logger" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.resolver.T" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">T</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">T</span> <span class="o">=</span> <span class="n"><span title="typing.TypeVar">TypeVar</span></span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n"><span title="typing.TypeVar(bound)">bound</span></span><span class="o">=</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-class">



<h4 id="codemap.git.semantic_grouping.resolver.FileIntegrityResolver" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">FileIntegrityResolver</span>


</h4>


    <div class="doc doc-contents ">


        <p>Resolves file integrity constraints for semantic groups.</p>
<p>File integrity refers to the requirement that all changes to a specific file should
be included in the same commit, even if they are semantically different. This prevents
fragmented changes to the same file across multiple commits, which can lead to broken builds
or inconsistent states.</p>
<p>The resolver works by:
1. Identifying files that appear in multiple semantic groups
2. Calculating the semantic similarity between these overlapping groups
3. Either merging similar groups or reassigning chunks from less relevant groups
   to the most appropriate group</p>
<p>This process ensures that each file is modified in exactly one commit, while still
maintaining semantic coherence within commits when possible.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/git/semantic_grouping/resolver.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FileIntegrityResolver</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Resolves file integrity constraints for semantic groups.</span>

<span class="sd">	File integrity refers to the requirement that all changes to a specific file should</span>
<span class="sd">	be included in the same commit, even if they are semantically different. This prevents</span>
<span class="sd">	fragmented changes to the same file across multiple commits, which can lead to broken builds</span>
<span class="sd">	or inconsistent states.</span>

<span class="sd">	The resolver works by:</span>
<span class="sd">	1. Identifying files that appear in multiple semantic groups</span>
<span class="sd">	2. Calculating the semantic similarity between these overlapping groups</span>
<span class="sd">	3. Either merging similar groups or reassigning chunks from less relevant groups</span>
<span class="sd">	   to the most appropriate group</span>

<span class="sd">	This process ensures that each file is modified in exactly one commit, while still</span>
<span class="sd">	maintaining semantic coherence within commits when possible.</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">similarity_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initialize the resolver.</span>

<span class="sd">		Args:</span>
<span class="sd">		    similarity_threshold: Threshold for group similarity to trigger merging (0.0-1.0).</span>
<span class="sd">		        Higher values require greater similarity to merge groups:</span>
<span class="sd">		        - Values near 0.5 are permissive and will merge moderately related groups</span>
<span class="sd">		        - Values above 0.7 are strict and will mostly reassign chunks instead of merging</span>
<span class="sd">		        - Default 0.6 provides a balanced approach</span>

<span class="sd">		Raises:</span>
<span class="sd">		    ImportError: If scikit-learn is not installed</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">similarity_threshold</span> <span class="o">=</span> <span class="n">similarity_threshold</span>

		<span class="c1"># Import here to avoid making sklearn a hard dependency</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_similarity</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n">cosine_similarity</span>
		<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Failed to import scikit-learn. Please install it with: uv add scikit-learn&quot;</span><span class="p">)</span>
			<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;scikit-learn is required for file integrity resolution&quot;</span>
			<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">calculate_group_similarity</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span> <span class="n">group1</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">,</span> <span class="n">group2</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">,</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Calculate similarity between two groups based on their chunks&#39; embeddings.</span>

<span class="sd">		This method computes the average pairwise cosine similarity between all combinations</span>
<span class="sd">		of chunks from the two groups. The similarity is based on the semantic embeddings</span>
<span class="sd">		of the chunks&#39; content.</span>

<span class="sd">		Process:</span>
<span class="sd">		1. Extract embeddings for all chunks in both groups</span>
<span class="sd">		2. Compute pairwise cosine similarities between each pair of chunks</span>
<span class="sd">		3. Return the average similarity score</span>

<span class="sd">		Args:</span>
<span class="sd">		    group1: First semantic group to compare</span>
<span class="sd">		    group2: Second semantic group to compare</span>
<span class="sd">		    chunk_embeddings: Dict mapping chunks to their embeddings</span>

<span class="sd">		Returns:</span>
<span class="sd">		    float: Similarity score between 0 and 1, where:</span>
<span class="sd">		        - 0 indicates completely unrelated changes</span>
<span class="sd">		        - 1 indicates identical or extremely similar changes</span>
<span class="sd">		        - Values around 0.6-0.8 typically indicate related functionality</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Get embeddings for chunks in each group</span>
		<span class="n">embeddings1</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk_embeddings</span><span class="p">[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">group1</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>
		<span class="n">embeddings2</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk_embeddings</span><span class="p">[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">group2</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="n">embeddings1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">embeddings2</span><span class="p">:</span>
			<span class="k">return</span> <span class="mf">0.0</span>

		<span class="c1"># Calculate pairwise similarities</span>
		<span class="n">similarities</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">emb1</span> <span class="ow">in</span> <span class="n">embeddings1</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">emb2</span> <span class="ow">in</span> <span class="n">embeddings2</span><span class="p">:</span>
				<span class="n">sim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span><span class="p">([</span><span class="n">emb1</span><span class="p">],</span> <span class="p">[</span><span class="n">emb2</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">similarities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

		<span class="c1"># Return average similarity</span>
		<span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">similarities</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">similarities</span><span class="p">)</span> <span class="k">if</span> <span class="n">similarities</span> <span class="k">else</span> <span class="mf">0.0</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">resolve_violations</span><span class="p">(</span>
		<span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">],</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
	<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">]:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Resolve file integrity violations by merging or reassigning chunks.</span>

<span class="sd">		A violation occurs when the same file appears in multiple semantic groups.</span>
<span class="sd">		This needs to be resolved because a file should be modified in only one commit.</span>

<span class="sd">		Args:</span>
<span class="sd">		    groups: List of SemanticGroup objects to resolve</span>
<span class="sd">		    chunk_embeddings: Dict mapping chunks to their embeddings</span>

<span class="sd">		Returns:</span>
<span class="sd">		    List of SemanticGroup objects with all violations resolved</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Keep iterating until no violations remain</span>
		<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
			<span class="c1"># Build file to groups mapping</span>
			<span class="n">file_to_groups</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groups</span><span class="p">):</span>
				<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_to_groups</span><span class="p">:</span>
						<span class="n">file_to_groups</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
					<span class="n">file_to_groups</span><span class="p">[</span><span class="n">file</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

			<span class="c1"># Find violations (files in multiple groups)</span>
			<span class="n">violations</span> <span class="o">=</span> <span class="p">{</span><span class="n">file</span><span class="p">:</span> <span class="n">indices</span> <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">file_to_groups</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">}</span>

			<span class="k">if</span> <span class="ow">not</span> <span class="n">violations</span><span class="p">:</span>
				<span class="k">break</span>  <span class="c1"># No violations, we&#39;re done</span>

			<span class="c1"># Process the first violation</span>
			<span class="n">file</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">violations</span><span class="p">))</span>
			<span class="n">group_indices</span> <span class="o">=</span> <span class="n">violations</span><span class="p">[</span><span class="n">file</span><span class="p">]</span>

			<span class="c1"># Try to find groups to merge based on similarity</span>
			<span class="n">max_similarity</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">groups_to_merge</span> <span class="o">=</span> <span class="kc">None</span>

			<span class="c1"># Calculate similarities between all pairs of groups containing this file</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group_indices</span><span class="p">)):</span>
				<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_indices</span><span class="p">)):</span>
					<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">group_indices</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
					<span class="n">similarity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_group_similarity</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">],</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx2</span><span class="p">],</span> <span class="n">chunk_embeddings</span><span class="p">)</span>

					<span class="k">if</span> <span class="n">similarity</span> <span class="o">&gt;</span> <span class="n">max_similarity</span><span class="p">:</span>
						<span class="n">max_similarity</span> <span class="o">=</span> <span class="n">similarity</span>
						<span class="n">groups_to_merge</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span><span class="p">)</span>

			<span class="c1"># Decide whether to merge or reassign based on similarity threshold</span>
			<span class="k">if</span> <span class="n">max_similarity</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity_threshold</span> <span class="ow">and</span> <span class="n">groups_to_merge</span><span class="p">:</span>
				<span class="c1"># STRATEGY 1: Merge groups if they&#39;re similar enough</span>
				<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">groups_to_merge</span>
				<span class="n">merged_group</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span><span class="o">.</span><span class="n">merge_with</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">idx2</span><span class="p">])</span>

				<span class="c1"># Replace the first group with the merged one and remove the second</span>
				<span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_group</span>
				<span class="n">groups</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx2</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># STRATEGY 2: Reassign chunks to the primary group for this file</span>
				<span class="c1"># Find the primary group (group with most chunks containing this file)</span>
				<span class="n">file_chunks_count</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">group_indices</span><span class="p">:</span>
					<span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
					<span class="n">file_chunks_count</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>

				<span class="c1"># Sort by count descending</span>
				<span class="n">file_chunks_count</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
				<span class="n">primary_idx</span> <span class="o">=</span> <span class="n">file_chunks_count</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

				<span class="c1"># Move chunks containing this file to the primary group</span>
				<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">group_indices</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="n">primary_idx</span><span class="p">:</span>
						<span class="c1"># Find chunks containing this file</span>
						<span class="n">chunks_to_move</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">]</span>

						<span class="c1"># Move chunks to primary group</span>
						<span class="n">groups</span><span class="p">[</span><span class="n">primary_idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chunks_to_move</span><span class="p">)</span>

						<span class="c1"># Remove moved chunks from original group</span>
						<span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">]</span>

				<span class="c1"># Remove empty groups</span>
				<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">]</span>

		<span class="k">return</span> <span class="n">groups</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.resolver.FileIntegrityResolver.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span><span class="nf">similarity_threshold</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the resolver.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>similarity_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Threshold for group similarity to trigger merging (0.0-1.0).
Higher values require greater similarity to merge groups:
- Values near 0.5 are permissive and will merge moderately related groups
- Values above 0.7 are strict and will mostly reassign chunks instead of merging
- Default 0.6 provides a balanced approach</p>
              </div>
            </td>
            <td>
                  <code>0.6</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ImportError">ImportError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If scikit-learn is not installed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/resolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">similarity_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initialize the resolver.</span>

<span class="sd">	Args:</span>
<span class="sd">	    similarity_threshold: Threshold for group similarity to trigger merging (0.0-1.0).</span>
<span class="sd">	        Higher values require greater similarity to merge groups:</span>
<span class="sd">	        - Values near 0.5 are permissive and will merge moderately related groups</span>
<span class="sd">	        - Values above 0.7 are strict and will mostly reassign chunks instead of merging</span>
<span class="sd">	        - Default 0.6 provides a balanced approach</span>

<span class="sd">	Raises:</span>
<span class="sd">	    ImportError: If scikit-learn is not installed</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">similarity_threshold</span> <span class="o">=</span> <span class="n">similarity_threshold</span>

	<span class="c1"># Import here to avoid making sklearn a hard dependency</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_similarity</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n">cosine_similarity</span>
	<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Failed to import scikit-learn. Please install it with: uv add scikit-learn&quot;</span><span class="p">)</span>
		<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;scikit-learn is required for file integrity resolution&quot;</span>
		<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.resolver.FileIntegrityResolver.similarity_threshold" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">similarity_threshold</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">similarity_threshold</span> <span class="o">=</span> <span class="n"><span title="codemap.git.semantic_grouping.resolver.FileIntegrityResolver(similarity_threshold)">similarity_threshold</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.resolver.FileIntegrityResolver.cosine_similarity" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">cosine_similarity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n"><span title="sklearn.metrics.pairwise.cosine_similarity">cosine_similarity</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.resolver.FileIntegrityResolver.calculate_group_similarity" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">calculate_group_similarity</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">calculate_group_similarity</span><span class="p">(</span>
	<span class="n">group1</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">,</span>
	<span class="n">group2</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">,</span>
	<span class="n">chunk_embeddings</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">,</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="float">float</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate similarity between two groups based on their chunks' embeddings.</p>
<p>This method computes the average pairwise cosine similarity between all combinations
of chunks from the two groups. The similarity is based on the semantic embeddings
of the chunks' content.</p>
<p>Process:
1. Extract embeddings for all chunks in both groups
2. Compute pairwise cosine similarities between each pair of chunks
3. Return the average similarity score</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>group1</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First semantic group to compare</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>group2</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second semantic group to compare</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunk_embeddings</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict mapping chunks to their embeddings</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Similarity score between 0 and 1, where:
- 0 indicates completely unrelated changes
- 1 indicates identical or extremely similar changes
- Values around 0.6-0.8 typically indicate related functionality</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/resolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_group_similarity</span><span class="p">(</span>
	<span class="bp">self</span><span class="p">,</span> <span class="n">group1</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">,</span> <span class="n">group2</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">,</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate similarity between two groups based on their chunks&#39; embeddings.</span>

<span class="sd">	This method computes the average pairwise cosine similarity between all combinations</span>
<span class="sd">	of chunks from the two groups. The similarity is based on the semantic embeddings</span>
<span class="sd">	of the chunks&#39; content.</span>

<span class="sd">	Process:</span>
<span class="sd">	1. Extract embeddings for all chunks in both groups</span>
<span class="sd">	2. Compute pairwise cosine similarities between each pair of chunks</span>
<span class="sd">	3. Return the average similarity score</span>

<span class="sd">	Args:</span>
<span class="sd">	    group1: First semantic group to compare</span>
<span class="sd">	    group2: Second semantic group to compare</span>
<span class="sd">	    chunk_embeddings: Dict mapping chunks to their embeddings</span>

<span class="sd">	Returns:</span>
<span class="sd">	    float: Similarity score between 0 and 1, where:</span>
<span class="sd">	        - 0 indicates completely unrelated changes</span>
<span class="sd">	        - 1 indicates identical or extremely similar changes</span>
<span class="sd">	        - Values around 0.6-0.8 typically indicate related functionality</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Get embeddings for chunks in each group</span>
	<span class="n">embeddings1</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk_embeddings</span><span class="p">[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">group1</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>
	<span class="n">embeddings2</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk_embeddings</span><span class="p">[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">group2</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">embeddings1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">embeddings2</span><span class="p">:</span>
		<span class="k">return</span> <span class="mf">0.0</span>

	<span class="c1"># Calculate pairwise similarities</span>
	<span class="n">similarities</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">emb1</span> <span class="ow">in</span> <span class="n">embeddings1</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">emb2</span> <span class="ow">in</span> <span class="n">embeddings2</span><span class="p">:</span>
			<span class="n">sim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span><span class="p">([</span><span class="n">emb1</span><span class="p">],</span> <span class="p">[</span><span class="n">emb2</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">similarities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>

	<span class="c1"># Return average similarity</span>
	<span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">similarities</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">similarities</span><span class="p">)</span> <span class="k">if</span> <span class="n">similarities</span> <span class="k">else</span> <span class="mf">0.0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.resolver.FileIntegrityResolver.resolve_violations" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">resolve_violations</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">resolve_violations</span><span class="p">(</span>
	<span class="n">groups</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">],</span>
	<span class="n">chunk_embeddings</span><span class="p">:</span> <span class="n"><span title="dict">dict</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">,</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Resolve file integrity violations by merging or reassigning chunks.</p>
<p>A violation occurs when the same file appears in multiple semantic groups.
This needs to be resolved because a file should be modified in only one commit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>groups</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SemanticGroup objects to resolve</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunk_embeddings</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict mapping chunks to their embeddings</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.SemanticGroup">SemanticGroup</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SemanticGroup objects with all violations resolved</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/resolver.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resolve_violations</span><span class="p">(</span>
	<span class="bp">self</span><span class="p">,</span> <span class="n">groups</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">],</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;SemanticGroup&quot;</span><span class="p">]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Resolve file integrity violations by merging or reassigning chunks.</span>

<span class="sd">	A violation occurs when the same file appears in multiple semantic groups.</span>
<span class="sd">	This needs to be resolved because a file should be modified in only one commit.</span>

<span class="sd">	Args:</span>
<span class="sd">	    groups: List of SemanticGroup objects to resolve</span>
<span class="sd">	    chunk_embeddings: Dict mapping chunks to their embeddings</span>

<span class="sd">	Returns:</span>
<span class="sd">	    List of SemanticGroup objects with all violations resolved</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Keep iterating until no violations remain</span>
	<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
		<span class="c1"># Build file to groups mapping</span>
		<span class="n">file_to_groups</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">groups</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_to_groups</span><span class="p">:</span>
					<span class="n">file_to_groups</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="n">file_to_groups</span><span class="p">[</span><span class="n">file</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

		<span class="c1"># Find violations (files in multiple groups)</span>
		<span class="n">violations</span> <span class="o">=</span> <span class="p">{</span><span class="n">file</span><span class="p">:</span> <span class="n">indices</span> <span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="n">file_to_groups</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">}</span>

		<span class="k">if</span> <span class="ow">not</span> <span class="n">violations</span><span class="p">:</span>
			<span class="k">break</span>  <span class="c1"># No violations, we&#39;re done</span>

		<span class="c1"># Process the first violation</span>
		<span class="n">file</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">violations</span><span class="p">))</span>
		<span class="n">group_indices</span> <span class="o">=</span> <span class="n">violations</span><span class="p">[</span><span class="n">file</span><span class="p">]</span>

		<span class="c1"># Try to find groups to merge based on similarity</span>
		<span class="n">max_similarity</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">groups_to_merge</span> <span class="o">=</span> <span class="kc">None</span>

		<span class="c1"># Calculate similarities between all pairs of groups containing this file</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group_indices</span><span class="p">)):</span>
			<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_indices</span><span class="p">)):</span>
				<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">group_indices</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">group_indices</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
				<span class="n">similarity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_group_similarity</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">],</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx2</span><span class="p">],</span> <span class="n">chunk_embeddings</span><span class="p">)</span>

				<span class="k">if</span> <span class="n">similarity</span> <span class="o">&gt;</span> <span class="n">max_similarity</span><span class="p">:</span>
					<span class="n">max_similarity</span> <span class="o">=</span> <span class="n">similarity</span>
					<span class="n">groups_to_merge</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span><span class="p">)</span>

		<span class="c1"># Decide whether to merge or reassign based on similarity threshold</span>
		<span class="k">if</span> <span class="n">max_similarity</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">similarity_threshold</span> <span class="ow">and</span> <span class="n">groups_to_merge</span><span class="p">:</span>
			<span class="c1"># STRATEGY 1: Merge groups if they&#39;re similar enough</span>
			<span class="n">idx1</span><span class="p">,</span> <span class="n">idx2</span> <span class="o">=</span> <span class="n">groups_to_merge</span>
			<span class="n">merged_group</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span><span class="o">.</span><span class="n">merge_with</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">idx2</span><span class="p">])</span>

			<span class="c1"># Replace the first group with the merged one and remove the second</span>
			<span class="n">groups</span><span class="p">[</span><span class="n">idx1</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_group</span>
			<span class="n">groups</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx2</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># STRATEGY 2: Reassign chunks to the primary group for this file</span>
			<span class="c1"># Find the primary group (group with most chunks containing this file)</span>
			<span class="n">file_chunks_count</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">group_indices</span><span class="p">:</span>
				<span class="n">count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
				<span class="n">file_chunks_count</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>

			<span class="c1"># Sort by count descending</span>
			<span class="n">file_chunks_count</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			<span class="n">primary_idx</span> <span class="o">=</span> <span class="n">file_chunks_count</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

			<span class="c1"># Move chunks containing this file to the primary group</span>
			<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">group_indices</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="n">primary_idx</span><span class="p">:</span>
					<span class="c1"># Find chunks containing this file</span>
					<span class="n">chunks_to_move</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">]</span>

					<span class="c1"># Move chunks to primary group</span>
					<span class="n">groups</span><span class="p">[</span><span class="n">primary_idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">chunks_to_move</span><span class="p">)</span>

					<span class="c1"># Remove moved chunks from original group</span>
					<span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">chunk</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">chunks</span> <span class="k">if</span> <span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">]</span>

			<span class="c1"># Remove empty groups</span>
			<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span> <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">chunks</span><span class="p">]</span>

	<span class="k">return</span> <span class="n">groups</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-module">



<h3 id="codemap.git.semantic_grouping.context_processor" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">context_processor</span>


</h3>

    <div class="doc doc-contents ">

        <p>Context processing utilities for LLM prompts.</p>
<p>This module provides functionality to process and format code contexts
for LLM prompts using tree-sitter analysis and Level of Detail (LOD) to
optimize context length while preserving meaningful content.</p>









  <div class="doc doc-children">































<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.context_processor.logger" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">DEFAULT_MAX_TOKENS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">DEFAULT_MAX_TOKENS</span> <span class="o">=</span> <span class="mi">4000</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.context_processor.CHUNK_TOKEN_ESTIMATE" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">CHUNK_TOKEN_ESTIMATE</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">CHUNK_TOKEN_ESTIMATE</span> <span class="o">=</span> <span class="mi">500</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.context_processor.MAX_CHUNKS" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">MAX_CHUNKS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">MAX_CHUNKS</span> <span class="o">=</span> <span class="mi">6</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.context_processor.MAX_SIMPLE_CHUNKS" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">MAX_SIMPLE_CHUNKS</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">MAX_SIMPLE_CHUNKS</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.process_chunks_with_lod" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">process_chunks_with_lod</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">process_chunks_with_lod</span><span class="p">(</span>
	<span class="n">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">],</span>
	<span class="n">max_tokens</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;DEFAULT_MAX_TOKENS&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS">DEFAULT_MAX_TOKENS</a></span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Process diff chunks using LOD to create optimized context for LLM prompts.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of diff chunks to process</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_tokens</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum tokens allowed in the formatted context</p>
              </div>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-attribute-name&quot;&gt;DEFAULT_MAX_TOKENS&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-module-attribute&quot;&gt;&lt;code&gt;module-attribute&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.context_processor.DEFAULT_MAX_TOKENS">DEFAULT_MAX_TOKENS</a></code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatted markdown context optimized for token usage</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_chunks_with_lod</span><span class="p">(</span><span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">],</span> <span class="n">max_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">DEFAULT_MAX_TOKENS</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Process diff chunks using LOD to create optimized context for LLM prompts.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunks: List of diff chunks to process</span>
<span class="sd">	    max_tokens: Maximum tokens allowed in the formatted context</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Formatted markdown context optimized for token usage</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># If chunks list is small, we might not need LOD processing</span>
	<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">MAX_SIMPLE_CHUNKS</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">format_regular_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">[:</span><span class="n">MAX_CHUNKS</span><span class="p">])</span>

	<span class="c1"># Set up LOD generator and estimate number of chunks we can include</span>
	<span class="n">lod_generator</span> <span class="o">=</span> <span class="n">LODGenerator</span><span class="p">()</span>
	<span class="n">estimated_chunk_count</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_tokens</span> <span class="o">//</span> <span class="n">CHUNK_TOKEN_ESTIMATE</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">))</span>
	<span class="n">prioritized_chunks</span> <span class="o">=</span> <span class="n">prioritize_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">estimated_chunk_count</span><span class="p">,</span> <span class="n">MAX_CHUNKS</span><span class="p">))</span>

	<span class="c1"># Start with highest LOD level and progressively reduce if needed</span>
	<span class="n">lod_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">LODLevel</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">,</span> <span class="n">LODLevel</span><span class="o">.</span><span class="n">SIGNATURES</span><span class="p">]</span>
	<span class="n">formatted_chunks</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">current_level_index</span> <span class="o">=</span> <span class="mi">0</span>

	<span class="k">while</span> <span class="n">current_level_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lod_levels</span><span class="p">):</span>
		<span class="n">current_level</span> <span class="o">=</span> <span class="n">lod_levels</span><span class="p">[</span><span class="n">current_level_index</span><span class="p">]</span>
		<span class="n">formatted_chunks</span> <span class="o">=</span> <span class="p">[]</span>

		<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">prioritized_chunks</span><span class="p">:</span>
			<span class="c1"># Get file paths from chunk</span>
			<span class="n">file_paths</span> <span class="o">=</span> <span class="n">get_file_paths_from_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>

			<span class="k">if</span> <span class="ow">not</span> <span class="n">file_paths</span><span class="p">:</span>
				<span class="c1"># If we can&#39;t extract paths, use regular formatting for this chunk</span>
				<span class="n">formatted_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span>
				<span class="k">continue</span>

			<span class="c1"># Process each file in the chunk with LOD</span>
			<span class="n">lod_formatted</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">file_paths</span><span class="p">:</span>
				<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
					<span class="k">continue</span>

				<span class="c1"># Generate LOD representation</span>
				<span class="n">lod_entity</span> <span class="o">=</span> <span class="n">lod_generator</span><span class="o">.</span><span class="n">generate_lod</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">current_level</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">lod_entity</span><span class="p">:</span>
					<span class="n">lod_formatted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_lod_entity</span><span class="p">(</span><span class="n">lod_entity</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">current_level</span><span class="p">))</span>

			<span class="k">if</span> <span class="n">lod_formatted</span><span class="p">:</span>
				<span class="n">formatted_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lod_formatted</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="c1"># Fallback to regular formatting</span>
				<span class="n">formatted_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">format_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span>

		<span class="c1"># Estimate if we&#39;re within token limit</span>
		<span class="n">total_context</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatted_chunks</span><span class="p">)</span>
		<span class="n">estimated_tokens</span> <span class="o">=</span> <span class="n">estimate_tokens</span><span class="p">(</span><span class="n">total_context</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">estimated_tokens</span> <span class="o">&lt;=</span> <span class="n">max_tokens</span> <span class="ow">or</span> <span class="n">current_level_index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lod_levels</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
			<span class="k">break</span>

		<span class="c1"># Try with lower LOD level</span>
		<span class="n">current_level_index</span> <span class="o">+=</span> <span class="mi">1</span>

	<span class="c1"># If we still exceed the token limit, truncate</span>
	<span class="n">total_context</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatted_chunks</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">estimate_tokens</span><span class="p">(</span><span class="n">total_context</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_tokens</span><span class="p">:</span>
		<span class="n">total_context</span> <span class="o">=</span> <span class="n">truncate_context</span><span class="p">(</span><span class="n">total_context</span><span class="p">,</span> <span class="n">max_tokens</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">total_context</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.prioritize_chunks" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">prioritize_chunks</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prioritize_chunks</span><span class="p">(</span>
	<span class="n">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">],</span> <span class="n">max_count</span><span class="p">:</span> <span class="n"><span title="int">int</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prioritize chunks based on heuristics (file types, changes, etc.).</p>
<p>This is a simple implementation that could be extended with more
sophisticated dissimilarity metrics.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of chunks to prioritize</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_count</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of chunks to return</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prioritized list of chunks</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prioritize_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">],</span> <span class="n">max_count</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Prioritize chunks based on heuristics (file types, changes, etc.).</span>

<span class="sd">	This is a simple implementation that could be extended with more</span>
<span class="sd">	sophisticated dissimilarity metrics.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunks: List of chunks to prioritize</span>
<span class="sd">	    max_count: Maximum number of chunks to return</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Prioritized list of chunks</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Simple heuristics for now:</span>
	<span class="c1"># 1. Prefer chunks with code files over non-code files</span>
	<span class="c1"># 2. Prefer chunks with more files (more central changes)</span>
	<span class="c1"># 3. Prefer chunks with more added/changed lines</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">chunk_score</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n">DiffChunk</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Calculates a priority score for a diff chunk based on heuristics.</span>

<span class="sd">		The score is calculated using three factors:</span>
<span class="sd">		1. Presence of code files (60% weight)</span>
<span class="sd">		2. Number of files affected (20% weight)</span>
<span class="sd">		3. Size of content changes (20% weight)</span>

<span class="sd">		Args:</span>
<span class="sd">			chunk: The diff chunk to score</span>

<span class="sd">		Returns:</span>
<span class="sd">			float: A score between 0 and 1 representing the chunk&#39;s priority</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Check if any files are code files</span>
		<span class="n">code_file_score</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.py&quot;</span><span class="p">,</span> <span class="s2">&quot;.js&quot;</span><span class="p">,</span> <span class="s2">&quot;.ts&quot;</span><span class="p">,</span> <span class="s2">&quot;.java&quot;</span><span class="p">,</span> <span class="s2">&quot;.c&quot;</span><span class="p">,</span> <span class="s2">&quot;.cpp&quot;</span><span class="p">,</span> <span class="s2">&quot;.go&quot;</span><span class="p">]):</span>
				<span class="n">code_file_score</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">break</span>

		<span class="c1"># Score based on number of files</span>
		<span class="n">file_count_score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>

		<span class="c1"># Score based on content size (as proxy for changes)</span>
		<span class="n">content_score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">content</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>

		<span class="k">return</span> <span class="n">code_file_score</span> <span class="o">*</span> <span class="mf">0.6</span> <span class="o">+</span> <span class="n">file_count_score</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">+</span> <span class="n">content_score</span> <span class="o">*</span> <span class="mf">0.2</span>

	<span class="c1"># Sort chunks by score and return top max_count</span>
	<span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chunks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">chunk_score</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="n">max_count</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.get_file_paths_from_chunk" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_file_paths_from_chunk</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_file_paths_from_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Extract file paths from a diff chunk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunk</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The diff chunk to process</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of file paths</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_file_paths_from_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n">DiffChunk</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Extract file paths from a diff chunk.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunk: The diff chunk to process</span>

<span class="sd">	Returns:</span>
<span class="sd">	    List of file paths</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="p">[</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span> <span class="k">if</span> <span class="n">file</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.format_lod_entity" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format_lod_entity</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">format_lod_entity</span><span class="p">(</span>
	<span class="n">entity</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;LODEntity&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.processor.lod.LODEntity&lt;/code&gt;)" href="../../processor/#codemap.processor.lod.LODEntity">LODEntity</a></span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;LODLevel&lt;/span&gt; (&lt;code&gt;codemap.processor.lod.LODLevel&lt;/code&gt;)" href="../../processor/#codemap.processor.lod.LODLevel">LODLevel</a></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Format an LOD entity as GitHub-flavored markdown.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entity</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;LODEntity&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.processor.lod.LODEntity&lt;/code&gt;)" href="../../processor/#codemap.processor.lod.LODEntity">LODEntity</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The LOD entity to format</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the source file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>level</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;LODLevel&lt;/span&gt; (&lt;code&gt;codemap.processor.lod.LODLevel&lt;/code&gt;)" href="../../processor/#codemap.processor.lod.LODLevel">LODLevel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LOD level used</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatted markdown string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">format_lod_entity</span><span class="p">(</span><span class="n">entity</span><span class="p">:</span> <span class="n">LODEntity</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="n">LODLevel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Format an LOD entity as GitHub-flavored markdown.</span>

<span class="sd">	Args:</span>
<span class="sd">	    entity: The LOD entity to format</span>
<span class="sd">	    file_path: Path to the source file</span>
<span class="sd">	    level: LOD level used</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Formatted markdown string</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Start with file header</span>
	<span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;## </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>

	<span class="c1"># Format the entity based on LOD level</span>
	<span class="k">if</span> <span class="n">level</span> <span class="o">==</span> <span class="n">LODLevel</span><span class="o">.</span><span class="n">STRUCTURE</span><span class="p">:</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="n">format_entity_structure</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
	<span class="k">elif</span> <span class="n">level</span> <span class="o">==</span> <span class="n">LODLevel</span><span class="o">.</span><span class="n">SIGNATURES</span><span class="p">:</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="n">format_entity_signatures</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.format_entity_structure" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format_entity_structure</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">format_entity_structure</span><span class="p">(</span>
	<span class="n">entity</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;LODEntity&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.processor.lod.LODEntity&lt;/code&gt;)" href="../../processor/#codemap.processor.lod.LODEntity">LODEntity</a></span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="n"><span title="int">int</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Format entity with structure (signatures and hierarchy).</p>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">format_entity_structure</span><span class="p">(</span><span class="n">entity</span><span class="p">:</span> <span class="n">LODEntity</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Format entity with structure (signatures and hierarchy).&quot;&quot;&quot;</span>
	<span class="n">indent_str</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">indent</span>
	<span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">indent_str</span><span class="si">}</span><span class="s2">- **</span><span class="si">{</span><span class="n">entity</span><span class="o">.</span><span class="n">entity_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">**: `</span><span class="si">{</span><span class="n">entity</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`&quot;</span>

	<span class="k">if</span> <span class="n">entity</span><span class="o">.</span><span class="n">signature</span><span class="p">:</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">indent_str</span><span class="si">}</span><span class="s2">  ```</span><span class="se">\n</span><span class="si">{</span><span class="n">indent_str</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">entity</span><span class="o">.</span><span class="n">signature</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">indent_str</span><span class="si">}</span><span class="s2">  ```&quot;</span>

	<span class="k">if</span> <span class="n">entity</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
		<span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">entity</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
			<span class="n">result</span> <span class="o">+=</span> <span class="n">format_entity_structure</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">result</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.format_entity_signatures" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format_entity_signatures</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">format_entity_signatures</span><span class="p">(</span>
	<span class="n">entity</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;LODEntity&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.processor.lod.LODEntity&lt;/code&gt;)" href="../../processor/#codemap.processor.lod.LODEntity">LODEntity</a></span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="n"><span title="int">int</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Format entity with just signatures.</p>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">format_entity_signatures</span><span class="p">(</span><span class="n">entity</span><span class="p">:</span> <span class="n">LODEntity</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Format entity with just signatures.&quot;&quot;&quot;</span>
	<span class="n">indent_str</span> <span class="o">=</span> <span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">indent</span>
	<span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">indent_str</span><span class="si">}</span><span class="s2">- **</span><span class="si">{</span><span class="n">entity</span><span class="o">.</span><span class="n">entity_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">**: `</span><span class="si">{</span><span class="n">entity</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`&quot;</span>

	<span class="k">if</span> <span class="n">entity</span><span class="o">.</span><span class="n">signature</span><span class="p">:</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; - `</span><span class="si">{</span><span class="n">entity</span><span class="o">.</span><span class="n">signature</span><span class="si">}</span><span class="s2">`&quot;</span>

	<span class="k">if</span> <span class="n">entity</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
		<span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
		<span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">entity</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
			<span class="n">result</span> <span class="o">+=</span> <span class="n">format_entity_signatures</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">indent</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

	<span class="k">return</span> <span class="n">result</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.format_regular_chunks" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format_regular_chunks</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">format_regular_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Format chunks using the regular approach when LOD is not necessary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of chunks to format</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatted markdown string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">format_regular_chunks</span><span class="p">(</span><span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Format chunks using the regular approach when LOD is not necessary.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunks: List of chunks to format</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Formatted markdown string</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">formatted_chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">format_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">]</span>
	<span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">formatted_chunks</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.format_chunk" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">format_chunk</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">format_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Format a single diff chunk as markdown.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunk</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The diff chunk to format</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Formatted markdown string</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">format_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n">DiffChunk</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Format a single diff chunk as markdown.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunk: The diff chunk to format</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Formatted markdown string</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Format file paths</span>
	<span class="n">file_section</span> <span class="o">=</span> <span class="s2">&quot;## Files</span><span class="se">\n</span><span class="s2">&quot;</span>
	<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
		<span class="k">if</span> <span class="n">file</span><span class="p">:</span>
			<span class="n">file_section</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

	<span class="c1"># Format content</span>
	<span class="n">content_section</span> <span class="o">=</span> <span class="s2">&quot;### Changes</span><span class="se">\n</span><span class="s2">```diff</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">chunk</span><span class="o">.</span><span class="n">content</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">```&quot;</span>

	<span class="k">return</span> <span class="n">file_section</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">content_section</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.estimate_tokens" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">estimate_tokens</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">estimate_tokens</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="int">int</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Estimate the number of tokens in a text.</p>
<p>This is a simple estimation that can be improved with
actual tokenizer implementations if needed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>text</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Text to estimate tokens for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimated token count</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">estimate_tokens</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Estimate the number of tokens in a text.</span>

<span class="sd">	This is a simple estimation that can be improved with</span>
<span class="sd">	actual tokenizer implementations if needed.</span>

<span class="sd">	Args:</span>
<span class="sd">	    text: Text to estimate tokens for</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Estimated token count</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Simple estimation: 4 characters per token on average</span>
	<span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h4 id="codemap.git.semantic_grouping.context_processor.truncate_context" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">truncate_context</span>


</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">truncate_context</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">,</span> <span class="n">max_tokens</span><span class="p">:</span> <span class="n"><span title="int">int</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Truncate context to fit within token limit.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Context to truncate</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_tokens</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum allowed tokens</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Truncated context</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/context_processor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">truncate_context</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_tokens</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Truncate context to fit within token limit.</span>

<span class="sd">	Args:</span>
<span class="sd">	    context: Context to truncate</span>
<span class="sd">	    max_tokens: Maximum allowed tokens</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Truncated context</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Simple truncation by estimating tokens</span>
	<span class="k">if</span> <span class="n">estimate_tokens</span><span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_tokens</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">context</span>

	<span class="c1"># Split into chunks and preserve as many complete chunks as possible</span>
	<span class="n">chunks</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
	<span class="n">result_chunks</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">current_token_count</span> <span class="o">=</span> <span class="mi">0</span>

	<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">:</span>
		<span class="n">chunk_tokens</span> <span class="o">=</span> <span class="n">estimate_tokens</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">current_token_count</span> <span class="o">+</span> <span class="n">chunk_tokens</span> <span class="o">&lt;=</span> <span class="n">max_tokens</span> <span class="o">-</span> <span class="mi">100</span><span class="p">:</span>  <span class="c1"># Reserve 100 tokens for truncation marker</span>
			<span class="n">result_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
			<span class="n">current_token_count</span> <span class="o">+=</span> <span class="n">chunk_tokens</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># Add truncation marker and stop</span>
			<span class="n">result_chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">[...TRUNCATED...]</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">break</span>

	<span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result_chunks</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-module">



<h3 id="codemap.git.semantic_grouping.group" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">group</span>


</h3>

    <div class="doc doc-contents ">

        <p>Module for semantic grouping of diff chunks.</p>









  <div class="doc doc-children">











<div class="doc doc-object doc-class">



<h4 id="codemap.git.semantic_grouping.group.SemanticGroup" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">SemanticGroup</span>


</h4>


    <div class="doc doc-contents ">


        <p>Represents a group of semantically related diff chunks.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/git/semantic_grouping/group.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SemanticGroup</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Represents a group of semantically related diff chunks.&quot;&quot;&quot;</span>

	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initialize a semantic group.</span>

<span class="sd">		Args:</span>
<span class="sd">		    chunks: List of DiffChunk objects</span>
<span class="sd">		    name: Optional name for the group</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">chunks</span> <span class="o">=</span> <span class="n">chunks</span> <span class="ow">or</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">approved</span> <span class="o">=</span> <span class="kc">False</span>

	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Get the set of files affected by this group.&quot;&quot;&quot;</span>
		<span class="n">files</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">:</span>
			<span class="n">files</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

	<span class="nd">@property</span>
	<span class="k">def</span><span class="w"> </span><span class="nf">content</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Get the combined diff content of all chunks.&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">content</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">merge_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_group</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Merge this group with another group.</span>

<span class="sd">		Args:</span>
<span class="sd">		    other_group: Another SemanticGroup to merge with</span>

<span class="sd">		Returns:</span>
<span class="sd">		    A new SemanticGroup containing chunks from both groups</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="n">SemanticGroup</span><span class="p">(</span>
			<span class="n">chunks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chunks</span> <span class="o">+</span> <span class="n">other_group</span><span class="o">.</span><span class="n">chunks</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Merged: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">other_group</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
		<span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;Return a string representation of the group with file and chunk counts.&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;SemanticGroup(files=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2">, chunks=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.group.SemanticGroup.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span>
	<span class="nf">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
	<span class="n">name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize a semantic group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of DiffChunk objects</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional name for the group</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/group.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initialize a semantic group.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunks: List of DiffChunk objects</span>
<span class="sd">	    name: Optional name for the group</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">chunks</span> <span class="o">=</span> <span class="n">chunks</span> <span class="ow">or</span> <span class="p">[]</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">message</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">approved</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.group.SemanticGroup.chunks" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">chunks</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">chunks</span> <span class="o">=</span> <span class="n"><span title="codemap.git.semantic_grouping.group.SemanticGroup(chunks)">chunks</span></span> <span class="ow">or</span> <span class="p">[]</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.group.SemanticGroup.name" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">name</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">name</span> <span class="o">=</span> <span class="n"><span title="codemap.git.semantic_grouping.group.SemanticGroup(name)">name</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.group.SemanticGroup.message" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">message</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">message</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.group.SemanticGroup.approved" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">approved</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">approved</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.group.SemanticGroup.files" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">files</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">files</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="str">str</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the set of files affected by this group.</p>

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.group.SemanticGroup.content" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">content</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">content</span><span class="p">:</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the combined diff content of all chunks.</p>

    </div>

</div>






<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.group.SemanticGroup.merge_with" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">merge_with</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">merge_with</span><span class="p">(</span><span class="n">other_group</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.group.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.group.SemanticGroup">SemanticGroup</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.group.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.group.SemanticGroup">SemanticGroup</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Merge this group with another group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other_group</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.group.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.group.SemanticGroup">SemanticGroup</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Another SemanticGroup to merge with</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;SemanticGroup&lt;/span&gt; (&lt;code&gt;codemap.git.semantic_grouping.group.SemanticGroup&lt;/code&gt;)" href="../#codemap.git.semantic_grouping.group.SemanticGroup">SemanticGroup</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new SemanticGroup containing chunks from both groups</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/group.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merge_with</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_group</span><span class="p">:</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SemanticGroup&quot;</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Merge this group with another group.</span>

<span class="sd">	Args:</span>
<span class="sd">	    other_group: Another SemanticGroup to merge with</span>

<span class="sd">	Returns:</span>
<span class="sd">	    A new SemanticGroup containing chunks from both groups</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="n">SemanticGroup</span><span class="p">(</span>
		<span class="n">chunks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chunks</span> <span class="o">+</span> <span class="n">other_group</span><span class="o">.</span><span class="n">chunks</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Merged: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">other_group</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
	<span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.group.SemanticGroup.__repr__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__repr__</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__repr__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nf"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return a string representation of the group with file and chunk counts.</p>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/group.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Return a string representation of the group with file and chunk counts.&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;SemanticGroup(files=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">)</span><span class="si">}</span><span class="s2">, chunks=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chunks</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-module">



<h3 id="codemap.git.semantic_grouping.embedder" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">embedder</span>


</h3>

    <div class="doc doc-contents ">

        <p>Module for generating embeddings from diff chunks.</p>









  <div class="doc doc-children">



















<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.embedder.logger" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-class">



<h4 id="codemap.git.semantic_grouping.embedder.DiffEmbedder" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DiffEmbedder</span>


</h4>


    <div class="doc doc-contents ">


        <p>Generates embeddings for diff chunks.</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DiffEmbedder</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;Generates embeddings for diff chunks.&quot;&quot;&quot;</span>

	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;all-MiniLM-L6-v2&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initialize the embedder with a specific model.</span>

<span class="sd">		Args:</span>
<span class="sd">		    model_name: Name of the sentence-transformers model to use</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Import here to avoid making sentence-transformers a hard dependency</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span><span class="w"> </span><span class="nn">sentence_transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SentenceTransformer</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">SentenceTransformer</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
				<span class="s2">&quot;Failed to import sentence-transformers. Please install it with: uv add sentence-transformers&quot;</span>
			<span class="p">)</span>
			<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;sentence-transformers is required for semantic grouping&quot;</span>
			<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">preprocess_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diff_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Preprocess diff text to make it more suitable for embedding.</span>

<span class="sd">		Args:</span>
<span class="sd">		    diff_text: Raw diff text</span>

<span class="sd">		Returns:</span>
<span class="sd">		    Preprocessed text</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Remove diff headers, line numbers, etc.</span>
		<span class="c1"># Focus on actual content changes</span>
		<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">diff_text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
			<span class="c1"># Skip diff metadata lines</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;diff --git&quot;</span><span class="p">,</span> <span class="s2">&quot;index &quot;</span><span class="p">,</span> <span class="s2">&quot;+++&quot;</span><span class="p">,</span> <span class="s2">&quot;---&quot;</span><span class="p">)):</span>
				<span class="k">continue</span>

			<span class="c1"># Keep actual content changes, removing the +/- prefix</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)):</span>
				<span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

		<span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">embed_chunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk</span><span class="p">:</span> <span class="n">DiffChunk</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Generate an embedding for a diff chunk.</span>

<span class="sd">		Args:</span>
<span class="sd">		    chunk: DiffChunk object</span>

<span class="sd">		Returns:</span>
<span class="sd">		    numpy.ndarray: Embedding vector</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># Get the diff content from the chunk</span>
		<span class="n">diff_text</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">content</span>

		<span class="c1"># Preprocess the diff text</span>
		<span class="n">processed_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_diff</span><span class="p">(</span><span class="n">diff_text</span><span class="p">)</span>

		<span class="c1"># If the processed text is empty, use the file paths as context</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">processed_text</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
			<span class="n">processed_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

		<span class="c1"># Generate the embedding and convert to numpy array</span>
		<span class="n">embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">processed_text</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">embedding</span><span class="p">)</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">embed_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Generate embeddings for multiple chunks.</span>

<span class="sd">		Args:</span>
<span class="sd">		    chunks: List of DiffChunk objects</span>

<span class="sd">		Returns:</span>
<span class="sd">		    List of (chunk, embedding) tuples</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="p">[(</span><span class="n">chunk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embed_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.embedder.DiffEmbedder.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span><span class="nf">model_name</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s1">&#39;all-MiniLM-L6-v2&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the embedder with a specific model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the sentence-transformers model to use</p>
              </div>
            </td>
            <td>
                  <code>&#39;all-MiniLM-L6-v2&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;all-MiniLM-L6-v2&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initialize the embedder with a specific model.</span>

<span class="sd">	Args:</span>
<span class="sd">	    model_name: Name of the sentence-transformers model to use</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Import here to avoid making sentence-transformers a hard dependency</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">sentence_transformers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SentenceTransformer</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">SentenceTransformer</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
	<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
			<span class="s2">&quot;Failed to import sentence-transformers. Please install it with: uv add sentence-transformers&quot;</span>
		<span class="p">)</span>
		<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;sentence-transformers is required for semantic grouping&quot;</span>
		<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.embedder.DiffEmbedder.model" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">model</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n"><span title="sentence_transformers.SentenceTransformer">SentenceTransformer</span></span><span class="p">(</span><span class="n"><span title="codemap.git.semantic_grouping.embedder.DiffEmbedder(model_name)">model_name</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.embedder.DiffEmbedder.preprocess_diff" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">preprocess_diff</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">preprocess_diff</span><span class="p">(</span><span class="n">diff_text</span><span class="p">:</span> <span class="n"><span title="str">str</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Preprocess diff text to make it more suitable for embedding.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>diff_text</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw diff text</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Preprocessed text</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">preprocess_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diff_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Preprocess diff text to make it more suitable for embedding.</span>

<span class="sd">	Args:</span>
<span class="sd">	    diff_text: Raw diff text</span>

<span class="sd">	Returns:</span>
<span class="sd">	    Preprocessed text</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Remove diff headers, line numbers, etc.</span>
	<span class="c1"># Focus on actual content changes</span>
	<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">diff_text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
		<span class="c1"># Skip diff metadata lines</span>
		<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;diff --git&quot;</span><span class="p">,</span> <span class="s2">&quot;index &quot;</span><span class="p">,</span> <span class="s2">&quot;+++&quot;</span><span class="p">,</span> <span class="s2">&quot;---&quot;</span><span class="p">)):</span>
			<span class="k">continue</span>

		<span class="c1"># Keep actual content changes, removing the +/- prefix</span>
		<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)):</span>
			<span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

	<span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.embedder.DiffEmbedder.embed_chunk" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">embed_chunk</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">embed_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate an embedding for a diff chunk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunk</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DiffChunk object</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy.ndarray: Embedding vector</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">embed_chunk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk</span><span class="p">:</span> <span class="n">DiffChunk</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate an embedding for a diff chunk.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunk: DiffChunk object</span>

<span class="sd">	Returns:</span>
<span class="sd">	    numpy.ndarray: Embedding vector</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="c1"># Get the diff content from the chunk</span>
	<span class="n">diff_text</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">content</span>

	<span class="c1"># Preprocess the diff text</span>
	<span class="n">processed_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess_diff</span><span class="p">(</span><span class="n">diff_text</span><span class="p">)</span>

	<span class="c1"># If the processed text is empty, use the file paths as context</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">processed_text</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
		<span class="n">processed_text</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunk</span><span class="o">.</span><span class="n">files</span><span class="p">)</span>

	<span class="c1"># Generate the embedding and convert to numpy array</span>
	<span class="n">embedding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">processed_text</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">embedding</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.embedder.DiffEmbedder.embed_chunks" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">embed_chunks</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">embed_chunks</span><span class="p">(</span>
	<span class="n">chunks</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">,</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate embeddings for multiple chunks.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunks</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of DiffChunk objects</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (chunk, embedding) tuples</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/embedder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">embed_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Generate embeddings for multiple chunks.</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunks: List of DiffChunk objects</span>

<span class="sd">	Returns:</span>
<span class="sd">	    List of (chunk, embedding) tuples</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">return</span> <span class="p">[(</span><span class="n">chunk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">embed_chunk</span><span class="p">(</span><span class="n">chunk</span><span class="p">))</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-module">



<h3 id="codemap.git.semantic_grouping.clusterer" class="doc doc-heading">
            <span class="doc doc-object-name doc-module-name">clusterer</span>


</h3>

    <div class="doc doc-contents ">

        <p>Module for clustering diff chunks based on their embeddings.</p>
<p>This module provides functionality to group related code changes together based on their
semantic similarity, using vector embeddings and clustering algorithms. The clustering
process helps identify related changes that should be committed together.</p>
<p>Key components:
- DiffClusterer: Main class that implements clustering algorithms for diff chunks
- ClusteringParams: Type definition for parameters used by clustering algorithms</p>
<p>The module supports multiple clustering methods:
1. Agglomerative (hierarchical) clustering: Builds a hierarchy of clusters based on distances
   between embeddings, using a distance threshold to determine final cluster boundaries
2. DBSCAN: Density-based clustering that groups points in high-density regions,
   treating low-density points as noise/outliers</p>









  <div class="doc doc-children">



























<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.clusterer.logger" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">logger</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">logger</span> <span class="o">=</span> <span class="n"><span title="logging.getLogger">getLogger</span></span><span class="p">(</span><span class="n"><span title="__name__">__name__</span></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-class">



<h4 id="codemap.git.semantic_grouping.clusterer.ClusteringParams" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ClusteringParams</span>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="typing.TypedDict">TypedDict</span></code></p>


        <p>Type definition for clustering algorithm parameters.</p>
<p>These parameters configure the behavior of the clustering algorithms:</p>
<p>For agglomerative clustering:
- n_clusters: Optional limit on number of clusters (None means no limit)
- distance_threshold: Maximum distance for clusters to be merged (lower = more clusters)
- metric: Distance metric to use (e.g., "precomputed" for precomputed distance matrix)
- linkage: Strategy for calculating distances between clusters ("average", "single", etc.)</p>
<p>For DBSCAN:
- eps: Maximum distance between points in the same neighborhood
- min_samples: Minimum points required to form a dense region
- metric: Distance metric to use</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/git/semantic_grouping/clusterer.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ClusteringParams</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Type definition for clustering algorithm parameters.</span>

<span class="sd">	These parameters configure the behavior of the clustering algorithms:</span>

<span class="sd">	For agglomerative clustering:</span>
<span class="sd">	- n_clusters: Optional limit on number of clusters (None means no limit)</span>
<span class="sd">	- distance_threshold: Maximum distance for clusters to be merged (lower = more clusters)</span>
<span class="sd">	- metric: Distance metric to use (e.g., &quot;precomputed&quot; for precomputed distance matrix)</span>
<span class="sd">	- linkage: Strategy for calculating distances between clusters (&quot;average&quot;, &quot;single&quot;, etc.)</span>

<span class="sd">	For DBSCAN:</span>
<span class="sd">	- eps: Maximum distance between points in the same neighborhood</span>
<span class="sd">	- min_samples: Minimum points required to form a dense region</span>
<span class="sd">	- metric: Distance metric to use</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="n">n_clusters</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span>
	<span class="n">distance_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span>
	<span class="n">metric</span><span class="p">:</span> <span class="nb">str</span>
	<span class="n">linkage</span><span class="p">:</span> <span class="nb">str</span>
	<span class="n">eps</span><span class="p">:</span> <span class="nb">float</span>
	<span class="n">min_samples</span><span class="p">:</span> <span class="nb">int</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.ClusteringParams.n_clusters" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">n_clusters</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">n_clusters</span><span class="p">:</span> <span class="n"><span title="int">int</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.ClusteringParams.distance_threshold" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">distance_threshold</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">distance_threshold</span><span class="p">:</span> <span class="n"><span title="float">float</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.ClusteringParams.metric" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">metric</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">metric</span><span class="p">:</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.ClusteringParams.linkage" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">linkage</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">linkage</span><span class="p">:</span> <span class="n"><span title="str">str</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.ClusteringParams.eps" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">eps</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">eps</span><span class="p">:</span> <span class="n"><span title="float">float</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.ClusteringParams.min_samples" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">min_samples</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">min_samples</span><span class="p">:</span> <span class="n"><span title="int">int</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>




  </div>

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h4 id="codemap.git.semantic_grouping.clusterer.T" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">T</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h4>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">T</span> <span class="o">=</span> <span class="n"><span title="typing.TypeVar">TypeVar</span></span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-class">



<h4 id="codemap.git.semantic_grouping.clusterer.DiffClusterer" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DiffClusterer</span>


</h4>


    <div class="doc doc-contents ">


        <p>Clusters diff chunks based on their semantic embeddings.</p>
<p>This class provides methods to group related code changes by their semantic similarity,
using vector embeddings and standard clustering algorithms from scikit-learn.</p>
<p>Clustering helps identify code changes that are related to each other and should be
grouped in the same commit, even if they appear in different files.</p>
<p>The class supports multiple clustering algorithms:
1. Agglomerative clustering: Hierarchical clustering that's good for finding natural
   groupings without needing to specify the exact number of clusters
2. DBSCAN: Density-based clustering that can identify outliers and works well with
   irregularly shaped clusters</p>







              <details class="quote">
                <summary>Source code in <code>src/codemap/git/semantic_grouping/clusterer.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DiffClusterer</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Clusters diff chunks based on their semantic embeddings.</span>

<span class="sd">	This class provides methods to group related code changes by their semantic similarity,</span>
<span class="sd">	using vector embeddings and standard clustering algorithms from scikit-learn.</span>

<span class="sd">	Clustering helps identify code changes that are related to each other and should be</span>
<span class="sd">	grouped in the same commit, even if they appear in different files.</span>

<span class="sd">	The class supports multiple clustering algorithms:</span>
<span class="sd">	1. Agglomerative clustering: Hierarchical clustering that&#39;s good for finding natural</span>
<span class="sd">	   groupings without needing to specify the exact number of clusters</span>
<span class="sd">	2. DBSCAN: Density-based clustering that can identify outliers and works well with</span>
<span class="sd">	   irregularly shaped clusters</span>

<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Initialize the clusterer.</span>

<span class="sd">		Args:</span>
<span class="sd">		    method: Clustering method to use. Options:</span>
<span class="sd">		        - &quot;agglomerative&quot;: Hierarchical clustering (default)</span>
<span class="sd">		        - &quot;dbscan&quot;: Density-based spatial clustering</span>
<span class="sd">		    **kwargs: Additional parameters for the clustering algorithm:</span>
<span class="sd">		        - For agglomerative: distance_threshold, linkage, etc.</span>
<span class="sd">		        - For DBSCAN: eps, min_samples, etc.</span>

<span class="sd">		Raises:</span>
<span class="sd">		    ImportError: If scikit-learn is not installed</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

		<span class="c1"># Import here to avoid making sklearn a hard dependency</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">DBSCAN</span><span class="p">,</span> <span class="n">AgglomerativeClustering</span>
			<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_similarity</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">AgglomerativeClustering</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">DBSCAN</span> <span class="o">=</span> <span class="n">DBSCAN</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n">cosine_similarity</span>
		<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
			<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Failed to import scikit-learn. Please install it with: uv add scikit-learn&quot;</span><span class="p">)</span>
			<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;scikit-learn is required for clustering&quot;</span>
			<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

	<span class="k">def</span><span class="w"> </span><span class="nf">cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]:</span>
<span class="w">		</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		Cluster chunks based on their embeddings.</span>

<span class="sd">		              Process:</span>
<span class="sd">		              1. Extracts chunks and embeddings from input tuples</span>
<span class="sd">		              2. Computes a similarity matrix using cosine similarity</span>
<span class="sd">		              3. Converts similarity to distance matrix (1 - similarity)</span>
<span class="sd">		              4. Applies clustering algorithm based on the chosen method</span>
<span class="sd">		              5. Organizes chunks into clusters based on labels</span>
<span class="sd">		              6. Handles special cases like noise points in DBSCAN</span>

<span class="sd">		Args:</span>
<span class="sd">		    chunk_embeddings: List of (chunk, embedding) tuples where each embedding</span>
<span class="sd">		        is a numpy array representing the semantic vector of a code chunk</span>

<span class="sd">		Returns:</span>
<span class="sd">		    List of lists, where each inner list contains chunks in the same cluster.</span>
<span class="sd">		    With DBSCAN, noise points (label -1) are returned as individual single-item clusters.</span>

<span class="sd">		Examples:</span>
<span class="sd">		    &gt;&gt;&gt; embedder = DiffEmbedder()</span>
<span class="sd">		    &gt;&gt;&gt; chunk_embeddings = embedder.embed_chunks(diff_chunks)</span>
<span class="sd">		    &gt;&gt;&gt; clusterer = DiffClusterer(method=&quot;agglomerative&quot;, distance_threshold=0.5)</span>
<span class="sd">		    &gt;&gt;&gt; clusters = clusterer.cluster(chunk_embeddings)</span>
<span class="sd">		    &gt;&gt;&gt; for i, cluster in enumerate(clusters):</span>
<span class="sd">		    ...     print(f&quot;Cluster {i} has {len(cluster)} chunks&quot;)</span>

<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">chunk_embeddings</span><span class="p">:</span>
			<span class="k">return</span> <span class="p">[]</span>

		<span class="c1"># Extract chunks and embeddings</span>
		<span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ce</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>
		<span class="n">embeddings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ce</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">ce</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">])</span>

		<span class="c1"># Compute similarity matrix (1 - cosine distance)</span>
		<span class="n">similarity_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>

		<span class="c1"># Convert to distance matrix (1 - similarity)</span>
		<span class="n">distance_matrix</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">similarity_matrix</span>

		<span class="c1"># Apply clustering</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">:</span>
			<span class="c1"># Default parameters if not provided</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
				<span class="s2">&quot;n_clusters&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
				<span class="s2">&quot;distance_threshold&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Threshold for cluster formation (0.5 = moderate similarity)</span>
				<span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>  <span class="c1"># Use metric instead of affinity</span>
				<span class="s2">&quot;linkage&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>  <span class="c1"># Use average linkage for balanced clusters</span>
			<span class="p">}</span>
			<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

			<span class="n">clustering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
			<span class="n">labels</span> <span class="o">=</span> <span class="n">clustering</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;dbscan&quot;</span><span class="p">:</span>
			<span class="c1"># Default parameters if not provided</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
				<span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># Maximum distance between points in neighborhood (0.3 = high similarity required)</span>
				<span class="s2">&quot;min_samples&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Minimum points to form a dense region</span>
				<span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>  <span class="c1"># Using precomputed distance matrix</span>
			<span class="p">}</span>
			<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

			<span class="n">clustering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DBSCAN</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
			<span class="n">labels</span> <span class="o">=</span> <span class="n">clustering</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

		<span class="k">else</span><span class="p">:</span>
			<span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unsupported clustering method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

		<span class="c1"># Group chunks by cluster label</span>
		<span class="n">clusters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
			<span class="c1"># Convert numpy integer to Python int</span>
			<span class="n">label_key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">label_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">:</span>
				<span class="n">clusters</span><span class="p">[</span><span class="n">label_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">clusters</span><span class="p">[</span><span class="n">label_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

		<span class="c1"># Convert to list of lists and handle noise points (-1 label in DBSCAN)</span>
		<span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">cluster_chunks</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">clusters</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
			<span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># Regular cluster</span>
				<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cluster_chunks</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>  <span class="c1"># Noise points - each forms its own cluster</span>
				<span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">cluster_chunks</span><span class="p">])</span>

		<span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.clusterer.DiffClusterer.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__init__</span><span class="p">(</span>
	<span class="nf">method</span><span class="p">:</span> <span class="n"><span title="str">str</span></span> <span class="o">=</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n"><span title="object">object</span></span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize the clusterer.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clustering method to use. Options:
- "agglomerative": Hierarchical clustering (default)
- "dbscan": Density-based spatial clustering</p>
              </div>
            </td>
            <td>
                  <code>&#39;agglomerative&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="object">object</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional parameters for the clustering algorithm:
- For agglomerative: distance_threshold, linkage, etc.
- For DBSCAN: eps, min_samples, etc.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ImportError">ImportError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If scikit-learn is not installed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/clusterer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Initialize the clusterer.</span>

<span class="sd">	Args:</span>
<span class="sd">	    method: Clustering method to use. Options:</span>
<span class="sd">	        - &quot;agglomerative&quot;: Hierarchical clustering (default)</span>
<span class="sd">	        - &quot;dbscan&quot;: Density-based spatial clustering</span>
<span class="sd">	    **kwargs: Additional parameters for the clustering algorithm:</span>
<span class="sd">	        - For agglomerative: distance_threshold, linkage, etc.</span>
<span class="sd">	        - For DBSCAN: eps, min_samples, etc.</span>

<span class="sd">	Raises:</span>
<span class="sd">	    ImportError: If scikit-learn is not installed</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
	<span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>

	<span class="c1"># Import here to avoid making sklearn a hard dependency</span>
	<span class="k">try</span><span class="p">:</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.cluster</span><span class="w"> </span><span class="kn">import</span> <span class="n">DBSCAN</span><span class="p">,</span> <span class="n">AgglomerativeClustering</span>
		<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics.pairwise</span><span class="w"> </span><span class="kn">import</span> <span class="n">cosine_similarity</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">AgglomerativeClustering</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">DBSCAN</span> <span class="o">=</span> <span class="n">DBSCAN</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n">cosine_similarity</span>
	<span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
		<span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Failed to import scikit-learn. Please install it with: uv add scikit-learn&quot;</span><span class="p">)</span>
		<span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;scikit-learn is required for clustering&quot;</span>
		<span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.DiffClusterer.method" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">method</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">method</span> <span class="o">=</span> <span class="n"><span title="codemap.git.semantic_grouping.clusterer.DiffClusterer(method)">method</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.DiffClusterer.kwargs" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">kwargs</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">kwargs</span> <span class="o">=</span> <span class="n"><span title="codemap.git.semantic_grouping.clusterer.DiffClusterer(kwargs)">kwargs</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.DiffClusterer.AgglomerativeClustering" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">AgglomerativeClustering</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">AgglomerativeClustering</span> <span class="o">=</span> <span class="n"><span title="sklearn.cluster.AgglomerativeClustering">AgglomerativeClustering</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.DiffClusterer.DBSCAN" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">DBSCAN</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">DBSCAN</span> <span class="o">=</span> <span class="n"><span title="sklearn.cluster.DBSCAN">DBSCAN</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-attribute">



<h5 id="codemap.git.semantic_grouping.clusterer.DiffClusterer.cosine_similarity" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">cosine_similarity</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cosine_similarity</span> <span class="o">=</span> <span class="n"><span title="sklearn.metrics.pairwise.cosine_similarity">cosine_similarity</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

    </div>

</div>






<div class="doc doc-object doc-function">


<h5 id="codemap.git.semantic_grouping.clusterer.DiffClusterer.cluster" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cluster</span>


</h5>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cluster</span><span class="p">(</span>
	<span class="n">chunk_embeddings</span><span class="p">:</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="tuple">tuple</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">,</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><span title="list">list</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Cluster chunks based on their embeddings.</p>
<div class="highlight"><pre><span></span><code>          Process:
          1. Extracts chunks and embeddings from input tuples
          2. Computes a similarity matrix using cosine similarity
          3. Converts similarity to distance matrix (1 - similarity)
          4. Applies clustering algorithm based on the chosen method
          5. Organizes chunks into clusters based on labels
          6. Handles special cases like noise points in DBSCAN
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>chunk_embeddings</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="tuple">tuple</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of (chunk, embedding) tuples where each embedding
is a numpy array representing the semantic vector of a code chunk</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of lists, where each inner list contains chunks in the same cluster.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="list">list</span>[<a class="autorefs autorefs-internal" title="&lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;DiffChunk&lt;/span&gt;


  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-dataclass&quot;&gt;&lt;code&gt;dataclass&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;codemap.git.diff_splitter.DiffChunk&lt;/code&gt;)" href="../#codemap.git.diff_splitter.DiffChunk">DiffChunk</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>With DBSCAN, noise points (label -1) are returned as individual single-item clusters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">embedder</span> <span class="o">=</span> <span class="n">DiffEmbedder</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chunk_embeddings</span> <span class="o">=</span> <span class="n">embedder</span><span class="o">.</span><span class="n">embed_chunks</span><span class="p">(</span><span class="n">diff_chunks</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clusterer</span> <span class="o">=</span> <span class="n">DiffClusterer</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;agglomerative&quot;</span><span class="p">,</span> <span class="n">distance_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clusters</span> <span class="o">=</span> <span class="n">clusterer</span><span class="o">.</span><span class="n">cluster</span><span class="p">(</span><span class="n">chunk_embeddings</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clusters</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cluster </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span><span class="si">}</span><span class="s2"> chunks&quot;</span><span class="p">)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>src/codemap/git/semantic_grouping/clusterer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chunk_embeddings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]:</span>
<span class="w">	</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Cluster chunks based on their embeddings.</span>

<span class="sd">	              Process:</span>
<span class="sd">	              1. Extracts chunks and embeddings from input tuples</span>
<span class="sd">	              2. Computes a similarity matrix using cosine similarity</span>
<span class="sd">	              3. Converts similarity to distance matrix (1 - similarity)</span>
<span class="sd">	              4. Applies clustering algorithm based on the chosen method</span>
<span class="sd">	              5. Organizes chunks into clusters based on labels</span>
<span class="sd">	              6. Handles special cases like noise points in DBSCAN</span>

<span class="sd">	Args:</span>
<span class="sd">	    chunk_embeddings: List of (chunk, embedding) tuples where each embedding</span>
<span class="sd">	        is a numpy array representing the semantic vector of a code chunk</span>

<span class="sd">	Returns:</span>
<span class="sd">	    List of lists, where each inner list contains chunks in the same cluster.</span>
<span class="sd">	    With DBSCAN, noise points (label -1) are returned as individual single-item clusters.</span>

<span class="sd">	Examples:</span>
<span class="sd">	    &gt;&gt;&gt; embedder = DiffEmbedder()</span>
<span class="sd">	    &gt;&gt;&gt; chunk_embeddings = embedder.embed_chunks(diff_chunks)</span>
<span class="sd">	    &gt;&gt;&gt; clusterer = DiffClusterer(method=&quot;agglomerative&quot;, distance_threshold=0.5)</span>
<span class="sd">	    &gt;&gt;&gt; clusters = clusterer.cluster(chunk_embeddings)</span>
<span class="sd">	    &gt;&gt;&gt; for i, cluster in enumerate(clusters):</span>
<span class="sd">	    ...     print(f&quot;Cluster {i} has {len(cluster)} chunks&quot;)</span>

<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">chunk_embeddings</span><span class="p">:</span>
		<span class="k">return</span> <span class="p">[]</span>

	<span class="c1"># Extract chunks and embeddings</span>
	<span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ce</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">]</span>
	<span class="n">embeddings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ce</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">ce</span> <span class="ow">in</span> <span class="n">chunk_embeddings</span><span class="p">])</span>

	<span class="c1"># Compute similarity matrix (1 - cosine distance)</span>
	<span class="n">similarity_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosine_similarity</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>

	<span class="c1"># Convert to distance matrix (1 - similarity)</span>
	<span class="n">distance_matrix</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">similarity_matrix</span>

	<span class="c1"># Apply clustering</span>
	<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;agglomerative&quot;</span><span class="p">:</span>
		<span class="c1"># Default parameters if not provided</span>
		<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s2">&quot;n_clusters&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
			<span class="s2">&quot;distance_threshold&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Threshold for cluster formation (0.5 = moderate similarity)</span>
			<span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>  <span class="c1"># Use metric instead of affinity</span>
			<span class="s2">&quot;linkage&quot;</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>  <span class="c1"># Use average linkage for balanced clusters</span>
		<span class="p">}</span>
		<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

		<span class="n">clustering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
		<span class="n">labels</span> <span class="o">=</span> <span class="n">clustering</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

	<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;dbscan&quot;</span><span class="p">:</span>
		<span class="c1"># Default parameters if not provided</span>
		<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
			<span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>  <span class="c1"># Maximum distance between points in neighborhood (0.3 = high similarity required)</span>
			<span class="s2">&quot;min_samples&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Minimum points to form a dense region</span>
			<span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;precomputed&quot;</span><span class="p">,</span>  <span class="c1"># Using precomputed distance matrix</span>
		<span class="p">}</span>
		<span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

		<span class="n">clustering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DBSCAN</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
		<span class="n">labels</span> <span class="o">=</span> <span class="n">clustering</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Unsupported clustering method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span>
		<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

	<span class="c1"># Group chunks by cluster label</span>
	<span class="n">clusters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
		<span class="c1"># Convert numpy integer to Python int</span>
		<span class="n">label_key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">label_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">:</span>
			<span class="n">clusters</span><span class="p">[</span><span class="n">label_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">clusters</span><span class="p">[</span><span class="n">label_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunks</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

	<span class="c1"># Convert to list of lists and handle noise points (-1 label in DBSCAN)</span>
	<span class="n">result</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">DiffChunk</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">cluster_chunks</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">clusters</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
		<span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>  <span class="c1"># Regular cluster</span>
			<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cluster_chunks</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>  <span class="c1"># Noise points - each forms its own cluster</span>
			<span class="n">result</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">chunk</span><span class="p">]</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">cluster_chunks</span><span class="p">])</span>

	<span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>




  </div>

    </div>

</div>




  </div>

    </div>

</div>




  </div>

    </div>

</div><p><a href="https://github.com/SarthakMishra/codemap/blob/dev/src/codemap/git/semantic_grouping/__init__.py">View Source Code</a></p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../pr_generator/utils/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Utils">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Utils
              </div>
            </div>
          </a>
        
        
          
          <a href="batch_processor/" class="md-footer__link md-footer__link--next" aria-label="Next: Batch Processor">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Batch Processor
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Sarthak Mishra
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/SarthakMishra" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/codemap/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/itssarthakmishra/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/MishraMishry" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "content.tabs.link", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>